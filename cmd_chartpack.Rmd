---
title: "Capital Markets Data - Monthly Chartpack"
author: "Steven Sabol"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    css: ink.css
    highlight: null
    mathjax: null
    number_sections: yes
    self_contained: no
    theme: united
    toc: yes
    toc_depth: 3
    lof: yes
  pdf_document:
    toc: yes
    toc_depth: 5
abstract: This is the Capital Markets Data Monthly Chartpack.  For more information
  about the underlying data please email me at steven@capitalmarketsdata.com
---

```{r setup_QE_parity, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre1.8.0_271') # for 64-bit versi
 
library(knitr)
library(zoo)
library(ggplot2)
library(xts)
library(roll)
library(readr)
library(Quandl)
library(readxl)
library(lubridate)
library(quantmod)
library(fBasics)
library(Hmisc)
library(dplyr)
library(reshape)
library(timeSeries)
library(texreg)
library(TTR)
library(tis)
library(bsts)
library(gridExtra)
library(scales)
library(bbplot)
library(twitteR)
library(DBI)
library(openssl)
library(httpuv)
library(shiny)

source("helpers/auth.R")
source("helpers/helpers.R")

# rsconnect::setAccountInfo(name='expectedreturnsllc',
# 			  token='16445EEB9CEE272E17E038BDCF88AEC5',
# 			  secret='P/VfQljUgcLRK3iymqnaKSZwLk0Kh8Tf7bLebFcO')

```


```{r datacall, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# Data <- read.csv("F:/google drived/DatabaseDownloads/CMDMD.csv",header=TRUE)
Data <- read.csv("C:/Users/sabol/Google Drive/DatabaseDownloads/CMDMD.csv", stringsAsFactors=FALSE)

FHAgrosstogdp <- Data$fhagross/Data$ngdpm
gnmatogdp <- Data$gnma_grossiss/Data$ngdpm
fnmatogdp <- Data$fnma_grossiss/Data$ngdpm
fhlmctogdp <- Data$fhlmc_grossiss/Data$ngdpm
durdivmbstogdp <- Data$durdiv_mbs_npos /Data$ngdpm

fhlmcpurtogdp <- Data$fhlmc_port_pur/Data$ngdpm
fhlmcsalestogdp <- Data$fhlmc_port_sales/Data$ngdpm
fhlmcpurtomortorig <- Data$fhlmc_port_pur/Data$mortorig
fhlmcpurtomortorig_xts <- xts(Data$fhlmc_port_pur/Data$mortorig,order.by = lubridate::ymd(Data$Date))
fhlmcpurtomortorig_ma <- as.vector(roll_mean(fhlmcpurtomortorig_xts,3))

fhlmcsalestomortorig<- Data$fhlmc_port_sales/Data$mortorig
fnmapurchtogdp <- Data$fnma_port_pur/Data$ngdpm
fnmapurchtomortorig <- Data$fnma_port_pur/Data$mortorig
fnmapurtomortorig_xts <- xts(Data$fnma_port_pur/Data$mortorig,order.by = lubridate::ymd(Data$Date))
fnmapurtomortorig_ma <- as.vector(roll_mean(fnmapurtomortorig_xts,3))

stateandlocal_go_xts <- xts(Data$stateandlocal_go/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
stateandlocal_go_ma <- as.vector(roll_mean(stateandlocal_go_xts,6))

stateandlocal_revenue_xts <- xts(Data$stateandlocal_revenue/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
stateandlocal_revenue_ma <- as.vector(roll_mean(stateandlocal_revenue_xts,6))

stateandlocal_education_xts <- xts(Data$stateandlocal_education/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
stateandlocal_education_ma <- as.vector(roll_mean(stateandlocal_education_xts,6))

stateandlocal_transport_xts <- xts(Data$stateandlocal_transport/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
stateandlocal_transport_ma <- as.vector(roll_mean(stateandlocal_transport_xts,6))

stateandlocal_utilities_xts <- xts(Data$stateandlocal_utilities/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
stateandlocal_utilities_ma <- as.vector(roll_mean(stateandlocal_utilities_xts,6))

stateandlocal_industrial_aid_xts <- xts(Data$stateandlocal_industrial_aid/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
stateandlocal_industrial_aid_ma <- as.vector(roll_mean(stateandlocal_industrial_aid_xts,6))



# fnmapurtomortorig_xts <- xts(Data$fnma_purch/Data$mortorig,order.by = lubridate::ymd(Data$Date))
# fnmapurtomortorig_ma <- as.vector(roll_mean(fnmapurtomortorig_xts,3))
# fnmapurtomortorig_xts <- xts(Data$fnma_purch/Data$mortorig,order.by = lubridate::ymd(Data$Date))
# fnmapurtomortorig_ma <- as.vector(roll_mean(fnmapurtomortorig_xts,3))


fnmafhlmcpurtomortorig_xts<- xts(rowSums(cbind.xts(fhlmcpurtomortorig_xts,fnmapurtomortorig_xts),na.rm=TRUE),order.by = index(fnmapurtomortorig_xts))
fnmaphlmcpurtomortorig_ma <- as.vector(roll_mean(fnmafhlmcpurtomortorig_xts,3))

pdagencytogdp <- Data$pdtranagencyandmbs/Data$ngdpm
pdgsembsnpostogdp <- Data$pd_npos_gse_and_mbs/Data$ngdpm
pdnposmbstogdp <- Data$pd_npos_mbs/Data$ngdpm
ldombankmbstogdp <- Data$ldom_bank_mbs/Data$ngdpm
allbanktsyagencytogdp <- Data$all_bank_tsy_agency/Data$ngdpm
fnmamortholdtogdp <- Data$fnma_mort_hold/Data$ngdpm
fhlmcmortholdtogdp <- Data$fhlmc_port_endbal/Data$ngdpm
fnmaouttogdp <- Data$fnma_out/Data$ngdpm
fhlmcouttogdp <- Data$fhlmc_out/Data$ngdpm

mbstogdp <- Data$mbs_iss/Data$ngdpm
mortorigtogdp <- Data$mortorig/Data$ngdpm
corpbtogdp <- Data$corpbond_iss/Data$ngdpm
corpstockgdp <- Data$corpstock_iss/Data$ngdpm
munitogdp <- Data$muni_iss/Data$ngdpm
usbondtogdp <- Data$usbondandnotes_iss/Data$ngdpm
tsyisstogdp <- Data$ustotal_iss/Data$ngdpm

pd_npos_l1toout <- Data$pd_npos_l1/Data$usbillsandcertif_out
pd_npos_g1toout<- Data$pd_npos_g1/Data$usnotesandbonds_out
total_npos_to_parpriv <- Data$total_npos_to_parpriv
netdur_npos <- Data$netdur_npos
fed_net_tsy_dur <- Data$fed_net_tsy_dur

fa_out <- xts(Data[,c("fnma_out","fhlb_out","fcbfc_out","tva_out","fhlmc_out")],order.by = lubridate::ymd(Data$Date))
fa_out <- RowSums(fa_out,na.rm = FALSE)

fa_out[fa_out == 0] <- NA

totaliss_xts <- xts(Data$corpbond_iss + Data$corpstock_iss + Data$muni_iss +Data$nyse_vol/1000 + Data$usbondandnotes_iss,order.by = lubridate::ymd(Data$Date))
totaliss_ma <- as.vector(roll_mean(totaliss_xts,6))

corpmuniiss_xts <- xts(Data$corpbond_iss+ Data$muni_iss + Data$pdtranagencyandmbs,order.by = lubridate::ymd(Data$Date))
corpmuniiss_ma <- as.vector(roll_mean(corpmuniiss_xts,6))

corpmunitsyiss_xts <- xts(Data$corpbond_iss+ Data$muni_iss + Data$usbondandnotes_iss,order.by = lubridate::ymd(Data$Date))
corpmunitsyiss_ma <- as.vector(roll_mean(corpmunitsyiss_xts,12))

dom_ltsecs_net_xts <- xts(Data$dom_ltsecs_net,order.by = lubridate::ymd(Data$Date))
dom_ltsecs_net_ma <- as.vector(roll_mean(dom_ltsecs_net_xts,6))

total_net_frn_xts <- xts(Data$total_net_frn,order.by = lubridate::ymd(Data$Date))
total_net_frn_ma <- as.vector(roll_mean(total_net_frn_xts,3))

nyse_vol_xts <- xts(Data$nyse_vol,order.by = lubridate::ymd(Data$Date))/1000
nyse_vol_ma <- as.vector(roll_mean(nyse_vol_xts,3))

dom_stocks_net_xts <- xts(Data$dom_stocks_net,order.by = lubridate::ymd(Data$Date))
dom_stocks_net_ma <- as.vector(roll_mean(dom_stocks_net_xts,3))

dom_bonds_net_xts <- xts(Data$dom_bonds_net,order.by = lubridate::ymd(Data$Date))
dom_bonds_net_ma <- as.vector(roll_mean(dom_bonds_net_xts,3))

frn_bonds_net_xts <- xts(Data$frn_bonds_pur.1,order.by = lubridate::ymd(Data$Date))
frn_bonds_net_ma <- as.vector(roll_sum(frn_bonds_net_xts,12))

frn_stocks_net_xts <- xts(Data$frn_stocks_pur.1,order.by = lubridate::ymd(Data$Date))
frn_stocks_net_ma <- as.vector(roll_sum(frn_stocks_net_xts,12))

frn_stocks_pur_xts <- xts(Data$frn_stocks_pur,order.by = lubridate::ymd(Data$Date))
frn_stocks_pur_ma <- as.vector(roll_mean(frn_stocks_pur_xts,3))

frn_stocks_sales_xts <- xts(Data$frn_stocks_sales,order.by = lubridate::ymd(Data$Date))
frn_stocks_sales_ma <- as.vector(roll_mean(frn_stocks_sales_xts,3))

corp_agency_bond_net_xts <- xts(Data$corp_agency_bond_net,order.by = lubridate::ymd(Data$Date))
corp_agency_bond_net_ma <- as.vector(roll_mean(corp_agency_bond_net_xts,3))

ust_foi_net_xts <- xts(Data$ust_foi_net,order.by = lubridate::ymd(Data$Date))
ust_foi_net_ma <- as.vector(roll_mean(ust_foi_net_xts,4))

ust_other_frners_net_xts <- xts(Data$ust_other_frners_net,order.by = lubridate::ymd(Data$Date))
ust_other_frners_net_ma <- as.vector(roll_mean(ust_other_frners_net_xts,4))

pdtrantotal_xts <- xts(Data$pdtrantotal,order.by = lubridate::ymd(Data$Date))
pdtrantotal_ma <- as.vector(roll_mean(pdtrantotal_xts,4))

ust_net_xts <- xts(Data$ust_net,order.by = lubridate::ymd(Data$Date))
ust_net_ma <- as.vector(roll_mean(ust_net_xts,4))

usbondtogdp_xts <- xts(Data$usbond_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
usbondtogdp_ma <- as.vector(roll_mean(usbondtogdp_xts,12))

usbond_xts <- xts(Data$usbondandnotes_iss,order.by = lubridate::ymd(Data$Date))
usbond_ma <- as.vector(roll_mean(usbond_xts,12))

ustotaltogdp_xts <- xts(Data$ustotal_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
ustotaltogdp_ma <- as.vector(roll_mean(ustotaltogdp_xts,9))

usbilltogdp_xts <- xts(Data$usbill_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
usbilltogdp_ma <- as.vector(roll_mean(usbilltogdp_xts,9))
usnotetogdp_xts <- xts(Data$usnote_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
usnotetogdp_ma <- as.vector(roll_mean(usnotetogdp_xts,9))
usbondstogdp_xts <- xts(Data$usbond_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
usbondstogdp_ma <- as.vector(roll_mean(usbondstogdp_xts,9))

tbill_foi_net_xts <- xts(Data$tbill_foi_net/Data$usbills_out,order.by = lubridate::ymd(Data$Date))
tbill_foi_net_ma <- as.vector(roll_mean(tbill_foi_net_xts,4))
tbill_priv_net_xts <- xts(Data$tbill_priv_net/Data$usbills_out,order.by = lubridate::ymd(Data$Date))
tbill_priv_net_ma <- as.vector(roll_mean(tbill_priv_net_xts,4))

mortorigtogdp_xts <- xts(Data$mortorig/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
mortorigtogdp_ma <- as.vector(roll_mean(mortorigtogdp_xts,9))
munitogdp_xts <- xts(Data$muni_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
munitogdp_ma <- as.vector(roll_mean(munitogdp_xts,9))
corpstockgdp_xts <- xts(Data$corpstock_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
corpstockgdp_ma <- as.vector(roll_mean(corpstockgdp_xts,9))
corpbtogdp_xts <- xts(Data$corpbond_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
corpbtogdp_ma <- as.vector(roll_mean(corpbtogdp_xts,9))

corpstockeqprice_xts <- xts(Data$corpstock_iss/Data$stock_price,order.by = lubridate::ymd(Data$Date))
corpstockeqprice_ma <- as.vector(roll_mean(corpstockeqprice_xts,9))

corpstock_xts <- xts(Data$corpstock_iss,order.by = lubridate::ymd(Data$Date))
corpstockiss_ma <- as.vector(roll_mean(corpstock_xts,9))

us_citizen_departures_to_foreign_country_xts <- (xts(Data$us_citizen_departures_to_foreign_country,order.by = lubridate::ymd(Data$Date)))
us_citizen_departures_to_foreign_country_ma <- as.vector(roll_mean(us_citizen_departures_to_foreign_country_xts,12))

foreign_arrivals_xts <- (xts(Data$foreign_arrivals,order.by = lubridate::ymd(Data$Date)))
foreign_arrivals_ma <- as.vector(roll_mean(foreign_arrivals_xts,12))

muninewcapitaltogdp_xts <- xts(Data$muni_newcapital_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
muninewcapitaltogdp_ma <- as.vector(roll_mean(muninewcapitaltogdp_xts,3))


munirefitogdp_xts <- xts(Data$muni_refunding_iss/Data$ngdpm,order.by = lubridate::ymd(Data$Date))
munirefitogdp_ma <- as.vector(roll_mean(munirefitogdp_xts,3))

FHAshare <- Data$fhagross/Data$mortorig

D <- data.frame(Date = lubridate::ymd(Data$Date),FHAgrosstogdp,gnmatogdp,mbstogdp,mortorigtogdp,corpbtogdp,munitogdp,usbondtogdp,corpstockgdp,fnmatogdp,fhlmctogdp,fnmapurchtogdp,fhlmcsalestogdp,fhlmcpurtogdp,pdagencytogdp,pdgsembsnpostogdp,pdnposmbstogdp,ldombankmbstogdp,allbanktsyagencytogdp,fnmamortholdtogdp,fhlmcmortholdtogdp,fnmaouttogdp,fhlmcouttogdp,durdivmbstogdp,Data$fnma_port_pur,fhlmcpurtomortorig_ma)

D_xts <- xts(D[,-1],order.by = D$Date)
Data_xts <- xts(Data[,-c(1:2)],order.by = lubridate::ymd(Data$Date))

eur_gdp <- read.csv("C:/Users/sabol/Google Drive/Model Master/Data/EUR_GDP.csv")
eur_gdp <- xts(eur_gdp[,-c(1:2)],order.by = as.Date(eur_gdp$Date))

Data_xts <- cbind.xts(Data_xts,eur_gdp)
colnames(Data_xts) <- tolower(colnames(Data_xts))




EUR_Data <- data.frame(Date = as.Date(index(Data_xts)),Data_xts)

fra_ltgovtdebttogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_general_govt_lt_debt_iss/Data_xts$fra_gdp_mv,9))
fra_govtdebttogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_general_govt_debt_iss/Data_xts$fra_gdp_mv,9))
fra_munitogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_muni_debt_iss/Data_xts$fra_gdp_mv,9))
fra_equitytogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_equity_iss/Data_xts$fra_gdp_mv,9))
fra_ltmunidebttogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_muni_lt_debt_iss/Data_xts$fra_gdp_mv,9))
fra_corpdebttogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_nfc_debt_iss/Data_xts$fra_gdp_mv,9))
fra_corpequitytogdp_ma <- as.vector(roll_mean(Data_xts$fra_net_nfc_equity_iss/Data_xts$fra_gdp_mv,9))


eur_ltgovtdebttogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_general_govt_lt_debt_iss/Data_xts$eur_gdp_mv,9))
eur_govtdebttogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_general_govt_debt_iss/Data_xts$eur_gdp_mv,9))
eur_munitogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_muni_debt_iss/Data_xts$eur_gdp_mv,9))
eur_equitytogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_equity_iss/Data_xts$eur_gdp_mv,9))
eur_ltmunidebttogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_muni_lt_debt_iss/Data_xts$eur_gdp_mv,9))
eur_corpdebttogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_nfc_debt_iss/Data_xts$eur_gdp_mv,9))
eur_corpequitytogdp_ma <- as.vector(roll_mean(Data_xts$eur_net_nfc_equity_iss/Data_xts$eur_gdp_mv,9))

ita_ltgovtdebttogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_general_govt_lt_debt_iss/Data_xts$ita_gdp_mv,9))
ita_govtdebttogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_general_govt_debt_iss/Data_xts$ita_gdp_mv,9))
ita_munitogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_muni_debt_iss/Data_xts$ita_gdp_mv,9))
ita_equitytogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_equity_iss/Data_xts$ita_gdp_mv,9))
ita_ltmunidebttogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_muni_lt_debt_iss/Data_xts$ita_gdp_mv,9))
ita_corpdebttogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_nfc_debt_iss/Data_xts$ita_gdp_mv,9))
ita_corpequitytogdp_ma <- as.vector(roll_mean(Data_xts$ita_net_nfc_equity_iss/Data_xts$ita_gdp_mv,9))

esp_ltgovtdebttogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_general_govt_lt_debt_iss/Data_xts$esp_gdp_mv,9))
esp_govtdebttogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_general_govt_debt_iss/Data_xts$esp_gdp_mv,9))
esp_munitogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_muni_debt_iss/Data_xts$esp_gdp_mv,9))
esp_equitytogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_equity_iss/Data_xts$esp_gdp_mv,9))
esp_ltmunidebttogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_muni_lt_debt_iss/Data_xts$esp_gdp_mv,9))
esp_corpdebttogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_nfc_debt_iss/Data_xts$esp_gdp_mv,9))
esp_corpequitytogdp_ma <- as.vector(roll_mean(Data_xts$esp_net_nfc_equity_iss/Data_xts$esp_gdp_mv,9))

ger_ltgovtdebttogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_general_govt_lt_debt_iss/Data_xts$ger_gdp_mv,9))
ger_govtdebttogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_general_govt_debt_iss/Data_xts$ger_gdp_mv,9))
ger_munitogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_muni_debt_iss/Data_xts$ger_gdp_mv,9))
ger_equitytogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_equity_iss/Data_xts$ger_gdp_mv,9))
ger_ltmunidebttogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_muni_lt_debt_iss/Data_xts$ger_gdp_mv,9))
ger_corpdebttogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_nfc_debt_iss/Data_xts$ger_gdp_mv,9))
ger_corpequitytogdp_ma <- as.vector(roll_mean(Data_xts$ger_net_nfc_equity_iss/Data_xts$ger_gdp_mv,9))

```

## Capital Market Issuance {-}

### Capital Market Issuance-to-GDP {-}

```{r issplotother_bbc, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_issuance      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=usbondtogdp_ma, color="UST Note & Bond ",linetype="UST Note & Bond "))
g2 <- geom_line(aes(y=mortorigtogdp_ma, color="Mortgage Originations",linetype="Mortgage Originations"))
g3 <- geom_line(aes(y=munitogdp_ma, color="Muni",linetype="Muni"))
g4 <- geom_line(aes(y=corpbtogdp_ma + corpstockgdp_ma, color="Corporate Bond & Equity ",linetype="Corporate Bond & Equity "))

color         <- scale_color_manual(" ", breaks=c("Mortgage Originations","UST Note & Bond ","Corporate Bond & Equity ","Muni"), values=c( "Mortgage Originations"="blue", "UST Note & Bond "="red","Corporate Bond & Equity " = "black","Muni" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations","UST Note & Bond ","Corporate Bond & Equity ","Muni"), values=c("Mortgage Originations"=1,"UST Note & Bond "=1,"Corporate Bond & Equity "=1,"Muni"=2))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations","UST Note & Bond ","Corporate Bond & Equity ","Muni"), values=c("Mortgage Originations"=2,"UST Note & Bond "=2,"Corporate Bond & Equity "=2,"Muni"=3))
title         <- ggtitle("Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.1, .05),2))

Figure_issuance <- Figure_issuance + g1+ g2 + g3+ g4 + color +linetype +size + title +text_options  +leg_pos + Date_opts + yscale

Figure_issuance2 <- nberShade(Figure_issuance) + bbc_style() + yscale

finalise_plot(plot_name = Figure_issuance2,
              source = "Capital Markets Data, 12MMA",
              save_filepath = "C:/Users/sabol/Google Drive/blogposts/figure_issuance_bbc.pdf",
              logo_image_path = "C:/Users/sabol/Google Drive/blogposts/CMDMDlogowatermark.png",
              width_pixels = 640,
              height_pixels = 550)

#ggsave("C:/Users/sabol/Google Drive/blogposts/issplotother_bbc.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/issplotother_bbc.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "issplotother_bbc.html"))

# knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/figure_issuance_bbc.pdf")

```

### Capital Market Issuance-to-GDP: Including T-bills {-}

```{r issplotother2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_issuance3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=ustotaltogdp_ma, color="Treasury Issuance-to-GDP",linetype="Treasury Issuance-to-GDP"))
g2 <- geom_line(aes(y=mortorigtogdp_ma, color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))
g3 <- geom_line(aes(y=munitogdp_ma, color="Muni Issuance-to-GDP",linetype="Muni Issuance-to-GDP"))
g4 <- geom_line(aes(y=corpbtogdp_ma + corpstockgdp_ma, color="Corporate Bond & Equity Issuance-to-GDP",linetype="Corporate Bond & Equity Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","Treasury Issuance-to-GDP","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c( "Mortgage Originations-to-GDP"="blue", "Treasury Issuance-to-GDP"="red","Corporate Bond & Equity Issuance-to-GDP" = "black","Muni Issuance-to-GDP" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","Treasury Issuance-to-GDP","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=1,"Treasury Issuance-to-GDP"=1,"Corporate Bond & Equity Issuance-to-GDP"=1,"Muni Issuance-to-GDP"=2))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","Treasury Issuance-to-GDP","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=2,"Treasury Issuance-to-GDP"=2,"Corporate Bond & Equity Issuance-to-GDP"=2,"Muni Issuance-to-GDP"=3))
title         <- ggtitle("Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, 9MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5,9, .1),2))

Figure_issuance3 <- Figure_issuance3 +g1+ g2 + g3+ g4 + color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(Figure_issuance3) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/issplotother2.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/issplotother2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "issplotother2.html"))

```

### Private Capital Market and Treasury Issuance-to-GDP {-}

```{r issplotother3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_issuance4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=ustotaltogdp_ma, color="Treasury Issuance-to-GDP",linetype="Treasury Issuance-to-GDP"))
g2 <- geom_line(aes(y=mortorigtogdp_ma + munitogdp_ma +corpbtogdp_ma + corpstockgdp_ma, color="Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP",linetype="Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"))
g3 <- geom_line(aes(y=munitogdp_ma, color="Muni Issuance-to-GDP",linetype="Muni Issuance-to-GDP"))
g4 <- geom_line(aes(y=corpbtogdp_ma + corpstockgdp_ma, color="Corporate Bond & Equity Issuance-to-GDP",linetype="Corporate Bond & Equity Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP","Treasury Issuance-to-GDP","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c( "Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"="blue", "Treasury Issuance-to-GDP"="red","Corporate Bond & Equity Issuance-to-GDP" = "black","Muni Issuance-to-GDP" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP","Treasury Issuance-to-GDP","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"=1,"Treasury Issuance-to-GDP"=1,"Corporate Bond & Equity Issuance-to-GDP"=1,"Muni Issuance-to-GDP"=2))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP","Treasury Issuance-to-GDP","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"=2,"Treasury Issuance-to-GDP"=2,"Corporate Bond & Equity Issuance-to-GDP"=2,"Muni Issuance-to-GDP"=3))
title         <- ggtitle("Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, 9MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.3, .1),1))

Figure_issuance4 <- Figure_issuance4 +g1+ g2 + color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(Figure_issuance4) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/issplotother3.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/issplotother3.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "issplotother3.html"))
```

### Total Capital Market Issuance-to-GDP {-}

```{r issplotother4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_issuance5      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=ustotaltogdp_ma+mortorigtogdp_ma + munitogdp_ma +corpbtogdp_ma + corpstockgdp_ma, color="Total",linetype="Total"))
g2 <- geom_line(aes(y=mortorigtogdp_ma + munitogdp_ma +corpbtogdp_ma + corpstockgdp_ma, color="Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP",linetype="Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"))
g3 <- geom_line(aes(y=munitogdp_ma, color="Muni Issuance-to-GDP",linetype="Muni Issuance-to-GDP"))
g4 <- geom_line(aes(y=corpbtogdp_ma + corpstockgdp_ma, color="Corporate Bond & Equity Issuance-to-GDP",linetype="Corporate Bond & Equity Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP","Total","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c( "Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"="blue", "Total"="red","Corporate Bond & Equity Issuance-to-GDP" = "black","Muni Issuance-to-GDP" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP","Total","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"=1,"Total"=1,"Corporate Bond & Equity Issuance-to-GDP"=1,"Muni Issuance-to-GDP"=2))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP","Total","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Mortgage Originations + Muni + Corp Bond + Corp Equity Issuance-to-GDP"=2,"Total"=2,"Corporate Bond & Equity Issuance-to-GDP"=2,"Muni Issuance-to-GDP"=3))
title         <- ggtitle("Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, Mortgage Originations + Muni + Corp Bond + Corp Equity + Treasury  Issuance-to-GDP, 9MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.3, .1),1))

Figure_issuance5 <- Figure_issuance5 +g1+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(Figure_issuance5) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/issplotother4.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/issplotother4.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "issplotother4.html"))
```

### Non-Treasury Issuance-to-GDP vs 12m change in 10-yr Treasury Yield {-}

```{r privateissplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_privateissuanced12      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$total_priv_iss_d12wagencymbs, color="Non-Treasury Issuance",linetype="Non-Treasury Issuance"))
g2 <- geom_line(aes(y=-Data$ten_d12, color="-12m change in 10-yr Treasury yield",linetype="-12m change in 10-yr Treasury yield"))
g3 <- geom_line(aes(y=munitogdp_ma, color="Muni Issuance-to-GDP",linetype="Muni Issuance-to-GDP"))
g4 <- geom_line(aes(y=corpbtogdp_ma + corpstockgdp_ma, color="Corporate Bond & Equity Issuance-to-GDP",linetype="Corporate Bond & Equity Issuance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("-12m change in 10-yr Treasury yield","Non-Treasury Issuance","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c( "-12m change in 10-yr Treasury yield"="blue", "Non-Treasury Issuance"="red","Corporate Bond & Equity Issuance-to-GDP" = "black","Muni Issuance-to-GDP" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("-12m change in 10-yr Treasury yield","Non-Treasury Issuance","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("-12m change in 10-yr Treasury yield"=1,"Non-Treasury Issuance"=1,"Corporate Bond & Equity Issuance-to-GDP"=1,"Muni Issuance-to-GDP"=2))
size          <- scale_size_manual(" ", breaks=c("-12m change in 10-yr Treasury yield","Non-Treasury Issuance","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("-12m change in 10-yr Treasury yield"=2,"Non-Treasury Issuance"=2,"Corporate Bond & Equity Issuance-to-GDP"=2,"Muni Issuance-to-GDP"=3))
title         <- ggtitle("Non-Treasury Issuance-to-GDP vs 12m change in 10-yr Treasury Yield")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1978-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Notes: Non-Treasury Issuance = Agency MBS + Muni + Corp Bond + Corp Equity Issuance-to-GDP, 12m change")

Figure_privateissuanced12 <- Figure_privateissuanced12 +g1+g2+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts + hline


nberShade(Figure_privateissuanced12)

#ggsave("C:/Users/sabol/Google Drive/blogposts/privissd12.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/privissd12.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mortorigplot.html"))
```

## Asset-Backed Securities {-}

### Total ABS Issuance {-}
```{r abs_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

abs_iss_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$abs_iss/1000, color="ABS Issuance (ABA Alert)",linetype="ABS Issuance (ABA Alert)"))
g2 <- geom_line(aes(y=Data$abs_iss_sifma/1000, color="ABS Issuance (Sifma)",linetype="ABS Issuance (Sifma)"))
g3 <- geom_line(aes(y=Data$sgp_exp/Data$ngdpm - Data$sgp_imp/Data$ngdpm, color="Singapore",linetype="Singapore"))
g4 <- geom_line(aes(y=Data$idn_exp/Data$ngdpm - Data$idn_imp/Data$ngdpm, color="Indonesia",linetype="Indonesia"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("ABS Issuance (Sifma)","ABS Issuance (ABA Alert)","Indonesia","Singapore","Philippines"), values=c( "ABS Issuance (Sifma)"="blue", "ABS Issuance (ABA Alert)"="red","Indonesia" = "black","Singapore" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("ABS Issuance (Sifma)","ABS Issuance (ABA Alert)","Indonesia","Singapore","Philippines"), values=c("ABS Issuance (Sifma)"=1,"ABS Issuance (ABA Alert)"=1,"Indonesia"=1,"Singapore"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("ABS Issuance (Sifma)","ABS Issuance (ABA Alert)","Indonesia","Singapore","Philippines"), values=c("ABS Issuance (Sifma)"=2,"ABS Issuance (ABA Alert)"=2,"Indonesia"=2,"Singapore"=3,"Philippines"=3))
title         <- ggtitle("ABS Issuance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ABA Alert; SIFMA, Notes: Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,10),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
abs_iss_plot <- abs_iss_plot +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(abs_iss_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/abs_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs","#economics","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/abs_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("abs_iss_plot.jpg")
```

### Private-Label CMBS Issuance {-}
```{r cmbsissplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_cmbsissuanced12      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$cmbs_iss/1000, color="CMBS Iss (CMA Alert)",linetype="CMBS Iss (CMA Alert)"))
g2 <- geom_line(aes(y=Data$non_agency_cmbs_iss_sifma/1000, color="non-Agency CMBS Iss (SIFMA)",linetype="non-Agency CMBS Iss (SIFMA)"))
g3 <- geom_line(aes(y=Data$fnma_mf_mbs_iss, color="Muni Issuance-to-GDP",linetype="Muni Issuance-to-GDP"))
g4 <- geom_line(aes(y=Data$fnma_mf_dus_fixed_iss, color="Corporate Bond & Equity Issuance-to-GDP",linetype="Corporate Bond & Equity Issuance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("non-Agency CMBS Iss (SIFMA)","CMBS Iss (CMA Alert)","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c( "non-Agency CMBS Iss (SIFMA)"="blue", "CMBS Iss (CMA Alert)"="red","Corporate Bond & Equity Issuance-to-GDP" = "black","Muni Issuance-to-GDP" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("non-Agency CMBS Iss (SIFMA)","CMBS Iss (CMA Alert)","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("non-Agency CMBS Iss (SIFMA)"=1,"CMBS Iss (CMA Alert)"=1,"Corporate Bond & Equity Issuance-to-GDP"=1,"Muni Issuance-to-GDP"=2))
size          <- scale_size_manual(" ", breaks=c("non-Agency CMBS Iss (SIFMA)","CMBS Iss (CMA Alert)","Corporate Bond & Equity Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("non-Agency CMBS Iss (SIFMA)"=2,"CMBS Iss (CMA Alert)"=2,"Corporate Bond & Equity Issuance-to-GDP"=2,"Muni Issuance-to-GDP"=3))
title         <- ggtitle("Private-Label CMBS Issuance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: CMA Alert Pre- 08/2020 & Kroll afterwords, SIFMA; Notes: Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 40, 4),1))

Figure_cmbsissuanced12 <- Figure_cmbsissuanced12 +g1+g2+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts + yscale


nberShade(Figure_cmbsissuanced12)

# #ggsave("C:/Users/sabol/Google Drive/blogposts/cmbs_iss.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#kroll","#SIFMA","#cmbs","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/cmbs_iss.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("cmbs_iss.jpg")

```

### RMBS 30 Day Delinquencies Rate {-}
```{r rmbs_30_delinq_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rmbs_30_delinq_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rmbs_high_ltv_crt_30_delinq*100, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$rmbs_low_ltv_crt_30_delinq*100, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$rmbs_prime_30_delinq*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$rmbs_non_prime_30_delinq*100, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("RMBS 30 Day Delinquencies Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2013-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,2),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
rmbs_30_delinq_plot <- rmbs_30_delinq_plot +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(rmbs_30_delinq_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/rmbs_30_delinq_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#rmbs","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/rmbs_30_delinq_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("rmbs_30_delinq_plot.jpg")
```

### RMBS Conditional Prepayment Rate {-}

```{r rmbs_prepayments_cpr_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rmbs_prepayments_cpr_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rmbs_high_ltv_crt_prepayments_cpr*100, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$rmbs_low_ltv_crt_prepayments_cpr*100, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$rmbs_prime_prepayments_cpr*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$rmbs_non_prime_prepayments_cpr*100, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("RMBS Conditional Prepayment Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2013-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,4),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
rmbs_prepayments_cpr_plot <- rmbs_prepayments_cpr_plot +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(rmbs_prepayments_cpr_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/rmbs_prepayments_cpr_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#rmbs","#economics","#macro",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/rmbs_prepayments_cpr_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("rmbs_prepayments_cpr_plot.jpg")
```

### RMBS Collateral Balance {-}

```{r rmbs_collateral_balance_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rmbs_collateral_balance_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rmbs_high_ltv_crt_collateral_balance/1000000000, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$rmbs_low_ltv_crt_collateral_balance/1000000000, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$rmbs_prime_collateral_balance/1000000000, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$rmbs_non_prime_collateral_balance/1000000000, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("RMBS Collateral Balance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2013-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll, Notes: Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000,100),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
rmbs_collateral_balance_plot <- rmbs_collateral_balance_plot +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(rmbs_collateral_balance_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/rmbs_collateral_balance_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#rmbs","#macro",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/rmbs_collateral_balance_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("rmbs_collateral_balance_plot.jpg")
```

### RMBS Annualized Net Losses {-}

```{r rmbs_annualized_net_losses_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rmbs_annualized_net_losses_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rmbs_high_ltv_crt_annualized_net_losses*100, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$rmbs_low_ltv_crt_annualized_net_losses*100, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$rmbs_prime_annualized_net_losses*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$rmbs_non_prime_annualized_net_losses*100, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("RMBS Annualized Net Losses")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2013-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1,.01),4))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
rmbs_annualized_net_losses_plot <- rmbs_annualized_net_losses_plot +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(rmbs_annualized_net_losses_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/rmbs_annualized_net_losses_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#rmbs","#economics","#macro",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/rmbs_annualized_net_losses_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("rmbs_annualized_net_losses_plot.jpg")
```

### Auto ABS 30 Day Delinquencies Rate {-}

```{r abs_auto_30_delinq_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

abs_auto_30_delinq_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$abs_auto_high_ltv_crt_30_delinq*100, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$abs_auto_low_ltv_crt_30_delinq*100, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$abs_auto_prime_30_delinq*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$abs_auto_non_prime_30_delinq*100, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("Auto ABS 30 Day Delinquencies Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,2),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
abs_auto_30_delinq_plot <- abs_auto_30_delinq_plot +g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(abs_auto_30_delinq_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/abs_auto_30_delinq_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/abs_auto_30_delinq_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("abs_auto_30_delinq_plot.jpg")
```

### Auto ABS Conditional Prepayment Rate {-}

```{r abs_auto_prepayments_cpr_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

abs_auto_prepayments_cpr_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$abs_auto_high_ltv_crt_prepayments_cpr*100, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$abs_auto_low_ltv_crt_prepayments_cpr*100, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$abs_auto_prime_prepayments_cpr*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$abs_auto_non_prime_prepayments_cpr*100, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("Auto ABS Conditional Prepayment Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,4),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
abs_auto_prepayments_cpr_plot <- abs_auto_prepayments_cpr_plot +g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(abs_auto_prepayments_cpr_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/abs_auto_prepayments_cpr_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/abs_auto_prepayments_cpr_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("abs_auto_prepayments_cpr_plot.jpg")
```

### Auto ABS Collateral Balance {-}

```{r abs_auto_collateral_balance_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

abs_auto_collateral_balance_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$abs_auto_high_ltv_crt_collateral_balance/1000000000, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$abs_auto_low_ltv_crt_collateral_balance/1000000000, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$abs_auto_prime_collateral_balance/1000000000, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$abs_auto_non_prime_collateral_balance/1000000000, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("Auto ABS Collateral Balance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll, Notes: Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100,5),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
abs_auto_collateral_balance_plot <- abs_auto_collateral_balance_plot +g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(abs_auto_collateral_balance_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/abs_auto_collateral_balance_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#macro",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/abs_auto_collateral_balance_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("abs_auto_collateral_balance_plot.jpg")
```

### Auto ABS Annualized Net Losses {-}

```{r abs_auto_annualized_net_losses_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

abs_auto_annualized_net_losses_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$abs_auto_high_ltv_crt_annualized_net_losses*100, color="High LTV CRT",linetype="High LTV CRT"))
g2 <- geom_line(aes(y=Data$abs_auto_low_ltv_crt_annualized_net_losses*100, color="Low LTV CRT",linetype="Low LTV CRT"))
g3 <- geom_line(aes(y=Data$abs_auto_prime_annualized_net_losses*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$abs_auto_non_prime_annualized_net_losses*100, color="Non-Prime",linetype="Non-Prime"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c( "Low LTV CRT"="blue", "High LTV CRT"="red","Non-Prime" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=1,"High LTV CRT"=1,"Non-Prime"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Low LTV CRT","High LTV CRT","Non-Prime","Prime","Philippines"), values=c("Low LTV CRT"=2,"High LTV CRT"=2,"Non-Prime"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("Auto ABS Annualized Net Losses")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Kroll")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,20,1),4))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
abs_auto_annualized_net_losses_plot <- abs_auto_annualized_net_losses_plot +g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(abs_auto_annualized_net_losses_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/abs_auto_annualized_net_losses_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/abs_auto_annualized_net_losses_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("abs_auto_annualized_net_losses_plot.jpg")
```

## Treasury and Federal Debt {-}

### Treasury Issuance-to-GDP {-}

```{r isstsy, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyissfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=usbondstogdp_ma, color="Bonds",linetype="Bonds"))
g2 <- geom_line(aes(y=usnotetogdp_ma, color="Notes",linetype="Notes"))
g3 <- geom_line(aes(y=usbilltogdp_ma, color="Bills",linetype="Bills"))
g4 <- geom_line(aes(y=ustotaltogdp_ma , color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Notes","Bonds","Total","Bills"), values=c( "Notes"="blue", "Bonds"="red","Total" = "black","Bills" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes","Bonds","Total","Bills"), values=c("Notes"=1,"Bonds"=1,"Total"=1,"Bills"=2))
size          <- scale_size_manual(" ", breaks=c("Notes","Bonds","Total","Bills"), values=c("Notes"=2,"Bonds"=2,"Total"=2,"Bills"=3))
title         <- ggtitle("Treasury Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, 9MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.1, .05),2))

tsyissfig <- tsyissfig +g1+ g2 + g3+ g4 + color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(tsyissfig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/tsyiss.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### Treasury Note and Bond Issuance-to-GDP {-}

```{r isstsy2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyissfig2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=usbondstogdp_ma+usnotetogdp_ma, color="Notes and Bonds",linetype="Notes and Bonds"))
g2 <- geom_line(aes(y=usnotetogdp_ma, color="Notes",linetype="Notes"))
g3 <- geom_line(aes(y=usbilltogdp_ma, color="Bills",linetype="Bills"))
g4 <- geom_line(aes(y=ustotaltogdp_ma , color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Notes","Notes and Bonds","Total","Bills"), values=c( "Notes"="blue", "Notes and Bonds"="red","Total" = "black","Bills" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes","Notes and Bonds","Total","Bills"), values=c("Notes"=1,"Notes and Bonds"=1,"Total"=1,"Bills"=2))
size          <- scale_size_manual(" ", breaks=c("Notes","Notes and Bonds","Total","Bills"), values=c("Notes"=2,"Notes and Bonds"=2,"Total"=2,"Bills"=3))
title         <- ggtitle("Treasury Note and Bond Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, 9MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.1, .05),2))

tsyissfig2 <- tsyissfig2 +g1+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(tsyissfig2) + yscale

```

### Total Treasury Issuance-to-GDP {-}

```{r isstsy3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyissfigtotal      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=usbondstogdp_ma+usnotetogdp_ma, color="Notes and Bonds",linetype="Notes and Bonds"))
g2 <- geom_line(aes(y=usnotetogdp_ma, color="Notes",linetype="Notes"))
g3 <- geom_line(aes(y=usbilltogdp_ma, color="Bills",linetype="Bills"))
g4 <- geom_line(aes(y=tsyisstogdp , color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Notes","Notes and Bonds","Total","Bills"), values=c( "Notes"="blue", "Notes and Bonds"="red","Total" = "black","Bills" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes","Notes and Bonds","Total","Bills"), values=c("Notes"=1,"Notes and Bonds"=1,"Total"=1,"Bills"=2))
size          <- scale_size_manual(" ", breaks=c("Notes","Notes and Bonds","Total","Bills"), values=c("Notes"=2,"Notes and Bonds"=2,"Total"=2,"Bills"=3))
title         <- ggtitle("Treasury Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,2, .1),1))

tsyissfigtotal <- tsyissfigtotal +g4+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(tsyissfigtotal) + yscale

```

### Treasuries Outstanding-to-GDP {-}

```{r tsyout, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyoutfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$usbonds_out/Data$ngdpm, color="Bonds",linetype="Bonds"))
g2 <- geom_line(aes(y=Data$usnotes_out/Data$ngdpm, color="Notes",linetype="Notes"))
g3 <- geom_line(aes(y=Data$usbillsandcertif_out/Data$ngdpm, color="Bills and Certificates",linetype="Bills and Certificates"))
g4 <- geom_line(aes(y=Data$usttotala_to_gdp, color="Gross",linetype="Gross"))

color         <- scale_color_manual(" ", breaks=c("Notes","Bonds","Gross","Bills and Certificates"), values=c( "Notes"="blue", "Bonds"="red","Gross" = "black","Bills and Certificates" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes","Bonds","Gross","Bills and Certificates"), values=c("Notes"=1,"Bonds"=1,"Gross"=1,"Bills and Certificates"=2))
size          <- scale_size_manual(" ", breaks=c("Notes","Bonds","Gross","Bills and Certificates"), values=c("Notes"=2,"Bonds"=2,"Gross"=2,"Bills and Certificates"=3))
title         <- ggtitle("Treasuries Outstanding-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1870-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$usbonds_out/Data$ngdpm,na.rm = TRUE), max(Data$usbonds_out/Data$ngdpm,na.rm = TRUE), 1),0))

tsyoutfig <- tsyoutfig +g1+ g2 + g3 + color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(tsyoutfig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/tsy_out_gdp.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### U.S. Gross Federal Debt Outstanding-to-GDP {-}

```{r tsyout2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyout2fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$usgf_to_gdp*1000, color="Gross",linetype="Gross"))
g2 <- geom_line(aes(y=Data$usttotala_to_gdp*1000, color="Public",linetype="Public"))
g3 <- geom_line(aes(y=Data$usbillsandcertif_out/Data$ngdpm, color="Bills and Certificates",linetype="Bills and Certificates"))
g4 <- geom_line(aes(y=Data$usttotala_to_gdp, color="Gross",linetype="Gross"))

color         <- scale_color_manual(" ", breaks=c("Public","Gross","Gross","Bills and Certificates"), values=c( "Public"="blue", "Gross"="red","Gross" = "black","Bills and Certificates" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Public","Gross","Gross","Bills and Certificates"), values=c("Public"=1,"Gross"=1,"Gross"=1,"Bills and Certificates"=2))
size          <- scale_size_manual(" ", breaks=c("Public","Gross","Gross","Bills and Certificates"), values=c("Public"=2,"Gross"=2,"Gross"=2,"Bills and Certificates"=3))
title         <- ggtitle("U.S. Gross Federal Debt Outstanding-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1800-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$usgf_to_gdp*1000,na.rm = TRUE), max(Data$usgf_to_gdp*1000,na.rm = TRUE), 10),0))

tsyout2fig <- tsyout2fig +g1+g2+color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(tsyout2fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/tsy_out_gdp.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Average Maturity of Privately Held Treasuries Outstanding {-}

```{r avgmat1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

avgmat1fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$avgmatprivheld, color="Average Maturity",linetype="Average Maturity"))
g2 <- geom_line(aes(y=Data$usnotes_out/Data$ngdpm, color="Notes",linetype="Notes"))
g3 <- geom_line(aes(y=Data$usbillsandcertif_out/Data$ngdpm, color="Bills and Certificates",linetype="Bills and Certificates"))
g4 <- geom_line(aes(y=Data$usttotala_to_gdp, color="Gross",linetype="Gross"))

color         <- scale_color_manual(" ", breaks=c("Notes","Average Maturity","Gross","Bills and Certificates"), values=c( "Notes"="blue", "Average Maturity"="red","Gross" = "black","Bills and Certificates" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes","Average Maturity","Gross","Bills and Certificates"), values=c("Notes"=1,"Average Maturity"=1,"Gross"=1,"Bills and Certificates"=2))
size          <- scale_size_manual(" ", breaks=c("Notes","Average Maturity","Gross","Bills and Certificates"), values=c("Notes"=2,"Average Maturity"=2,"Gross"=2,"Bills and Certificates"=3))
title         <- ggtitle("Average Maturity of Privately Held Treasuries Outstanding")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, Notes: in months")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(20, 260, 10),0),limits = c(20,260))

avgmat1fig <- avgmat1fig +g1+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(avgmat1fig) + yscale

```

### U.S. Maturity Weighted Debt-to-GDP {-}

```{r tsyoutmatwtd, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyoutmatwtdfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$usttotala_out/Data$ngdpm*Data$avgmatprivheld/1000, color="Maturity Wtd",linetype="Maturity Wtd"))
g2 <- geom_line(aes(y=Data$usnotes_out/Data$ngdpm, color="Notes",linetype="Notes"))
g3 <- geom_line(aes(y=Data$usbillsandcertif_out/Data$ngdpm, color="Bills and Certificates",linetype="Bills and Certificates"))
g4 <- geom_line(aes(y=Data$usttotala_to_gdp, color="Gross",linetype="Gross"))

color         <- scale_color_manual(" ", breaks=c("Notes","Maturity Wtd","Gross","Bills and Certificates"), values=c( "Notes"="blue", "Maturity Wtd"="red","Gross" = "black","Bills and Certificates" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes","Maturity Wtd","Gross","Bills and Certificates"), values=c("Notes"=1,"Maturity Wtd"=1,"Gross"=1,"Bills and Certificates"=2))
size          <- scale_size_manual(" ", breaks=c("Notes","Maturity Wtd","Gross","Bills and Certificates"), values=c("Notes"=2,"Maturity Wtd"=2,"Gross"=2,"Bills and Certificates"=3))
title         <- ggtitle("U.S. Maturity Weighted Debt-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1870-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000, .1),1))

tsyoutmatwtdfig <- tsyoutmatwtdfig +g1+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(tsyoutmatwtdfig) + yscale

```

### Federal Agency Debt Issuance-to-GDP {-}

```{r agencyiss, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

agencyissfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fcbfc_iss/Data$ngdpm, color="Farm Credit Banks Funding Corp",linetype="Farm Credit Banks Funding Corp"))
g2 <- geom_line(aes(y=Data$fnma_debt_iss/Data$ngdpm, color="Federal National Mortgage Association",linetype="Federal National Mortgage Association"))
g3 <- geom_line(aes(y=Data$fhlmc_debt_iss/Data$ngdpm, color="Federal Home Loan Mortgage Corporation",linetype="Federal Home Loan Mortgage Corporation"))
g4 <- geom_line(aes(y=Data$fhlb_iss/Data$ngdpm, color="Federal Home Loan Banks",linetype="Federal Home Loan Banks"))
g5 <- geom_line(aes(y=Data$agency_iss/Data$ngdpm, color="Total Agency",linetype="Total Agency"))

color         <- scale_color_manual(" ", breaks=c("Federal National Mortgage Association","Farm Credit Banks Funding Corp","Federal Home Loan Banks","Federal Home Loan Mortgage Corporation","Total Agency"), values=c( "Federal National Mortgage Association"="blue", "Farm Credit Banks Funding Corp"="red","Federal Home Loan Banks" = "black","Federal Home Loan Mortgage Corporation" ="dark green","Total Agency"="purple"))
linetype      <- scale_linetype_manual(" ", breaks=c("Federal National Mortgage Association","Farm Credit Banks Funding Corp","Federal Home Loan Banks","Federal Home Loan Mortgage Corporation","Total Agency"), values=c("Federal National Mortgage Association"=1,"Farm Credit Banks Funding Corp"=1,"Federal Home Loan Banks"=1,"Federal Home Loan Mortgage Corporation"=2,"Total Agency"=1))
size          <- scale_size_manual(" ", breaks=c("Federal National Mortgage Association","Farm Credit Banks Funding Corp","Federal Home Loan Banks","Federal Home Loan Mortgage Corporation","Total Agency"), values=c("Federal National Mortgage Association"=2,"Farm Credit Banks Funding Corp"=2,"Federal Home Loan Banks"=2,"Federal Home Loan Mortgage Corporation"=3,"Total Agency"=3))
title         <- ggtitle("Federal Agency Debt Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.1, .01),2))
agencyissfig <- agencyissfig +g1+ g2 + g3 +g4+g5+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts


nberShade(agencyissfig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/agencyiss.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Federal Agency Debt Outstanding-to-GDP {-}

```{r agencyout, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

agencyoutfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fcbfc_out/Data$ngdpm, color="Farm Credit Banks Funding Corp",linetype="Farm Credit Banks Funding Corp"))
g2 <- geom_line(aes(y=Data$fnma_out/Data$ngdpm, color="Federal National Mortgage Association",linetype="Federal National Mortgage Association"))
g3 <- geom_line(aes(y=Data$fhlmc_out/Data$ngdpm, color="Federal Home Loan Mortgage Corporation",linetype="Federal Home Loan Mortgage Corporation"))
g4 <- geom_line(aes(y=Data$fhlb_out/Data$ngdpm, color="Federal Home Loan Banks",linetype="Federal Home Loan Banks"))
g5 <- geom_line(aes(y=Data$tva_out/Data$ngdpm, color="TVA",linetype="TVA"))

color         <- scale_color_manual(" ", breaks=c("Federal National Mortgage Association","Farm Credit Banks Funding Corp","Federal Home Loan Banks","Federal Home Loan Mortgage Corporation","TVA"), values=c( "Federal National Mortgage Association"="blue", "Farm Credit Banks Funding Corp"="red","Federal Home Loan Banks" = "black","Federal Home Loan Mortgage Corporation" ="dark green","TVA"="purple"))
linetype      <- scale_linetype_manual(" ", breaks=c("Federal National Mortgage Association","Farm Credit Banks Funding Corp","Federal Home Loan Banks","Federal Home Loan Mortgage Corporation","TVA"), values=c("Federal National Mortgage Association"=1,"Farm Credit Banks Funding Corp"=1,"Federal Home Loan Banks"=1,"Federal Home Loan Mortgage Corporation"=2,"TVA"=1))
size          <- scale_size_manual(" ", breaks=c("Federal National Mortgage Association","Farm Credit Banks Funding Corp","Federal Home Loan Banks","Federal Home Loan Mortgage Corporation","TVA"), values=c("Federal National Mortgage Association"=2,"Farm Credit Banks Funding Corp"=2,"Federal Home Loan Banks"=2,"Federal Home Loan Mortgage Corporation"=3,"TVA"=3))
title         <- ggtitle("Federal Agency Debt Outstanding-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1939-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1.1, .1),1))
agencyoutfig <- agencyoutfig +g1+ g2 + g3 +g4+g5+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts

nberShade(agencyoutfig) + yscale

```

## Agency MBS {-}

### Single-Family Agency MBS Issuance-to-GDP {-}

```{r MBSFIG_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

MBSFIG      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=fnmatogdp, color="FNMA",linetype="FNMA"))
g2 <- geom_line(aes(y=gnmatogdp, color="GNMA",linetype="GNMA"))
g3 <- geom_line(aes(y=fhlmctogdp, color="FHLMC",linetype="FHLMC"))
g4 <- geom_line(aes(y=mbstogdp, color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("GNMA","FNMA","FHLMC","Total"), values=c( "GNMA"="blue", "FNMA"="red","Total" = "black","FHLMC" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("GNMA","FNMA","FHLMC","Total"), values=c("GNMA"=1,"FNMA"=1,"Total"=1,"FHLMC"=1))
size          <- scale_size_manual(" ", breaks=c("GNMA","FNMA","FHLMC","Total"), values=c("GNMA"=2,"FNMA"=2,"Total"=2,"FHLMC"=2))
title         <- ggtitle("Single-Family Agency MBS Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1977-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, .6, .025),3))

MBSFIG <- MBSFIG +g1+ g2 + g3+ g4 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(MBSFIG)+yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/agencymbsiss.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Single-Family Fixed-rate Agency MBS Conditional Prepayment Rates {-}

```{r mbscpr_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

mbscpr      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_cpr, color="FNMA",linetype="FNMA"))
g2 <- geom_line(aes(y=Data$gnma_cpr, color="GNMA",linetype="GNMA"))
g3 <- geom_line(aes(y=Data$fhlmc_cpr, color="FHLMC",linetype="FHLMC"))
g4 <- geom_line(aes(y=mbstogdp, color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("GNMA","FNMA","FHLMC","Total"), values=c( "GNMA"="blue", "FNMA"="red","Total" = "black","FHLMC" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("GNMA","FNMA","FHLMC","Total"), values=c("GNMA"=1,"FNMA"=1,"Total"=1,"FHLMC"=1))
size          <- scale_size_manual(" ", breaks=c("GNMA","FNMA","FHLMC","Total"), values=c("GNMA"=2,"FNMA"=2,"Total"=2,"FHLMC"=2))
title         <- ggtitle("Single-Family Fixed-rate Agency MBS Conditional Prepayment Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1979-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,60,5),0))

mbscpr <- mbscpr +g1+ g2 + g3+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(mbscpr) + yscale

```

### Agency Multifamily Issuance {-}

```{r agencymfissplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

agencymfissplot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gnma_gm1_mf_iss, color="GNMA",linetype="GNMA"))
g2 <- geom_line(aes(y=Data$fha_mf_iss/1000000, color="FHA Endorsements",linetype="FHA Endorsements"))
g4 <- geom_line(aes(y=Data$fnma_mf_mbs_iss, color="FNMA",linetype="FNMA"))
g5 <- geom_line(aes(y=Data$gnma_gm1_mf_pl_iss, color="PL",linetype="PL"))
g3 <- geom_line(aes(y=Data$gnma_gm1_mf_pn_iss, color="PN",linetype="PN"))
g6 <- geom_line(aes(y=Data$gnma_gm1_mf_rx_iss, color="RX",linetype="RX"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("GNMA","FHA Endorsements","PN","FNMA","PL","RX","20Y"), values=c( "FHA Endorsements"="blue", "GNMA"="red","PL" = "black","FNMA" ="black","PN"="red","RX" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("GNMA","FHA Endorsements","PN","FNMA","PL","RX","20Y"), values=c("FHA Endorsements"=1,"GNMA"=1,"PL"=1,"FNMA"=1,"PN"=2,"RX"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("GNMA","FHA Endorsements","PN","FNMA","PL","RX","20Y"), values=c("FHA Endorsements"=2,"GNMA"=2,"PL"=2,"FNMA"=3,"PN"=2,"RX"=2,"20Y"=3))
title         <- ggtitle("Agency Multifamily Issuance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2005-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Note: in millions; Sources: GNMA; FHA; FNMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000, 1000),0))

agencymfissplot <- agencymfissplot +g1+g2+g4+color +linetype +size + title + text_options + Date_opts +leg_pos + sub_labs

nberShade(agencymfissplot) + yscale
```

## Mortgage Trends {-}

### Mortgage Originations {-}

```{r Mortorig_total, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figuremortraw      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$mortorig, color="Agency MBS Issuance-to-GDP",linetype="Agency MBS Issuance-to-GDP"))
g2 <- geom_line(aes(y=mortorigtogdp, color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c( "Mortgage Originations-to-GDP"="blue", "Agency MBS Issuance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=1,"Agency MBS Issuance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=2,"Agency MBS Issuance-to-GDP"=2))
title         <- ggtitle("Mortgage Originations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none" )
sub_labs <- labs(subtitle="Capital Markets Data; Note: in Millions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 700000, 50000),0))

figuremortraw <- figuremortraw + g1 +  color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(figuremortraw)+yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortorigplotraw.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortorigplotraw.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mortorigplotraw.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mortorigplotraw.html"))

```

### Agency MBS Issuance and Mortgage Originations-to-GDP {-}

```{r Mortorig, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_mort      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=mbstogdp, color="Agency MBS Issuance-to-GDP",linetype="Agency MBS Issuance-to-GDP"))
g2 <- geom_line(aes(y=mortorigtogdp, color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c( "Mortgage Originations-to-GDP"="blue", "Agency MBS Issuance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=1,"Agency MBS Issuance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=2,"Agency MBS Issuance-to-GDP"=2))
title         <- ggtitle("Agency MBS Issuance and Mortgage Originations-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = c(.15,.95) )
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, .6, .05),2))

Figure_mort <- Figure_mort + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(Figure_mort)+yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortorigplot.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortorigplot.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mortorigplot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mortorigplot.html"))

```

### Agency MBS Issuance and Mortgage Originations-to-GDP {-}

```{r Mortorig_logs, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figuremortlogs      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=log(mbstogdp), color="Agency MBS Issuance-to-GDP",linetype="Agency MBS Issuance-to-GDP"))
g2 <- geom_line(aes(y=log(mortorigtogdp), color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c( "Mortgage Originations-to-GDP"="blue", "Agency MBS Issuance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=1,"Agency MBS Issuance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","Agency MBS Issuance-to-GDP"), values=c("Mortgage Originations-to-GDP"=2,"Agency MBS Issuance-to-GDP"=2))
title         <- ggtitle("Agency MBS Issuance and Mortgage Originations-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = c(.15,.95) )
sub_labs <- labs(subtitle="Capital Markets Data; Data in logs")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-7, 1, .5),1))

figuremortlogs <- figuremortlogs + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(figuremortlogs)+yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortorigplotlog.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortorigplotlog.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mortorigplotlog.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mortorigplotlog.html"))

```

### 12M change in 10-yr Treasury Yield and Mortgage Originations-to-GDP {-}

```{r Mortd12, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_mortd12      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=-Data$ten_d12, color="-12M change in UST 10-yr",linetype="-12M change in UST 10-yr"))
g2 <- geom_line(aes(y=Data$mortorig_d12, color="12M change in Mortgage Originations-to-GDP",linetype="12M change in Mortgage Originations-to-GDP"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("12M change in Mortgage Originations-to-GDP","-12M change in UST 10-yr"), values=c( "12M change in Mortgage Originations-to-GDP"="blue", "-12M change in UST 10-yr"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("12M change in Mortgage Originations-to-GDP","-12M change in UST 10-yr"), values=c("12M change in Mortgage Originations-to-GDP"=1,"-12M change in UST 10-yr"=1))
size          <- scale_size_manual(" ", breaks=c("12M change in Mortgage Originations-to-GDP","-12M change in UST 10-yr"), values=c("12M change in Mortgage Originations-to-GDP"=2,"-12M change in UST 10-yr"=2))
title         <- ggtitle("12M change in 10-yr Treasury Yield and Mortgage Originations-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1949-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1, 1, .1),1))

Figure_mortd12 <- Figure_mortd12 + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + hline + sub_labs

nberShade(Figure_mortd12) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/tend12mortorig.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/tend12mortorig.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tend12mortorig.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "tend12mortorig.html"))
```

### Loan Shares Used In FHFA HPI Valuation Data {-}

```{r fhfaloansharesplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhfaloansharesplot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$purchase_mort, color="Purchase",linetype="Purchase"))
g2 <- geom_line(aes(y=Data$cash_out_refi, color="Cash Out Refi",linetype="Cash Out Refi"))
g4 <- geom_line(aes(y=Data$rate_term_refi, color="Rate-Term Refinances",linetype="Rate-Term Refinances"))
g5 <- geom_line(aes(y=Data$Purchase_gm1_mf_pl_iss, color="PL",linetype="PL"))
g3 <- geom_line(aes(y=Data$Purchase_gm1_mf_pn_iss, color="PN",linetype="PN"))
g6 <- geom_line(aes(y=Data$Purchase_gm1_mf_rx_iss, color="RX",linetype="RX"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))

color         <- scale_color_manual(" ", breaks=c("Purchase","Cash Out Refi","PN","Rate-Term Refinances","PL","RX","20Y"), values=c( "Cash Out Refi"="blue", "Purchase"="red","PL" = "black","Rate-Term Refinances" ="black","PN"="red","RX" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Purchase","Cash Out Refi","PN","Rate-Term Refinances","PL","RX","20Y"), values=c("Cash Out Refi"=1,"Purchase"=1,"PL"=1,"Rate-Term Refinances"=1,"PN"=2,"RX"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("Purchase","Cash Out Refi","PN","Rate-Term Refinances","PL","RX","20Y"), values=c("Cash Out Refi"=2,"Purchase"=2,"PL"=2,"Rate-Term Refinances"=3,"PN"=2,"RX"=2,"20Y"=3))
title         <- ggtitle("Loan Shares Used In FHFA HPI Valuation Data")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data;Source: FHFA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100, 5),0),limits = c(0,80))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

fhfaloansharesplot <- fhfaloansharesplot +g1+g2+g4+color +linetype +size + title + text_options + Date_opts +leg_pos + sub_labs + hline

nberShade(fhfaloansharesplot) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/fhfaloansharesplot.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/fhfaloansharesplot.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/fhfaloansharesplot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "fhfaloansharesplot.html"))

```

### Primary Dealer Net Positions in MBS adjusted for Mortgage Duration and Treasury 10-yr Risk Premium {-}

```{r MBSNPOS3_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

NPOSMBSFIG2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=pdnposmbstogdp, color="Primary Dealer Agency MBS Net Positions (dur-adj)",linetype="Primary Dealer Agency MBS Net Positions (dur-adj)"))
g2 <- geom_line(aes(y=Data$tenyr_rpf+1, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$durdiv_mbs_npos/10000-1, color="Primary Dealer Agency MBS Net Positions (dur-adj)",linetype="Primary Dealer Agency MBS Net Positions (dur-adj)"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Primary Dealer Agency MBS Net Positions (dur-adj)",linetype="Primary Dealer Agency MBS Net Positions (dur-adj)"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","Primary Dealer Agency MBS Net Positions (dur-adj)","Primary Dealer Agency MBS Net Positions (dur-adj)","Primary Dealer Agency MBS Net Positions (dur-adj)"), values=c( "10-yr Risk Premium"="blue", "Primary Dealer Agency MBS Net Positions (dur-adj)"="red","Primary Dealer Agency MBS Net Positions (dur-adj)" = "red","Primary Dealer Agency MBS Net Positions (dur-adj)" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","Primary Dealer Agency MBS Net Positions (dur-adj)","Primary Dealer Agency MBS Net Positions (dur-adj)","Primary Dealer Agency MBS Net Positions (dur-adj)"), values=c("10-yr Risk Premium"=1,"Primary Dealer Agency MBS Net Positions (dur-adj)"=1,"Primary Dealer Agency MBS Net Positions (dur-adj)"=2,"Primary Dealer Agency MBS Net Positions (dur-adj)"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","Primary Dealer Agency MBS Net Positions (dur-adj)","Primary Dealer Agency MBS Net Positions (dur-adj)","Primary Dealer Agency MBS Net Positions (dur-adj)"), values=c("10-yr Risk Premium"=2,"Primary Dealer Agency MBS Net Positions (dur-adj)"=2,"Primary Dealer Agency MBS Net Positions (dur-adj)"=2,"Primary Dealer Agency MBS Net Positions (dur-adj)"=2))
title         <- ggtitle("Primary Dealer Net Positions in MBS adjusted for Mortgage Duration and Treasury 10-yr Risk Premium")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, 10-yr Risk Premium is 10-yr less Trend NGDP + 1, Dealer Positions are divided by 10000 - 1")

NPOSMBSFIG2 <- NPOSMBSFIG2 + g2 + g3 + color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs+ hline

nberShade(NPOSMBSFIG2)+ yscale + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-2, 6, .5),1),limits = c(-2,6)) 
#ggsave("C:/Users/sabol/Google Drive/blogposts/nposmbsand10yrrp.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Primary Dealer Net Positions in MBS adjusted for Mortgage Duration and Agency MBS Issuance-to-GDP {-}

```{r MBSNPOS_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

NPOSMBSFIG      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=pdnposmbstogdp, color="Primary Dealer Agency MBS Net Positions",linetype="Primary Dealer Agency MBS Net Positions"))
g2 <- geom_line(aes(y=mbstogdp, color="Agency MBS Issuance",linetype="Agency MBS Issuance"))
g3 <- geom_line(aes(y=pdnposmbstogdp, color="Primary Dealer Agency MBS Net Positions",linetype="Primary Dealer Agency MBS Net Positions"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Primary Dealer Agency MBS Net Positions (dur-adj)",linetype="Primary Dealer Agency MBS Net Positions (dur-adj)"))

color         <- scale_color_manual(" ", breaks=c("Agency MBS Issuance","Primary Dealer Agency MBS Net Positions","Primary Dealer Agency MBS Net Positions","Primary Dealer Agency MBS Net Positions (dur-adj)"), values=c( "Agency MBS Issuance"="blue", "Primary Dealer Agency MBS Net Positions"="red","Primary Dealer Agency MBS Net Positions (dur-adj)" = "red","Primary Dealer Agency MBS Net Positions" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Agency MBS Issuance","Primary Dealer Agency MBS Net Positions","Primary Dealer Agency MBS Net Positions","Primary Dealer Agency MBS Net Positions (dur-adj)"), values=c("Agency MBS Issuance"=1,"Primary Dealer Agency MBS Net Positions"=1,"Primary Dealer Agency MBS Net Positions (dur-adj)"=2,"Primary Dealer Agency MBS Net Positions"=1))
size          <- scale_size_manual(" ", breaks=c("Agency MBS Issuance","Primary Dealer Agency MBS Net Positions","Primary Dealer Agency MBS Net Positions","Primary Dealer Agency MBS Net Positions (dur-adj)"), values=c("Agency MBS Issuance"=2,"Primary Dealer Agency MBS Net Positions"=2,"Primary Dealer Agency MBS Net Positions (dur-adj)"=2,"Primary Dealer Agency MBS Net Positions"=2))
title         <- ggtitle("Primary Dealer Net Positions in MBS adjusted for Mortgage Duration and Agency MBS Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, .6, .025),3))

NPOSMBSFIG <- NPOSMBSFIG + g2 + g4+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(NPOSMBSFIG)+yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/pdmbsnposagencymbsiss.jpg" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/pdmbsnposagencymbsiss.pdf" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/pdmbsnposagencymbsiss.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "pdmbsnposagencymbsiss.html"))
```

### Mortgage Refinance Index {-}

```{r Refi_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

refiplotA      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$mort_refi, color="Mortgage Refi Index",linetype="Mortgage Refi Index"))
g2 <- geom_line(aes(y=Data$tenyr_rpf+1, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$durdiv_mbs_npos/10000-1, color="Mortgage Refi Index",linetype="Mortgage Refi Index"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Mortgage Refi Index",linetype="Mortgage Refi Index"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","Mortgage Refi Index","Mortgage Refi Index","Mortgage Refi Index"), values=c( "10-yr Risk Premium"="blue", "Mortgage Refi Index"="red","Mortgage Refi Index" = "red","Mortgage Refi Index" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","Mortgage Refi Index","Mortgage Refi Index","Mortgage Refi Index"), values=c("10-yr Risk Premium"=1,"Mortgage Refi Index"=1,"Mortgage Refi Index"=2,"Mortgage Refi Index"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","Mortgage Refi Index","Mortgage Refi Index","Mortgage Refi Index"), values=c("10-yr Risk Premium"=2,"Mortgage Refi Index"=2,"Mortgage Refi Index"=2,"Mortgage Refi Index"=2))
title         <- ggtitle("Mortgage Refinance Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1989-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, MBA Refi Index spliced with Google Search Trends Index")

refiplotA <- refiplotA + g1 + color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs + hline

nberShade(refiplotA)+ scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 9000, 500),0),limits = c(0,9000)) 
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortrefiindex.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mortrefiindex.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mortrefiindex.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mortrefiindex.html"))
```

### Mortgage Refinance Index and 10-yr Risk Premium {-}

```{r Refi_PLOT2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

refiplotB      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$mort_refi/1000, color="Mortgage Refi Index",linetype="Mortgage Refi Index"))
g2 <- geom_line(aes(y=(Data$tenyr_rpf+1)*2, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$durdiv_mbs_npos/10000-1, color="Mortgage Refi Index",linetype="Mortgage Refi Index"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Mortgage Refi Index",linetype="Mortgage Refi Index"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","Mortgage Refi Index","Mortgage Refi Index","Mortgage Refi Index"), values=c( "10-yr Risk Premium"="blue", "Mortgage Refi Index"="red","Mortgage Refi Index" = "red","Mortgage Refi Index" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","Mortgage Refi Index","Mortgage Refi Index","Mortgage Refi Index"), values=c("10-yr Risk Premium"=1,"Mortgage Refi Index"=1,"Mortgage Refi Index"=2,"Mortgage Refi Index"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","Mortgage Refi Index","Mortgage Refi Index","Mortgage Refi Index"), values=c("10-yr Risk Premium"=2,"Mortgage Refi Index"=2,"Mortgage Refi Index"=2,"Mortgage Refi Index"=2))
title         <- ggtitle("Mortgage Refinance Index and 10-yr Risk Premium")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1989-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.25), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, MBA Refi Index spliced with Google Search Trends Index")

refiplotB <- refiplotB + g1 +g2+ color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs +hline

nberShade(refiplotB)+ yscale + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 7, .5),2),limits = c(-4,7)) 

#ggsave("C:/Users/sabol/Google Drive/blogposts/refiandtenyrbrp.jpg" ,height = 6.5,width = 11.5,units = "in")
```

### Home Equity Withdrawal-to-Retail Sales {-}

```{r resplot8, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res8      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$cash_out/Data$rsales, color="Home Equity Withdrawal",linetype="Home Equity Withdrawal"))
g2 <- geom_line(aes(y=Data$cash_out, color="NonHome Equity Withdrawal",linetype="NonHome Equity Withdrawal"))

color         <- scale_color_manual(" ", breaks=c("NonHome Equity Withdrawal","Home Equity Withdrawal"), values=c( "NonHome Equity Withdrawal"="blue", "Home Equity Withdrawal"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("NonHome Equity Withdrawal","Home Equity Withdrawal"), values=c("NonHome Equity Withdrawal"=1,"Home Equity Withdrawal"=1))
size          <- scale_size_manual(" ", breaks=c("NonHome Equity Withdrawal","Home Equity Withdrawal"), values=c("NonHome Equity Withdrawal"=2,"Home Equity Withdrawal"=2))
title         <- ggtitle("Home Equity Withdrawal-to-Retail Sales")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: Freddie Mac")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,.1,.005),3),limits = c(0,.09))
figure_res8 <- figure_res8 + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res8) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/cashouttorsales.jpg" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/cashouttorsales.pdf" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/cashouttorsales.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "cashouttorsales.html"))

```

### Home Equity Withdrawal {-}

```{r cashoutplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_cashout      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$cash_out, color="Home Equity Withdrawal",linetype="Home Equity Withdrawal"))
g2 <- geom_line(aes(y=Data$cash_out, color="NonHome Equity Withdrawal",linetype="NonHome Equity Withdrawal"))

color         <- scale_color_manual(" ", breaks=c("NonHome Equity Withdrawal","Home Equity Withdrawal"), values=c( "NonHome Equity Withdrawal"="blue", "Home Equity Withdrawal"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("NonHome Equity Withdrawal","Home Equity Withdrawal"), values=c("NonHome Equity Withdrawal"=1,"Home Equity Withdrawal"=1))
size          <- scale_size_manual(" ", breaks=c("NonHome Equity Withdrawal","Home Equity Withdrawal"), values=c("NonHome Equity Withdrawal"=2,"Home Equity Withdrawal"=2))
title         <- ggtitle("Home Equity Withdrawal")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Total Combined Volume of Cash-out and 2nd Mortgages/HELOC Consolidation; Millions; Source: Freddie Mac")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,35000,5000),0),limits = c(0,30000))
figure_cashout <- figure_cashout + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_cashout) + yscale + hline

#ggsave("C:/Users/sabol/Google Drive/blogposts/cashout.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/cashout.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/cashout.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "cashout.html"))
```

### Cash Out Share of Refinancings {-}

```{r cashoutplotshare, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_cashout_share      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$refi_cashout_share_fhlmc, color="Cash Out Share of Refinancings",linetype="Cash Out Share of Refinancings"))
g2 <- geom_line(aes(y=Data$cash_out_share_refi, color="NonCash Out Share of Refinancings",linetype="NonCash Out Share of Refinancings"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("NonCash Out Share of Refinancings","Cash Out Share of Refinancings"), values=c( "NonCash Out Share of Refinancings"="blue", "Cash Out Share of Refinancings"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("NonCash Out Share of Refinancings","Cash Out Share of Refinancings"), values=c("NonCash Out Share of Refinancings"=1,"Cash Out Share of Refinancings"=1))
size          <- scale_size_manual(" ", breaks=c("NonCash Out Share of Refinancings","Cash Out Share of Refinancings"), values=c("NonCash Out Share of Refinancings"=2,"Cash Out Share of Refinancings"=2))
title         <- ggtitle("Cash Out Share of Refinancings")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: Freddie Mac")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,35,5),0),limits = c(0,35))
figure_cashout_share <- figure_cashout_share + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(figure_cashout_share) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/cashoutshareofrefis.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/cashoutshareofrefis.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/cashoutshareofrefis.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "cashoutshareofrefis.html"))
```

### Median Age of Refinanced Mortgage {-}

```{r refiplot_medianage, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

refiplot_cashout      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$refi_median_age_existing_mort, color="Median Age of Refinanced Mortgage",linetype="Median Age of Refinanced Mortgage"))
g2 <- geom_line(aes(y=Data$tenyr_rpf+1, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$durdiv_mbs_npos/10000-1, color="Median Age of Refinanced Mortgage",linetype="Median Age of Refinanced Mortgage"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Median Age of Refinanced Mortgage",linetype="Median Age of Refinanced Mortgage"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","Median Age of Refinanced Mortgage","Median Age of Refinanced Mortgage","Median Age of Refinanced Mortgage"), values=c( "10-yr Risk Premium"="blue", "Median Age of Refinanced Mortgage"="blue","Median Age of Refinanced Mortgage" = "red","Median Age of Refinanced Mortgage" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","Median Age of Refinanced Mortgage","Median Age of Refinanced Mortgage","Median Age of Refinanced Mortgage"), values=c("10-yr Risk Premium"=1,"Median Age of Refinanced Mortgage"=1,"Median Age of Refinanced Mortgage"=2,"Median Age of Refinanced Mortgage"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","Median Age of Refinanced Mortgage","Median Age of Refinanced Mortgage","Median Age of Refinanced Mortgage"), values=c("10-yr Risk Premium"=2,"Median Age of Refinanced Mortgage"=2,"Median Age of Refinanced Mortgage"=2,"Median Age of Refinanced Mortgage"=2))
title         <- ggtitle("Median Age of Refinanced Mortgage")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-03-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, FHLMC")

refiplot_cashout <- refiplot_cashout + g1 + color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(refiplot_cashout)+ scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10, .5),1),limits = c(1,8)) 

#ggsave("C:/Users/sabol/Google Drive/blogposts/refi_median_age_existing_mort.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/refi_median_age_existing_mort.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/refi_median_age_existing_mort.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "refi_median_age_existing_mort.html"))
```

### Median Ratio of Old to New Mortgage Rate At Time of Refinancing {-}

```{r refiplot_rateratio, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

refiplot_rateratio      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$refi_old_to_new_rate_median, color="Median Ratio of Old to New Rate",linetype="Median Ratio of Old to New Rate"))
g2 <- geom_line(aes(y=Data$tenyr_rpf+1, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$durdiv_mbs_npos/10000-1, color="Median Ratio of Old to New Rate",linetype="Median Ratio of Old to New Rate"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Median Ratio of Old to New Rate",linetype="Median Ratio of Old to New Rate"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","Median Ratio of Old to New Rate","Median Ratio of Old to New Rate","Median Ratio of Old to New Rate"), values=c( "10-yr Risk Premium"="blue", "Median Ratio of Old to New Rate"="red","Median Ratio of Old to New Rate" = "red","Median Ratio of Old to New Rate" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","Median Ratio of Old to New Rate","Median Ratio of Old to New Rate","Median Ratio of Old to New Rate"), values=c("10-yr Risk Premium"=1,"Median Ratio of Old to New Rate"=1,"Median Ratio of Old to New Rate"=2,"Median Ratio of Old to New Rate"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","Median Ratio of Old to New Rate","Median Ratio of Old to New Rate","Median Ratio of Old to New Rate"), values=c("10-yr Risk Premium"=2,"Median Ratio of Old to New Rate"=2,"Median Ratio of Old to New Rate"=2,"Median Ratio of Old to New Rate"=2))
title         <- ggtitle("Median Ratio of Old to New Mortgage Rate At Time of Refinancing")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-03-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, FHLMC")

refiplot_rateratio <- refiplot_rateratio + g1 + color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(refiplot_rateratio)+ scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1.5, .05),2),limits = c(0.6,1.2)) 

#ggsave("C:/Users/sabol/Google Drive/blogposts/refiplot_rateratio.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/refiplot_rateratio.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/refiplot_rateratio.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "refiplot_rateratio.html"))

```

### Median Appreciation on Exisiting Property At Time of Refinancing {-}

```{r refiplot_apprec, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

refiplot_apprec      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$refi_median_apprec_on_prop, color="Median Appreciation on Exisiting Property",linetype="Median Appreciation on Exisiting Property"))
g2 <- geom_line(aes(y=Data$tenyr_rpf+1, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$durdiv_mbs_npos/10000-1, color="Median Appreciation on Exisiting Property",linetype="Median Appreciation on Exisiting Property"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="Median Appreciation on Exisiting Property",linetype="Median Appreciation on Exisiting Property"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","Median Appreciation on Exisiting Property","Median Appreciation on Exisiting Property","Median Appreciation on Exisiting Property"), values=c( "10-yr Risk Premium"="blue", "Median Appreciation on Exisiting Property"="red","Median Appreciation on Exisiting Property" = "red","Median Appreciation on Exisiting Property" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","Median Appreciation on Exisiting Property","Median Appreciation on Exisiting Property","Median Appreciation on Exisiting Property"), values=c("10-yr Risk Premium"=1,"Median Appreciation on Exisiting Property"=1,"Median Appreciation on Exisiting Property"=2,"Median Appreciation on Exisiting Property"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","Median Appreciation on Exisiting Property","Median Appreciation on Exisiting Property","Median Appreciation on Exisiting Property"), values=c("10-yr Risk Premium"=2,"Median Appreciation on Exisiting Property"=2,"Median Appreciation on Exisiting Property"=2,"Median Appreciation on Exisiting Property"=2))
title         <- ggtitle("Median Appreciation on Exisiting Property At Time of Refinancing")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-03-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, FHLMC")

refiplot_apprec <- refiplot_apprec + g1 + color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs + hline

nberShade(refiplot_apprec)+ scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,35, 5),0),limits = c(-20,35)) 

#ggsave("C:/Users/sabol/Google Drive/blogposts/refiplot_apprec.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/refiplot_apprec.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/refiplot_apprec.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "refiplot_apprec.html"))


```

## FHA and VA Activity {-}

### FHA & VA Mortgage Insurance Volume {-}

```{r FHAplot3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_FHA3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$vagross/Data$ngdpm, color="VA Guarantees-to-GDP",linetype="VA Guarantees-to-GDP"))
g2 <- geom_line(aes(y=FHAgrosstogdp, color="FHA Gross Endorsements-to-GDP",linetype="FHA Gross Endorsements-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("FHA Gross Endorsements-to-GDP","VA Guarantees-to-GDP"), values=c( "FHA Gross Endorsements-to-GDP"="blue", "VA Guarantees-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("FHA Gross Endorsements-to-GDP","VA Guarantees-to-GDP"), values=c("FHA Gross Endorsements-to-GDP"=1,"VA Guarantees-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("FHA Gross Endorsements-to-GDP","VA Guarantees-to-GDP"), values=c("FHA Gross Endorsements-to-GDP"=2,"VA Guarantees-to-GDP"=2))
title         <- ggtitle("FHA & VA Mortgage Insurance Volume")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1934-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, share of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(FHAgrosstogdp,na.rm = TRUE), max(FHAgrosstogdp,na.rm = TRUE), .005),3))
Figure_FHA3 <- Figure_FHA3 + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_FHA3) + yscale
```

### Government Mortgage Activity {-}

```{r FHAplot4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_FHA4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$vagross/Data$ngdpm + FHAgrosstogdp , color="VA & FHA Endorsements-to-GDP",linetype="VA & FHA Endorsements-to-GDP"))
g2 <- geom_line(aes(y=gnmatogdp, color="GNMA MBS Issuance-to-GDP",linetype="GNMA MBS Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("GNMA MBS Issuance-to-GDP","VA & FHA Endorsements-to-GDP"), values=c( "GNMA MBS Issuance-to-GDP"="blue", "VA & FHA Endorsements-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("GNMA MBS Issuance-to-GDP","VA & FHA Endorsements-to-GDP"), values=c("GNMA MBS Issuance-to-GDP"=1,"VA & FHA Endorsements-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("GNMA MBS Issuance-to-GDP","VA & FHA Endorsements-to-GDP"), values=c("GNMA MBS Issuance-to-GDP"=2,"VA & FHA Endorsements-to-GDP"=2))
title         <- ggtitle("Government Mortgage Activity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1946-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, share of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(gnmatogdp,na.rm = TRUE), max(gnmatogdp,na.rm = TRUE), .005),3))
Figure_FHA4 <- Figure_FHA4 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_FHA4) + yscale
```

### FHA Share of Mortgage Originations {-}

```{r FHAplot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_FHA2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=FHAshare, color="FHA Share",linetype="FHA Share"))
g2 <- geom_line(aes(y=FHAgrosstogdp, color="FHA Gross Endorsements-to-GDP",linetype="FHA Gross Endorsements-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("FHA Gross Endorsements-to-GDP","FHA Share"), values=c( "FHA Gross Endorsements-to-GDP"="blue", "FHA Share"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("FHA Gross Endorsements-to-GDP","FHA Share"), values=c("FHA Gross Endorsements-to-GDP"=1,"FHA Share"=1))
size          <- scale_size_manual(" ", breaks=c("FHA Gross Endorsements-to-GDP","FHA Share"), values=c("FHA Gross Endorsements-to-GDP"=2,"FHA Share"=2))
title         <- ggtitle("FHA Share of Mortgage Originations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1934-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.25, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(FHAshare,na.rm = TRUE), max(FHAshare,na.rm = TRUE), .025),3))
Figure_FHA2 <- Figure_FHA2 + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_FHA2) + yscale
```

## Fannie Mae Monthly Volume Summary {-}

### FNMA: Guarantee Book of Business {-}

```{r fnmatableA_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fnmatableA      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_mbs_gbook/1000 ,color="MBS Guarantees",linetype="MBS Guarantees"))
g2 <- geom_line(aes(y=Data$fnma_mort_loans/1000, color="Mortgage Loans",linetype="Mortgage Loans"))
g3 <- geom_line(aes(y=Data$fnma_book_business/1000, color="Book of Business",linetype="Book of Business"))
g4 <- geom_line(aes(y=Data$fnma_net_bus_aquis/1000, color="New Business Acquisitions",linetype="New Business Acquisitions"))

color         <- scale_color_manual(" ", breaks=c("Mortgage Loans","MBS Guarantees","Book of Business","New Business Acquisitions"), values=c( "Mortgage Loans"="blue", "MBS Guarantees"="red","New Business Acquisitions" = "black","Book of Business" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Loans","MBS Guarantees","Book of Business","New Business Acquisitions"), values=c("Mortgage Loans"=1,"MBS Guarantees"=1,"New Business Acquisitions"=1,"Book of Business"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Loans","MBS Guarantees","Book of Business","New Business Acquisitions"), values=c("Mortgage Loans"=2,"MBS Guarantees"=2,"New Business Acquisitions"=2,"Book of Business"=2))
title         <- ggtitle("FNMA: Guarantee Book of Business")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Billions")
fnmatableA <- fnmatableA +g1+g2+g3+g4+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fnmatableA) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000000, 500),0)) 

```

### FNMA: Retained Mortgage Portfolio Activity {-}

```{r fnmatableB_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fnmatableB      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_port_pur/Data$ngdpm ,color="Purchases",linetype="Purchases"))
g2 <- geom_line(aes(y=Data$fnma_port_sales/Data$ngdpm, color="Sales",linetype="Sales"))
g3 <- geom_line(aes(y=Data$fnma_port_liq/Data$ngdpm, color="Liquidations",linetype="Liquidations"))
g4 <- geom_line(aes(y=Data$fnma_mort_hold/Data$ngdpm, color="Retained Mortgage Portfolio End Balance",linetype="Retained Mortgage Portfolio End Balance"))

color         <- scale_color_manual(" ", breaks=c("Sales","Purchases","Liquidations","Retained Mortgage Portfolio End Balance"), values=c( "Sales"="blue", "Purchases"="red","Retained Mortgage Portfolio End Balance" = "black","Liquidations" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Sales","Purchases","Liquidations","Retained Mortgage Portfolio End Balance"), values=c("Sales"=1,"Purchases"=1,"Retained Mortgage Portfolio End Balance"=1,"Liquidations"=1))
size          <- scale_size_manual(" ", breaks=c("Sales","Purchases","Liquidations","Retained Mortgage Portfolio End Balance"), values=c("Sales"=2,"Purchases"=2,"Retained Mortgage Portfolio End Balance"=2,"Liquidations"=2))
title         <- ggtitle("FNMA: Retained Mortgage Portfolio Activity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1980-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; fraction of nominal GDP")
fnmatableB <- fnmatableB +g1+g2+g3+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fnmatableB) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1, .01),2)) 

```

### FNMA: Retained Mortgage Portfolio Composition {-}

```{r fnmatableC_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fnmatableC      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_port_mbs/1000 ,color="FNMA MBS in Portfolio",linetype="FNMA MBS in Portfolio"))
g2 <- geom_line(aes(y=Data$fnma_mort_loans/1000, color="Mortgage Loans",linetype="Mortgage Loans"))
g3 <- geom_line(aes(y=Data$fnma_ex_fnmambs_agency/1000, color="Non-FNMA MBS: Agency",linetype="Non-FNMA MBS: Agency"))
g4 <- geom_line(aes(y=Data$fnma_ex_fnmambs_nonagency/1000, color="Non-FNMA MBS: Non-Agency",linetype="Non-FNMA MBS: Non-Agency"))

color         <- scale_color_manual(" ", breaks=c("Mortgage Loans","FNMA MBS in Portfolio","Non-FNMA MBS: Agency","Non-FNMA MBS: Non-Agency"), values=c( "Mortgage Loans"="blue", "FNMA MBS in Portfolio"="red","Non-FNMA MBS: Non-Agency" = "black","Non-FNMA MBS: Agency" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Loans","FNMA MBS in Portfolio","Non-FNMA MBS: Agency","Non-FNMA MBS: Non-Agency"), values=c("Mortgage Loans"=1,"FNMA MBS in Portfolio"=1,"Non-FNMA MBS: Non-Agency"=1,"Non-FNMA MBS: Agency"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Loans","FNMA MBS in Portfolio","Non-FNMA MBS: Agency","Non-FNMA MBS: Non-Agency"), values=c("Mortgage Loans"=2,"FNMA MBS in Portfolio"=2,"Non-FNMA MBS: Non-Agency"=2,"Non-FNMA MBS: Agency"=2))
title         <- ggtitle("FNMA: Retained Mortgage Portfolio Composition")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2005-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.70, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Billions")
fnmatableC <- fnmatableC +g1+g2+g3+g4+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fnmatableC) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000, 50),0)) 

```

### FNMA MBS {-}

```{r FNMAMBS_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

FNMAMBS      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_mbs_iss/1000 ,color="Issuance",linetype="Issuance"))
g2 <- geom_line(aes(y=Data$fnma_mbs_liq/1000, color="Liquidations",linetype="Liquidations"))
g3 <- geom_line(aes(y=fhlmcsalestomortorig, color="FHLMC Mortgage Sales (Issuance)",linetype="FHLMC Mortgage Sales (Issuance)"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Liquidations","Issuance","FHLMC Mortgage Sales (Issuance)","Total"), values=c( "Liquidations"="blue", "Issuance"="red","Total" = "black","FHLMC Mortgage Sales (Issuance)" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Liquidations","Issuance","FHLMC Mortgage Sales (Issuance)","Total"), values=c("Liquidations"=1,"Issuance"=1,"Total"=1,"FHLMC Mortgage Sales (Issuance)"=1))
size          <- scale_size_manual(" ", breaks=c("Liquidations","Issuance","FHLMC Mortgage Sales (Issuance)","Total"), values=c("Liquidations"=2,"Issuance"=2,"Total"=2,"FHLMC Mortgage Sales (Issuance)"=2))
title         <- ggtitle("FNMA MBS")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1997-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions; Source: FNMA Monthly Summary (Table 4)")
FNMAMBS <- FNMAMBS +g1+g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(FNMAMBS) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000000, 10),0)) 

```

### FNMA Book of Business {-}

```{r FNMABusiness_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

FNMABusiness      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_book_business/1000 ,color="Book of Business",linetype="Book of Business"))
g2 <- geom_line(aes(y=Data$fnma_net_mbs_out/1000, color="FNMA MBS Outstanding",linetype="FNMA MBS Outstanding"))
g3 <- geom_line(aes(y=Data$fnma_mort_hold/1000, color="Mortgage Loans",linetype="Mortgage Loans"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("FNMA MBS Outstanding","Book of Business","Mortgage Loans","Total"), values=c( "FNMA MBS Outstanding"="blue", "Book of Business"="red","Total" = "black","Mortgage Loans" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("FNMA MBS Outstanding","Book of Business","Mortgage Loans","Total"), values=c("FNMA MBS Outstanding"=1,"Book of Business"=1,"Total"=1,"Mortgage Loans"=1))
size          <- scale_size_manual(" ", breaks=c("FNMA MBS Outstanding","Book of Business","Mortgage Loans","Total"), values=c("FNMA MBS Outstanding"=2,"Book of Business"=2,"Total"=2,"Mortgage Loans"=2))
title         <- ggtitle("FNMA Book of Business")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1997-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions; Source: FNMA Monthly Summary (Table 1)")
FNMABusiness <- FNMABusiness +g1+g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(FNMABusiness) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 100000000, 200),0)) 

```

### FNMA Retained Mortgage Portfolio Activity {-}

```{r FNMAretainedactivity_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

FNMAretainedactivity      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_port_pur/1000 ,color="Purchases",linetype="Purchases"))
g2 <- geom_line(aes(y=Data$fnma_port_sales/1000, color="Sales",linetype="Sales"))
g3 <- geom_line(aes(y=Data$fnma_port_liq/1000, color="Liquidations",linetype="Liquidations"))
g4 <- geom_line(aes(y=Data$fnma_port_mbs/1000, color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Sales","Purchases","Liquidations","Total"), values=c( "Sales"="blue", "Purchases"="red","Total" = "black","Liquidations" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Sales","Purchases","Liquidations","Total"), values=c("Sales"=1,"Purchases"=1,"Total"=1,"Liquidations"=1))
size          <- scale_size_manual(" ", breaks=c("Sales","Purchases","Liquidations","Total"), values=c("Sales"=2,"Purchases"=2,"Total"=2,"Liquidations"=2))
title         <- ggtitle("FNMA Retained Mortgage Portfolio Activity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1997-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions; Source: FNMA Monthly Summary (Table 2)")
FNMAretainedactivity <- FNMAretainedactivity +g1+g2+g3+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 100000000, 5),0)) 

nberShade(FNMAretainedactivity)

```

### FNMA Long-term Debt Activity {-}

```{r fnmatable_debt, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fnmatable_debt  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fnma_debt_l1yr, color="Original Maturity < 1 Year End Balance",linetype="Original Maturity < 1 Year End Balance"))
g2 <- geom_line(aes(y=Data$fnma_debt_iss_g1, color="Issuances",linetype="Issuances"))
g4 <- geom_line(aes(y=Data$fnma_debt_maturities_redemptions, color="Maturities and Redemptions",linetype="Maturities and Redemptions"))
g5 <- geom_line(aes(y=Data$fnma_debt_repuchases, color="Repurchases",linetype="Repurchases"))
g3 <- geom_line(aes(y=Data$fnma_debt_out_g1, color="End Balance",linetype="End Balance"))
g6 <- geom_line(aes(y=Data$fnma_out, color="Total Debt Outstanding",linetype="Total Debt Outstanding"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Issuances","End Balance","Maturities and Redemptions","Repurchases","Total Debt Outstanding","20Y"), values=c( "Issuances"="blue", "Original Maturity < 1 Year End Balance"="red","Repurchases" = "black","Maturities and Redemptions" ="green","End Balance"="red","Total Debt Outstanding" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Issuances","End Balance","Maturities and Redemptions","Repurchases","Total Debt Outstanding","20Y"), values=c("Issuances"=1,"Original Maturity < 1 Year End Balance"=1,"Repurchases"=1,"Maturities and Redemptions"=1,"End Balance"=2,"Total Debt Outstanding"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Issuances","End Balance","Maturities and Redemptions","Repurchases","Total Debt Outstanding","20Y"), values=c("Issuances"=2,"Original Maturity < 1 Year End Balance"=2,"Repurchases"=2,"Maturities and Redemptions"=3,"End Balance"=2,"Total Debt Outstanding"=2,"20Y"=3))
title         <- ggtitle("FNMA Long-term Debt Activity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2006-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Note: in millions; Source: FNMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100000, 5000),0))

fnmatable_debt <- fnmatable_debt +g2+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fnmatable_debt) + yscale
```

### FNMA Debt Outstanding {-}

```{r fnmatable_debt_out, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fnmatable_debt_out  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fnma_debt_l1yr/1000, color="Original Maturity < 1 Year End Balance",linetype="Original Maturity < 1 Year End Balance"))
g2 <- geom_line(aes(y=Data$fnma_debt_iss_g1, color="Original Maturity >1 Year: Issuances",linetype="Original Maturity >1 Year: Issuances"))
g4 <- geom_line(aes(y=Data$fnma_debt_maturities_redemptions, color="Original Maturity >1 Year: Maturities and Redemptions",linetype="Original Maturity >1 Year: Maturities and Redemptions"))
g5 <- geom_line(aes(y=Data$fnma_debt_repuchases, color="Original Maturity >1 Year: Repurchases",linetype="Original Maturity >1 Year: Repurchases"))
g3 <- geom_line(aes(y=Data$fnma_debt_out_g1/1000, color="Original Maturity >1 Year: End Balance",linetype="Original Maturity >1 Year: End Balance"))
g6 <- geom_line(aes(y=Data$fnma_out/1000, color="Total Debt Outstanding",linetype="Total Debt Outstanding"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Original Maturity >1 Year: Issuances","Original Maturity >1 Year: End Balance","Original Maturity >1 Year: Maturities and Redemptions","Original Maturity >1 Year: Repurchases","Total Debt Outstanding","20Y"), values=c( "Original Maturity >1 Year: Issuances"="blue", "Original Maturity < 1 Year End Balance"="red","Original Maturity >1 Year: Repurchases" = "black","Original Maturity >1 Year: Maturities and Redemptions" ="green","Original Maturity >1 Year: End Balance"="green","Total Debt Outstanding" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Original Maturity >1 Year: Issuances","Original Maturity >1 Year: End Balance","Original Maturity >1 Year: Maturities and Redemptions","Original Maturity >1 Year: Repurchases","Total Debt Outstanding","20Y"), values=c("Original Maturity >1 Year: Issuances"=1,"Original Maturity < 1 Year End Balance"=1,"Original Maturity >1 Year: Repurchases"=1,"Original Maturity >1 Year: Maturities and Redemptions"=1,"Original Maturity >1 Year: End Balance"=2,"Total Debt Outstanding"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Original Maturity >1 Year: Issuances","Original Maturity >1 Year: End Balance","Original Maturity >1 Year: Maturities and Redemptions","Original Maturity >1 Year: Repurchases","Total Debt Outstanding","20Y"), values=c("Original Maturity >1 Year: Issuances"=2,"Original Maturity < 1 Year End Balance"=2,"Original Maturity >1 Year: Repurchases"=2,"Original Maturity >1 Year: Maturities and Redemptions"=3,"Original Maturity >1 Year: End Balance"=2,"Total Debt Outstanding"=2,"20Y"=3))
title         <- ggtitle("FNMA Debt Outstanding")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.60, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Note: in Billions; Source: FNMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000, 100),0))

fnmatable_debt_out <- fnmatable_debt_out +g1+g3+g6+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fnmatable_debt_out) + yscale
```

## Freddie Mac Monthly Volume Summary {-}

### FHLMC Total Mortgage Portfolio {-}

```{r fhlmc_port_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_port      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_port_pur/1000 ,color="Issuance",linetype="Issuance"))
g2 <- geom_line(aes(y=Data$fhlmc_port_liq/1000, color="Liquidations",linetype="Liquidations"))
g3 <- geom_line(aes(y=Data$fhlmc_port_sales/1000, color="Sales",linetype="Sales"))
g4 <- geom_line(aes(y=Data$fhlmc_port_netch/1000, color="Net Change",linetype="Net Change"))

color         <- scale_color_manual(" ", breaks=c("Liquidations","Issuance","Sales","Net Change"), values=c( "Liquidations"="blue", "Issuance"="red","Net Change" = "black","Sales" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Liquidations","Issuance","Sales","Net Change"), values=c("Liquidations"=1,"Issuance"=1,"Net Change"=1,"Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Liquidations","Issuance","Sales","Net Change"), values=c("Liquidations"=2,"Issuance"=2,"Net Change"=2,"Sales"=2))
title         <- ggtitle("FHLMC Total Mortgage Portfolio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions")
fhlmc_port <- fhlmc_port +g1+g2+g3+g4+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
hline         <- geom_hline(yintercept = 0, linetype="dashed")

nberShade(fhlmc_port) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-140, 1000000, 10),0)) + hline

```

### FHLMC Total Mortgage Portfolio Rates {-}

```{r fhlmc_port_gr_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_port_gr      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_port_ann_gr ,color="Annualized Growth Rate",linetype="Annualized Growth Rate"))
g2 <- geom_line(aes(y=Data$fhlmc_port_ann_liq, color="Annualized Liquidation Rate",linetype="Annualized Liquidation Rate"))
g3 <- geom_line(aes(y=Data$fhlmc_port_gr_sales/1000, color="Sales",linetype="Sales"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Annualized Liquidation Rate","Annualized Growth Rate","Sales","Total"), values=c( "Annualized Liquidation Rate"="blue", "Annualized Growth Rate"="red","Total" = "black","Sales" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Annualized Liquidation Rate","Annualized Growth Rate","Sales","Total"), values=c("Annualized Liquidation Rate"=1,"Annualized Growth Rate"=1,"Total"=1,"Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Annualized Liquidation Rate","Annualized Growth Rate","Sales","Total"), values=c("Annualized Liquidation Rate"=2,"Annualized Growth Rate"=2,"Total"=2,"Sales"=2))
title         <- ggtitle("FHLMC Total Mortgage Portfolio Rates") 
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
fhlmc_port_gr <- fhlmc_port_gr +g1+g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
hline         <- geom_hline(yintercept = 0, linetype="dashed")

nberShade(fhlmc_port_gr) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-140, 100, 5),0)) + hline

```

### FHLMC Mortgage Related Securities {-}

```{r FHLMCMBS_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

FHLMCMBS      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_mrs_iss/1000 ,color="Issuance",linetype="Issuance"))
g2 <- geom_line(aes(y=Data$fhlmc_mrs_liq*-1/1000, color="Liquidations",linetype="Liquidations"))
g3 <- geom_line(aes(y=Data$fhlmc_mrs_netch/1000, color="Net Change",linetype="Net Change"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Liquidations","Issuance","Net Change","Total"), values=c( "Liquidations"="blue", "Issuance"="red","Total" = "black","Net Change" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Liquidations","Issuance","Net Change","Total"), values=c("Liquidations"=1,"Issuance"=1,"Total"=1,"Net Change"=1))
size          <- scale_size_manual(" ", breaks=c("Liquidations","Issuance","Net Change","Total"), values=c("Liquidations"=2,"Issuance"=2,"Total"=2,"Net Change"=2))
title         <- ggtitle("FHLMC Mortgage Related Securities")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions")
FHLMCMBS <- FHLMCMBS +g1+g2+g3+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
hline         <- geom_hline(yintercept = 0, linetype="dashed")

nberShade(FHLMCMBS) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-140, 1000000, 10),0)) + hline

```

### FHLMC Mortage Related Investments Portfolio {-}

```{r fhlmc_mrip_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_mrip      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_mrip_pur/1000 ,color="Issuance",linetype="Issuance"))
g2 <- geom_line(aes(y=Data$fhlmc_mrip_liq/1000, color="Liquidations",linetype="Liquidations"))
g3 <- geom_line(aes(y=Data$fhlmc_mrip_sales/1000, color="Sales",linetype="Sales"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Liquidations","Issuance","Sales","Total"), values=c( "Liquidations"="blue", "Issuance"="red","Total" = "black","Sales" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Liquidations","Issuance","Sales","Total"), values=c("Liquidations"=1,"Issuance"=1,"Total"=1,"Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Liquidations","Issuance","Sales","Total"), values=c("Liquidations"=2,"Issuance"=2,"Total"=2,"Sales"=2))
title         <- ggtitle("FHLMC Mortage Related Investments Portfolio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions")
fhlmc_mrip <- fhlmc_mrip +g1+g2+g3+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
hline         <- geom_hline(yintercept = 0, linetype="dashed")

nberShade(fhlmc_mrip) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-140, 1000000, 10),0)) + hline

```
 
### FHLMC Mortage Related Investments Portfolio Rates {-}

```{r fhlmc_mrip_gr_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_mrip_gr      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_mrip_ann_gr ,color="Annualized Growth Rate",linetype="Annualized Growth Rate"))
g2 <- geom_line(aes(y=Data$fhlmc_mrip_ann_liq, color="Annualized Liquidation Rate",linetype="Annualized Liquidation Rate"))
g3 <- geom_line(aes(y=Data$fhlmc_mrip_gr_sales/1000, color="Sales",linetype="Sales"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Annualized Liquidation Rate","Annualized Growth Rate","Sales","Total"), values=c( "Annualized Liquidation Rate"="blue", "Annualized Growth Rate"="red","Total" = "black","Sales" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Annualized Liquidation Rate","Annualized Growth Rate","Sales","Total"), values=c("Annualized Liquidation Rate"=1,"Annualized Growth Rate"=1,"Total"=1,"Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Annualized Liquidation Rate","Annualized Growth Rate","Sales","Total"), values=c("Annualized Liquidation Rate"=2,"Annualized Growth Rate"=2,"Total"=2,"Sales"=2))
title         <- ggtitle("FHLMC Mortage Related Investments Portfolio Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
fhlmc_mrip_gr <- fhlmc_mrip_gr +g1+g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
hline         <- geom_hline(yintercept = 0, linetype="dashed")

nberShade(fhlmc_mrip_gr) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-140, 100, 5),0)) + hline

```

### FHLMC Portfolio Composition {-}

```{r fhlmc_mripc_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_mripc      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_mripc_fhlmc/1000 ,color="FHLMC MRS",linetype="FHLMC MRS"))
g2 <- geom_line(aes(y=Data$fhlmc_mripc_agency/1000, color="Agency MRS (ex-Freddie)",linetype="Agency MRS (ex-Freddie)"))
g3 <- geom_line(aes(y=Data$fhlmc_mripc_xagency/1000, color="non-Agency MRS (ex-Freddie)",linetype="non-Agency MRS (ex-Freddie)"))
g4 <- geom_line(aes(y=Data$fhlmc_mripc_mort_loans/1000, color="Mortgage Loans",linetype="Mortgage Loans"))

color         <- scale_color_manual(" ", breaks=c("Agency MRS (ex-Freddie)","FHLMC MRS","non-Agency MRS (ex-Freddie)","Mortgage Loans"), values=c( "Agency MRS (ex-Freddie)"="blue", "FHLMC MRS"="red","Mortgage Loans" = "black","non-Agency MRS (ex-Freddie)" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Agency MRS (ex-Freddie)","FHLMC MRS","non-Agency MRS (ex-Freddie)","Mortgage Loans"), values=c("Agency MRS (ex-Freddie)"=1,"FHLMC MRS"=1,"Mortgage Loans"=1,"non-Agency MRS (ex-Freddie)"=1))
size          <- scale_size_manual(" ", breaks=c("Agency MRS (ex-Freddie)","FHLMC MRS","non-Agency MRS (ex-Freddie)","Mortgage Loans"), values=c("Agency MRS (ex-Freddie)"=2,"FHLMC MRS"=2,"Mortgage Loans"=2,"non-Agency MRS (ex-Freddie)"=2))
title         <- ggtitle("FHLMC Portfolio Composition")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2002-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.6, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions")
fhlmc_mripc <- fhlmc_mripc +g1+g2+g3+g4+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fhlmc_mripc) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000000, 50),0)) 

```

### FHLMC Mortgage Related Securities Outstanding and Total Mortgage Holdings {-}

```{r FHLMCMBSout_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

FHLMCMBSout      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_mrs_endbal/1000 ,color="MBS Outstanding",linetype="MBS Outstanding"))
g2 <- geom_line(aes(y=Data$fhlmc_port_endbal/1000, color="Mortgage Portfolio Holdings",linetype="Mortgage Portfolio Holdings"))
g3 <- geom_line(aes(y=fhlmcsalestomortorig, color="FHLMC Mortgage Sales (MBS Outstanding)",linetype="FHLMC Mortgage Sales (MBS Outstanding)"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("Mortgage Portfolio Holdings","MBS Outstanding","FHLMC Mortgage Sales (MBS Outstanding)","Total"), values=c( "Mortgage Portfolio Holdings"="blue", "MBS Outstanding"="red","Total" = "black","FHLMC Mortgage Sales (MBS Outstanding)" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Portfolio Holdings","MBS Outstanding","FHLMC Mortgage Sales (MBS Outstanding)","Total"), values=c("Mortgage Portfolio Holdings"=1,"MBS Outstanding"=1,"Total"=1,"FHLMC Mortgage Sales (MBS Outstanding)"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Portfolio Holdings","MBS Outstanding","FHLMC Mortgage Sales (MBS Outstanding)","Total"), values=c("Mortgage Portfolio Holdings"=2,"MBS Outstanding"=2,"Total"=2,"FHLMC Mortgage Sales (MBS Outstanding)"=2))
title         <- ggtitle("FHLMC Mortgage Related Securities Outstanding and Total Mortgage Holdings")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions")
FHLMCMBSout <- FHLMCMBSout +g1+g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(FHLMCMBSout) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000, 200),0)) 

```

### Secondary Market Transactions in Mortgages {-}

```{r MBSTRANS_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

MBSTRANS      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=fnmapurtomortorig_ma ,color="FNMA Mortgage Purchases",linetype="FNMA Mortgage Purchases"))
g2 <- geom_line(aes(y=fhlmcpurtomortorig_ma, color="FHLMC Mortgage Purchases",linetype="FHLMC Mortgage Purchases"))
g3 <- geom_line(aes(y=fhlmcsalestomortorig, color="FHLMC Mortgage Sales (Issuance)",linetype="FHLMC Mortgage Sales (Issuance)"))
g4 <- geom_line(aes(y=log(Data.fnma_purch), color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("FHLMC Mortgage Purchases","FNMA Mortgage Purchases","FHLMC Mortgage Sales (Issuance)","Total"), values=c( "FHLMC Mortgage Purchases"="blue", "FNMA Mortgage Purchases"="red","Total" = "black","FHLMC Mortgage Sales (Issuance)" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("FHLMC Mortgage Purchases","FNMA Mortgage Purchases","FHLMC Mortgage Sales (Issuance)","Total"), values=c("FHLMC Mortgage Purchases"=1,"FNMA Mortgage Purchases"=1,"Total"=1,"FHLMC Mortgage Sales (Issuance)"=1))
size          <- scale_size_manual(" ", breaks=c("FHLMC Mortgage Purchases","FNMA Mortgage Purchases","FHLMC Mortgage Sales (Issuance)","Total"), values=c("FHLMC Mortgage Purchases"=2,"FNMA Mortgage Purchases"=2,"Total"=2,"FHLMC Mortgage Sales (Issuance)"=2))
title         <- ggtitle("Secondary Market Transactions in Mortgages")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1954-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: as a fraction of total mortgage originations, 3MMA")
MBSTRANS <- MBSTRANS +g1+g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(MBSTRANS) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000, .05),2)) 

```

### Freddie Mac Long-term Debt Activity {-}

```{r fhlmc_table_debt, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_table_debt  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_debt_l1yr, color="Original Maturity < 1 Year End Balance",linetype="Original Maturity < 1 Year End Balance"))
g2 <- geom_line(aes(y=Data$fhlmc_debt_iss_g1, color="Issuances",linetype="Issuances"))
g4 <- geom_line(aes(y=Data$fhlmc_debt_maturities_redemptions, color="Maturities and Redemptions",linetype="Maturities and Redemptions"))
g5 <- geom_line(aes(y=Data$fhlmc_debt_repuchases, color="Repurchases",linetype="Repurchases"))
g3 <- geom_line(aes(y=Data$fhlmc_debt_out_g1, color="End Balance",linetype="End Balance"))
g6 <- geom_line(aes(y=Data$fhlmc_out, color="Total Debt Outstanding",linetype="Total Debt Outstanding"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Issuances","End Balance","Maturities and Redemptions","Repurchases","Total Debt Outstanding","20Y"), values=c( "Issuances"="blue", "Original Maturity < 1 Year End Balance"="red","Repurchases" = "black","Maturities and Redemptions" ="green","End Balance"="red","Total Debt Outstanding" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Issuances","End Balance","Maturities and Redemptions","Repurchases","Total Debt Outstanding","20Y"), values=c("Issuances"=1,"Original Maturity < 1 Year End Balance"=1,"Repurchases"=1,"Maturities and Redemptions"=1,"End Balance"=2,"Total Debt Outstanding"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Issuances","End Balance","Maturities and Redemptions","Repurchases","Total Debt Outstanding","20Y"), values=c("Issuances"=2,"Original Maturity < 1 Year End Balance"=2,"Repurchases"=2,"Maturities and Redemptions"=3,"End Balance"=2,"Total Debt Outstanding"=2,"20Y"=3))
title         <- ggtitle("Freddie Mac Long-term Debt Activity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2006-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Note: in millions; Source: FHLMC")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100000, 5000),0))

fhlmc_table_debt <- fhlmc_table_debt +g2+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fhlmc_table_debt) + yscale
```

### Freddie Mac Debt Outstanding {-}

```{r fhlmc_table_debt_out, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhlmc_table_debt_out  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fhlmc_debt_l1yr/1000, color="Original Maturity < 1 Year End Balance",linetype="Original Maturity < 1 Year End Balance"))
g2 <- geom_line(aes(y=Data$fhlmc_debt_iss_g1, color="Original Maturity >1 Year: Issuances",linetype="Original Maturity >1 Year: Issuances"))
g4 <- geom_line(aes(y=Data$fhlmc_debt_maturities_redemptions, color="Original Maturity >1 Year: Maturities and Redemptions",linetype="Original Maturity >1 Year: Maturities and Redemptions"))
g5 <- geom_line(aes(y=Data$fhlmc_debt_repuchases, color="Original Maturity >1 Year: Repurchases",linetype="Original Maturity >1 Year: Repurchases"))
g3 <- geom_line(aes(y=Data$fhlmc_debt_out_g1/1000, color="Original Maturity >1 Year: End Balance",linetype="Original Maturity >1 Year: End Balance"))
g6 <- geom_line(aes(y=Data$fhlmc_out/1000, color="Total Debt Outstanding",linetype="Total Debt Outstanding"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Original Maturity >1 Year: Issuances","Original Maturity >1 Year: End Balance","Original Maturity >1 Year: Maturities and Redemptions","Original Maturity >1 Year: Repurchases","Total Debt Outstanding","20Y"), values=c( "Original Maturity >1 Year: Issuances"="blue", "Original Maturity < 1 Year End Balance"="red","Original Maturity >1 Year: Repurchases" = "black","Original Maturity >1 Year: Maturities and Redemptions" ="green","Original Maturity >1 Year: End Balance"="green","Total Debt Outstanding" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Original Maturity >1 Year: Issuances","Original Maturity >1 Year: End Balance","Original Maturity >1 Year: Maturities and Redemptions","Original Maturity >1 Year: Repurchases","Total Debt Outstanding","20Y"), values=c("Original Maturity >1 Year: Issuances"=1,"Original Maturity < 1 Year End Balance"=1,"Original Maturity >1 Year: Repurchases"=1,"Original Maturity >1 Year: Maturities and Redemptions"=1,"Original Maturity >1 Year: End Balance"=2,"Total Debt Outstanding"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("Original Maturity < 1 Year End Balance","Original Maturity >1 Year: Issuances","Original Maturity >1 Year: End Balance","Original Maturity >1 Year: Maturities and Redemptions","Original Maturity >1 Year: Repurchases","Total Debt Outstanding","20Y"), values=c("Original Maturity >1 Year: Issuances"=2,"Original Maturity < 1 Year End Balance"=2,"Original Maturity >1 Year: Repurchases"=2,"Original Maturity >1 Year: Maturities and Redemptions"=3,"Original Maturity >1 Year: End Balance"=2,"Total Debt Outstanding"=2,"20Y"=3))
title         <- ggtitle("Freddie Mac Debt Outstanding")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.60, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Note: in Billions; Source: FHLMC")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000, 100),0))

fhlmc_table_debt_out <- fhlmc_table_debt_out +g1+g3+g6+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fhlmc_table_debt_out) + yscale
```

## FNMA Multifamily Mortgages {-}

### FNMA Multifamily MBS Issuances and Loan Purchases {-}

```{r fnmamfiss_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fnmamfiss      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fnma_mf_dus_fixed_iss ,color="DUS Fixed",linetype="DUS Fixed"))
g2 <- geom_line(aes(y=Data$fnma_mf_dus_arm_iss, color="DUS ARM",linetype="DUS ARM"))
g3 <- geom_line(aes(y=Data$fnma_mf_mortloan_pur, color="Loan Purchases",linetype="Loan Purchases"))
g4 <- geom_line(aes(y=Data$fnma_mf_total_pur_iss, color="Total",linetype="Total"))

color         <- scale_color_manual(" ", breaks=c("DUS ARM","DUS Fixed","Loan Purchases","Total"), values=c( "DUS ARM"="blue", "DUS Fixed"="red","Total" = "black","Loan Purchases" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("DUS ARM","DUS Fixed","Loan Purchases","Total"), values=c("DUS ARM"=1,"DUS Fixed"=1,"Total"=1,"Loan Purchases"=1))
size          <- scale_size_manual(" ", breaks=c("DUS ARM","DUS Fixed","Loan Purchases","Total"), values=c("DUS ARM"=2,"DUS Fixed"=2,"Total"=2,"Loan Purchases"=2))
title         <- ggtitle("FNMA Multifamily MBS Issuances and Loan Purchases")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2005-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Millions; Source: FNMA")
fnmamfiss <- fnmamfiss +g1+g2+g3+g4+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fnmamfiss) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000, 500),0)) 

```

```{r fnmapricetorents_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
# 
# fnmapricetorents      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
# g1 <- geom_line(aes(y=Data$fnma_mf_pricetorent ,color="Price-to-Rent",linetype="Price-to-Rent"))
# g2 <- geom_line(aes(y=Data$fnma_mf_pricetoincome, color="FNMA MF weighted Price-to-Income",linetype="FNMA MF weighted Price-to-Income"))
# g3 <- geom_line(aes(y=Data$fnma_mf_unrate, color="FNMA MF weighted Unemployment Rate",linetype="FNMA MF weighted Unemployment Rate"))
# g4 <- geom_line(aes(y=Data$fnma_mf_pricetoincome_cum, color="Cumulative change in Price-to-Income",linetype="Cumulative change in Price-to-Income"))
# 
# color         <- scale_color_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","Price-to-Rent","FNMA MF weighted Unemployment Rate","Cumulative change in Price-to-Income"), values=c( "FNMA MF weighted Price-to-Income"="blue", "Price-to-Rent"="red","Cumulative change in Price-to-Income" = "black","FNMA MF weighted Unemployment Rate" ="green"))
# linetype      <- scale_linetype_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","Price-to-Rent","FNMA MF weighted Unemployment Rate","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=1,"Price-to-Rent"=1,"Cumulative change in Price-to-Income"=1,"FNMA MF weighted Unemployment Rate"=1))
# size          <- scale_size_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","Price-to-Rent","FNMA MF weighted Unemployment Rate","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=2,"Price-to-Rent"=2,"Cumulative change in Price-to-Income"=2,"FNMA MF weighted Unemployment Rate"=2))
# title         <- ggtitle("FNMA Multifamily weighted Price-to-Rent")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("2010-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Notes: Millions; Source: FNMA")
# fnmapricetorents <- fnmapricetorents +g1+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(fnmapricetorents) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000, .1),2)) 

```

```{r fnmaunrate_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# fnmaunrate      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
# g1 <- geom_line(aes(y=Data$urate ,color="U.S. Unemployment Rate",linetype="U.S. Unemployment Rate"))
# g2 <- geom_line(aes(y=Data$fnma_mf_pricetoincome, color="FNMA MF weighted Price-to-Income",linetype="FNMA MF weighted Price-to-Income"))
# g3 <- geom_line(aes(y=Data$fnma_mf_unrate, color="FNMA MF weighted Unemployment Rate",linetype="FNMA MF weighted Unemployment Rate"))
# g4 <- geom_line(aes(y=Data$fnma_mf_pricetoincome_cum, color="Cumulative change in Price-to-Income",linetype="Cumulative change in Price-to-Income"))
# 
# color         <- scale_color_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","U.S. Unemployment Rate","FNMA MF weighted Unemployment Rate","Cumulative change in Price-to-Income"), values=c( "FNMA MF weighted Price-to-Income"="blue", "U.S. Unemployment Rate"="red","Cumulative change in Price-to-Income" = "black","FNMA MF weighted Unemployment Rate" ="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","U.S. Unemployment Rate","FNMA MF weighted Unemployment Rate","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=1,"U.S. Unemployment Rate"=1,"Cumulative change in Price-to-Income"=1,"FNMA MF weighted Unemployment Rate"=1))
# size          <- scale_size_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","U.S. Unemployment Rate","FNMA MF weighted Unemployment Rate","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=2,"U.S. Unemployment Rate"=2,"Cumulative change in Price-to-Income"=2,"FNMA MF weighted Unemployment Rate"=2))
# title         <- ggtitle("FNMA Multifamily Unemployment Rate and U.S. Unemployment Rate")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("2003-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Source: FNMA, GeoFRED")
# fnmaunrate <- fnmaunrate +g1+g3+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(fnmaunrate) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000, .5),2)) 

```

```{r fnmapricetoincome_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# pricetoincome      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
# g1 <- geom_line(aes(y=Data$urate ,color="U.S. Price-to-Median Income",linetype="U.S. Price-to-Median Income"))
# g2 <- geom_line(aes(y=Data$fnma_mf_pricetoincome, color="FNMA MF weighted Price-to-Income",linetype="FNMA MF weighted Price-to-Income"))
# g3 <- geom_line(aes(y=Data$pricetoincome, color="U.S. Price-to-Income",linetype="U.S. Price-to-Income"))
# g4 <- geom_line(aes(y=Data$fnma_mf_pricetoincome_cum, color="Cumulative change in Price-to-Income",linetype="Cumulative change in Price-to-Income"))
# 
# color         <- scale_color_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","U.S. Price-to-Median Income","U.S. Price-to-Income","Cumulative change in Price-to-Income"), values=c( "FNMA MF weighted Price-to-Income"="red", "U.S. Price-to-Median Income"="red","Cumulative change in Price-to-Income" = "black","U.S. Price-to-Income" ="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","U.S. Price-to-Median Income","U.S. Price-to-Income","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=1,"U.S. Price-to-Median Income"=1,"Cumulative change in Price-to-Income"=1,"U.S. Price-to-Income"=1))
# size          <- scale_size_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","U.S. Price-to-Median Income","U.S. Price-to-Income","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=2,"U.S. Price-to-Median Income"=2,"Cumulative change in Price-to-Income"=2,"U.S. Price-to-Income"=2))
# title         <- ggtitle("FNMA Multifamily Price-to-Median Income and U.S. Price-to-Median Income")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("2003-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Source: FNMA, Zillow")
# pricetoincome <- pricetoincome +g2+g3+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(pricetoincome) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000, .5),2)) 

```

```{r fnmahpi_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# hpi      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
# g1 <- geom_line(aes(y=Data$fnma_mf_hpi/1000 ,color="FNMA Home Prices",linetype="FNMA Home Prices"))
# g2 <- geom_line(aes(y=Data$fnma_mf_hpi, color="FNMA MF weighted Price-to-Income",linetype="FNMA MF weighted Price-to-Income"))
# g3 <- geom_line(aes(y=Data$hpi, color="U.S. Price-to-Income",linetype="U.S. Price-to-Income"))
# g4 <- geom_line(aes(y=Data$fnma_mf_hpi_cum, color="Cumulative change in Price-to-Income",linetype="Cumulative change in Price-to-Income"))
# 
# color         <- scale_color_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","FNMA Home Prices","U.S. Price-to-Income","Cumulative change in Price-to-Income"), values=c( "FNMA MF weighted Price-to-Income"="red", "FNMA Home Prices"="red","Cumulative change in Price-to-Income" = "black","U.S. Price-to-Income" ="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","FNMA Home Prices","U.S. Price-to-Income","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=1,"FNMA Home Prices"=1,"Cumulative change in Price-to-Income"=1,"U.S. Price-to-Income"=1))
# size          <- scale_size_manual(" ", breaks=c("FNMA MF weighted Price-to-Income","FNMA Home Prices","U.S. Price-to-Income","Cumulative change in Price-to-Income"), values=c("FNMA MF weighted Price-to-Income"=2,"FNMA Home Prices"=2,"Cumulative change in Price-to-Income"=2,"U.S. Price-to-Income"=2))
# title         <- ggtitle("FNMA Multifamily weighted Home Prices")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("2003-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data;Notes: Thousands of dollars; Source: FNMA, Zillow")
# hpi <- hpi +g1+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(hpi) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000000, 10),0)) 

```

## GNMA Issuance {-}

### GNMA Multifamily Pool Issuance {-}

```{r gnmamfiss, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

gnmamfiss  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gnma_gm1_mf_cl_iss, color="CL/CS",linetype="CL/CS"))
g2 <- geom_line(aes(y=Data$gnma_gm1_mf_lm_iss, color="LM",linetype="LM"))
g4 <- geom_line(aes(y=Data$gnma_gm1_mf_ls_iss, color="LS",linetype="LS"))
g5 <- geom_line(aes(y=Data$gnma_gm1_mf_pl_iss, color="PL",linetype="PL"))
g3 <- geom_line(aes(y=Data$gnma_gm1_mf_pn_iss, color="PN",linetype="PN"))
g6 <- geom_line(aes(y=Data$gnma_gm1_mf_rx_iss, color="RX",linetype="RX"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("CL/CS","LM","PN","LS","PL","RX","20Y"), values=c( "LM"="blue", "CL/CS"="red","PL" = "black","LS" ="green","PN"="red","RX" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("CL/CS","LM","PN","LS","PL","RX","20Y"), values=c("LM"=1,"CL/CS"=1,"PL"=1,"LS"=1,"PN"=2,"RX"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("CL/CS","LM","PN","LS","PL","RX","20Y"), values=c("LM"=2,"CL/CS"=2,"PL"=2,"LS"=3,"PN"=2,"RX"=2,"20Y"=3))
title         <- ggtitle("GNMA Multifamily Pool Issuance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2006-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Note: in millions; Source: GNMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,5000, 200),0))

gnmamfiss <- gnmamfiss +g1+g2+g3+g4+g5+g6+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(gnmamfiss) + yscale
```

## FHA Multifamily Mortgages {-}

### FHA Multifamily Gross Endorsements-to-GDP {-}

```{r fhamforig, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_mf_fhaorig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fha_mf_iss/1000000/Data$ngdpm, color="FHA Gross Endorsements-to-GDP",linetype="FHA Gross Endorsements-to-GDP"))
g2 <- geom_line(aes(y=mortorigtogdp, color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","FHA Gross Endorsements-to-GDP"), values=c( "Mortgage Originations-to-GDP"="blue", "FHA Gross Endorsements-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","FHA Gross Endorsements-to-GDP"), values=c("Mortgage Originations-to-GDP"=1,"FHA Gross Endorsements-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","FHA Gross Endorsements-to-GDP"), values=c("Mortgage Originations-to-GDP"=2,"FHA Gross Endorsements-to-GDP"=2))
title         <- ggtitle("FHA Multifamily Gross Endorsements-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1946-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1, .001),3),limits = c(0,.007))

Figure_mf_fhaorig <- Figure_mf_fhaorig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_mf_fhaorig) +yscale
```

### FHA Multifamily Real Gross Endorsements {-}

```{r fhamforigreal, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_mf_fhaorig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fha_mf_iss/1000000/Data$cpi*100, color="FHA Gross Endorsements-to-GDP",linetype="FHA Gross Endorsements-to-GDP"))
g2 <- geom_line(aes(y=mortorigtogdp, color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","FHA Gross Endorsements-to-GDP"), values=c( "Mortgage Originations-to-GDP"="blue", "FHA Gross Endorsements-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","FHA Gross Endorsements-to-GDP"), values=c("Mortgage Originations-to-GDP"=1,"FHA Gross Endorsements-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","FHA Gross Endorsements-to-GDP"), values=c("Mortgage Originations-to-GDP"=2,"FHA Gross Endorsements-to-GDP"=2))
title         <- ggtitle("FHA Multifamily Real Gross Endorsements")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1936-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Deflated by CPI, in millions of dollars")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1100, 100),0),limits = c(0,1100))

Figure_mf_fhaorig <- Figure_mf_fhaorig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_mf_fhaorig) + yscale
```

### FHA Gross Endorsements-to-GDP {-}

```{r fha_out, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_mf__out      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=(Data$fha_mf_iss/100000)/Data$ngdpm, color="Multifamily",linetype="Multifamily"))
g2 <- geom_line(aes(y=(Data$fhagross)/Data$ngdpm, color="Single-family",linetype="Single-family"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Single-family","Multifamily"), values=c( "Single-family"="blue", "Multifamily"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Single-family","Multifamily"), values=c("Single-family"=1,"Multifamily"=1))
size          <- scale_size_manual(" ", breaks=c("Single-family","Multifamily"), values=c("Single-family"=2,"Multifamily"=2))
title         <- ggtitle("FHA Gross Endorsements-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1946-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, FHA Multifamily Endorsements have been multiplied by 10x")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,0.065, .005),3),limits = c(0,.055))

Figure_mf__out <- Figure_mf__out + g1 + g2+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(Figure_mf__out)+ yscale
```

### FHA Insured 40-yr Multifamily Interest Rates {-}

```{r fhamfratesA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_mf_rates      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$fha_mf_40yr_refi_pur_mort_rate, color="Refi/Purchase Rate",linetype="Refi/Purchase Rate"))
g2 <- geom_line(aes(y=Data$fha_mf_40_yr_nc_mort_rate, color="New Construction Rate",linetype="New Construction Rate"))

# hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("New Construction Rate","Refi/Purchase Rate"), values=c( "New Construction Rate"="blue", "Refi/Purchase Rate"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("New Construction Rate","Refi/Purchase Rate"), values=c("New Construction Rate"=1,"Refi/Purchase Rate"=1))
size          <- scale_size_manual(" ", breaks=c("New Construction Rate","Refi/Purchase Rate"), values=c("New Construction Rate"=2,"Refi/Purchase Rate"=2))
title         <- ggtitle("FHA Insured 40-yr Multifamily Interest Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1951-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,15, 1),0))

Figure_mf_rates <- Figure_mf_rates + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(Figure_mf_rates)+yscale
```

### FHA Multifamily Mortgage Rate and Single Family Mortgage Rate {-}

```{r mf_rates_mort, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

mf_rates_mort  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fha_mf_cur_mort_rate_wtd, color="FHA Multifamily Mortgage Rate",linetype="FHA Multifamily Mortgage Rate"))
g2 <- geom_line(aes(y=Data$baa, color="BAA Corporate",linetype="BAA Corporate"))
g3 <- geom_line(aes(y=Data$ten, color="Treasury 10Y",linetype="Treasury 10Y"))
g4 <- geom_line(aes(y=Data$mort_rate, color="Single-family Mortgage Rate",linetype="Single-family Mortgage Rate"))

color         <- scale_color_manual(" ", breaks=c("BAA Corporate","FHA Multifamily Mortgage Rate","Single-family Mortgage Rate","Treasury 10Y"), values=c( "BAA Corporate"="blue", "FHA Multifamily Mortgage Rate"="red","Single-family Mortgage Rate" = "black","Treasury 10Y" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("BAA Corporate","FHA Multifamily Mortgage Rate","Single-family Mortgage Rate","Treasury 10Y"), values=c("BAA Corporate"=1,"FHA Multifamily Mortgage Rate"=1,"Single-family Mortgage Rate"=1,"Treasury 10Y"=1))
size          <- scale_size_manual(" ", breaks=c("BAA Corporate","FHA Multifamily Mortgage Rate","Single-family Mortgage Rate","Treasury 10Y"), values=c("BAA Corporate"=2,"FHA Multifamily Mortgage Rate"=2,"Single-family Mortgage Rate"=2,"Treasury 10Y"=3))
title         <- ggtitle("FHA Multifamily Mortgage Rate and Single Family Mortgage Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1935-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(2, max(Data$mort_rate,na.rm = TRUE), 1),0))

mf_rates_mort <- mf_rates_mort +g1+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(mf_rates_mort) + yscale
```

### FHA Multifamily Mortgage Refi Incentive {-}

```{r mf_rates_mort2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

mf_rates_mort2  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fha_mf_cur_mort_rate_wtd, color="FHA Multifamily Mortgage Rate",linetype="FHA Multifamily Mortgage Rate"))
g2 <- geom_line(aes(y=Data$fha_mf_avg_mort_rate_out, color="Avg Mortgage Rate Outstanding",linetype="Avg Mortgage Rate Outstanding"))
g3 <- geom_line(aes(y=Data$fha_mf_intrate_prepay, color="Prepaid Mortgage Rate",linetype="Prepaid Mortgage Rate"))
g4 <- geom_line(aes(y=Data$fha_mf_refi_inc, color="Refi Incentive",linetype="Refi Incentive"))

color         <- scale_color_manual(" ", breaks=c("Avg Mortgage Rate Outstanding","FHA Multifamily Mortgage Rate","Refi Incentive","Prepaid Mortgage Rate"), values=c( "Avg Mortgage Rate Outstanding"="blue", "FHA Multifamily Mortgage Rate"="red","Refi Incentive" = "black","Prepaid Mortgage Rate" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Avg Mortgage Rate Outstanding","FHA Multifamily Mortgage Rate","Refi Incentive","Prepaid Mortgage Rate"), values=c("Avg Mortgage Rate Outstanding"=1,"FHA Multifamily Mortgage Rate"=1,"Refi Incentive"=1,"Prepaid Mortgage Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Avg Mortgage Rate Outstanding","FHA Multifamily Mortgage Rate","Refi Incentive","Prepaid Mortgage Rate"), values=c("Avg Mortgage Rate Outstanding"=2,"FHA Multifamily Mortgage Rate"=2,"Refi Incentive"=2,"Prepaid Mortgage Rate"=3))
title         <- ggtitle("FHA Multifamily Mortgage Refi Incentive")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1935-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-8, max(Data$mort_rate,na.rm = TRUE), 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

mf_rates_mort2 <- mf_rates_mort2 +g1+g2 +g3+ g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(mf_rates_mort2) + yscale
```

### Real value of FHA Insured Debt per Apartment Unit {-}

```{r fhaoutplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_fhaout      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
# g1 <- geom_line(aes(y= Data$cre_pi/Data$cpi*100, color="Total Insured Units",linetype="Total Insured Units"))
g1 <- geom_line(aes(y= (Data$fha_mf_mort_debt_out/Data$fha_mf_total_units_in_force)/1000/Data$cpi*100, color="Total Insured Units",linetype="Total Insured Units"))

# g2 <- geom_line(aes(y=Data$cre_pi/Data$cpi/100, color="Debt per new unit",linetype="Debt per new unit"))
g2 <- geom_line(aes(y=Data$fha_mf_new_debt_per_unit/1000/Data$cpi*100, color="Debt per new unit",linetype="Debt per new unit"))

color         <- scale_color_manual(" ", breaks=c("Debt per new unit","Total Insured Units"), values=c( "Debt per new unit"="blue", "Total Insured Units"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Debt per new unit","Total Insured Units"), values=c("Debt per new unit"=1,"Total Insured Units"=1))
size          <- scale_size_manual(" ", breaks=c("Debt per new unit","Total Insured Units"), values=c("Debt per new unit"=2,"Total Insured Units"=2))
title         <- ggtitle("Real value of FHA Insured Debt per Apartment Unit")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1936-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, deflated by CPI, Thousands of dollars")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,150000, 5),0),limits = c(10,60))

Figure_fhaout <- Figure_fhaout + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_fhaout) +yscale

```

### FHA Multifamily Mortgage Debt Insured-to-GDP {-}

```{r fhaoutplot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_fhaoutA      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$fha_mf_mort_debt_out/1000000/Data$ngdpm, color="Multifamily Mortgage Debt Insured",linetype="Multifamily Mortgage Debt Insured"))
g2 <- geom_line(aes(y=Data$fha_mf_avg_debt_per_unit/1000/Data$cpi*100, color="Debt per new unit",linetype="Debt per new unit"))

color         <- scale_color_manual(" ", breaks=c("Debt per new unit","Multifamily Mortgage Debt Insured"), values=c( "Debt per new unit"="blue", "Multifamily Mortgage Debt Insured"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Debt per new unit","Multifamily Mortgage Debt Insured"), values=c("Debt per new unit"=1,"Multifamily Mortgage Debt Insured"=1))
size          <- scale_size_manual(" ", breaks=c("Debt per new unit","Multifamily Mortgage Debt Insured"), values=c("Debt per new unit"=2,"Multifamily Mortgage Debt Insured"=2))
title         <- ggtitle("FHA Multifamily Mortgage Debt Insured-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1936-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10, .025),3))

Figure_fhaoutA <- Figure_fhaoutA + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_fhaoutA) +yscale

```

### FHA Multifamily Insured Prepayment Rate {-}

```{r fhaprepay, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_fhacpr      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$fha_mf_prepay_rate_wtd, color="Prepayment Rate",linetype="Prepayment Rate"))
g2 <- geom_line(aes(y=Data$fha_mf_prepay_amount/10000/Data$ngdpm*100, color="Amount Prepayed-to-GDP",linetype="Amount Prepayed-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Amount Prepayed-to-GDP","Prepayment Rate"), values=c( "Amount Prepayed-to-GDP"="blue", "Prepayment Rate"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Amount Prepayed-to-GDP","Prepayment Rate"), values=c("Amount Prepayed-to-GDP"=1,"Prepayment Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Amount Prepayed-to-GDP","Prepayment Rate"), values=c("Amount Prepayed-to-GDP"=2,"Prepayment Rate"=2))
title         <- ggtitle("FHA Multifamily Insured Prepayment Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1961-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,30, 1),1))

Figure_fhacpr <- Figure_fhacpr +g1+color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_fhacpr) + yscale

```

### FHA Multifamily Exit Rates {-}

```{r fhatrans_mult, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fhatrans_mult  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fha_mf_bad_exit_rate*100, color="Bad Exit Rate",linetype="Bad Exit Rate"))
g2 <- geom_line(aes(y=Data$fha_mf_maturity_rate*100, color="Maturity Exit Rate",linetype="Maturity Exit Rate"))
g3 <- geom_line(aes(y=Data$fha_mf_prepay_rate_wtd/1000, color="Prepaid Mortgage Rate",linetype="Prepaid Mortgage Rate"))
g4 <- geom_line(aes(y=Data$fha_mf_entry_ratesd, color="Refi Incentive",linetype="Refi Incentive"))

color         <- scale_color_manual(" ", breaks=c("Maturity Exit Rate","Bad Exit Rate","Refi Incentive","Prepaid Mortgage Rate"), values=c( "Maturity Exit Rate"="blue", "Bad Exit Rate"="red","Refi Incentive" = "black","Prepaid Mortgage Rate" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Maturity Exit Rate","Bad Exit Rate","Refi Incentive","Prepaid Mortgage Rate"), values=c("Maturity Exit Rate"=1,"Bad Exit Rate"=1,"Refi Incentive"=1,"Prepaid Mortgage Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Maturity Exit Rate","Bad Exit Rate","Refi Incentive","Prepaid Mortgage Rate"), values=c("Maturity Exit Rate"=2,"Bad Exit Rate"=2,"Refi Incentive"=2,"Prepaid Mortgage Rate"=3))
title         <- ggtitle("FHA Multifamily Exit Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1950-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, .5, .05),2),limits = c(0,.5))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

fhatrans_mult <- fhatrans_mult +g1+g2 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(fhatrans_mult) + yscale
```

### Entry Rate less Exit Rate into FHA insurance {-}

```{r fhatrans, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_fhatrans      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$fha_mf_entry_rate, color="Prepayment Rate",linetype="Prepayment Rate"))
g2 <- geom_line(aes(y=Data$fha_mf_nc_rate*100, color="Entry less Exit Rate into FHA insurance",linetype="Entry less Exit Rate into FHA insurance"))

color         <- scale_color_manual(" ", breaks=c("Entry less Exit Rate into FHA insurance","Prepayment Rate"), values=c( "Entry less Exit Rate into FHA insurance"="blue", "Prepayment Rate"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Entry less Exit Rate into FHA insurance","Prepayment Rate"), values=c("Entry less Exit Rate into FHA insurance"=1,"Prepayment Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Entry less Exit Rate into FHA insurance","Prepayment Rate"), values=c("Entry less Exit Rate into FHA insurance"=2,"Prepayment Rate"=2))
title         <- ggtitle("Entry Rate less Exit Rate into FHA insurance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1950-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,30, .5),1))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

Figure_fhatrans <- Figure_fhatrans + g2+color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(Figure_fhatrans) +yscale
```

## Corporations {-}

### Corporate Issuance-to-GDP {-}

```{r corpissplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

corpsstogdpplot      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$corpbond_iss/Data$ngdpm, color="Bond Issuance",linetype="Bond Issuance"))
g2 <- geom_line(aes(y=Data$corpstock_iss/Data$ngdpm, color="Equity Issuance",linetype="Equity Issuance"))

color         <- scale_color_manual(" ", breaks=c("Equity Issuance","Bond Issuance"), values=c( "Equity Issuance"="blue", "Bond Issuance"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Issuance","Bond Issuance"), values=c("Equity Issuance"=1,"Bond Issuance"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Issuance","Bond Issuance"), values=c("Equity Issuance"=2,"Bond Issuance"=2))
title         <- ggtitle("Corporate Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$corpbond_iss/Data$ngdpm,na.rm = TRUE), max(Data$corpbond_iss/Data$ngdpm,na.rm = TRUE), .025),3))

corpsstogdpplot <- corpsstogdpplot + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(corpsstogdpplot) +yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/corpsstogdpplot.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/corpsstogdpplot.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/corpsstogdpplot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "corpsstogdpplot.html"))


# gpoints <- geom_point(data = pchron_datA,aes(x=as.Date(tail(pchron_datA$Date,1)),y=pchron_datA$ten_d12 %>% tail(1)) , size=3,color="black",shape=21,fill="black")
# 
# gtext <- geom_text(y = round(pchron_datA$ten_d12 %>% tail(1),2),aes(x=as.Date(tail(pchron_datA$Date,1)),label = round(pchron_datA$ten_d12 %>% tail(1),2)),color="black",hjust=0,size=4,nudge_x = 50,nudge_y = -14)
```

### Corporate Issuance-to-GDP: 1990- {-}

```{r corpissrecentplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

corp_bond_gdp <- Data$corpbond_iss/Data$ngdpm
corp_eq_gdp <- Data$corpstock_iss/Data$ngdpm

tail_dates <- index(tail(na.omit(xts(Data$corpstock_iss/Data$ngdpm,order.by = as.Date(Data$Date))),1))

Figure_corpiss2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= corp_bond_gdp, color="Bond Issuance",linetype="Bond Issuance"))
g2 <- geom_line(aes(y=Data$corpstock_iss/Data$ngdpm, color="Equity Issuance",linetype="Equity Issuance"))

color         <- scale_color_manual(" ", breaks=c("Equity Issuance","Bond Issuance"), values=c( "Equity Issuance"="blue", "Bond Issuance"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Issuance","Bond Issuance"), values=c("Equity Issuance"=1,"Bond Issuance"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Issuance","Bond Issuance"), values=c("Equity Issuance"=2,"Bond Issuance"=2))
title         <- ggtitle("Corporate Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$corpbond_iss/Data$ngdpm,na.rm = TRUE), max(Data$corpbond_iss/Data$ngdpm,na.rm = TRUE), .025),3))

tail_dates <- index(tail(na.omit(xts(Data$corpstock_iss/Data$ngdpm,order.by = as.Date(Data$Date))),1))

tail_1 <- corp_bond_gdp %>% na.omit() %>% tail(1)

gpoints_1 <- geom_point(data = D,aes(x=tail_dates,y= round(corp_bond_gdp %>% na.omit() %>% tail(1),3)) , size=2,color="red",shape=21,fill="red")

gtext_1 <- geom_text(y =corp_bond_gdp %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(corp_bond_gdp %>% na.omit() %>% tail(1),3)),color="red",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_2 <- geom_point(data = D,aes(x=tail_dates,y= round(corp_eq_gdp %>% na.omit() %>% tail(1),3)) , size=2,color="blue",shape=21,fill="blue")

gtext_2 <- geom_text(y =corp_eq_gdp %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(corp_eq_gdp %>% na.omit() %>% tail(1),3)),color="blue",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

Figure_corpiss2 <- Figure_corpiss2 + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +gpoints_1 + gtext_1 + gpoints_2 + gtext_2

nberShade(Figure_corpiss2) +yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/corpsstogdpplotrecent.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/corpsstogdpplotrecent.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/corpsstogdpplotrecent.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "corpsstogdpplotrecent.html"))

```

### U.S. Corporate Equity Issuance-to-SP500 {-}

```{r corpisstostockprices, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

corpisstostockprices      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$corpbond_iss/Data$ngdpm, color="Bond Issuance",linetype="Bond Issuance"))
g2 <- geom_line(aes(y=corpstockeqprice_ma, color="Equity Issuance-to-SP500",linetype="Equity Issuance-to-SP500"))

color         <- scale_color_manual(" ", breaks=c("Equity Issuance-to-SP500","Bond Issuance"), values=c( "Equity Issuance-to-SP500"="blue", "Bond Issuance"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Issuance-to-SP500","Bond Issuance"), values=c("Equity Issuance-to-SP500"=1,"Bond Issuance"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Issuance-to-SP500","Bond Issuance"), values=c("Equity Issuance-to-SP500"=2,"Bond Issuance"=2))
corpisstostockprices_title         <- ggtitle("Corporate Equity Issuance-to-SP500 Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, US Corporate Equity Issuance deflated by SP500 price index, 9MMA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(corpstockiss_ma,na.rm = TRUE), max(corpstockiss_ma,na.rm = TRUE), 2),0))

corpisstostockprices <- corpisstostockprices + g2 + color +linetype +size + corpisstostockprices_title +text_options + Date_opts +leg_pos +sub_labs

nberShade(corpisstostockprices) +yscale

# gpoints <- geom_point(data = pchron_datA,aes(x=as.Date(tail(pchron_datA$Date,1)),y=pchron_datA$ten_d12 %>% tail(1)) , size=3,color="black",shape=21,fill="black")
# 
# gtext <- geom_text(y = round(pchron_datA$ten_d12 %>% tail(1),2),aes(x=as.Date(tail(pchron_datA$Date,1)),label = round(pchron_datA$ten_d12 %>% tail(1),2)),color="black",hjust=0,size=4,nudge_x = 50,nudge_y = -14)
# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(corpisstostockprices_title$title,"Download the data at","https://rb.gy/veqlb1",'#SPX',sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Domestic Non-financial Corporate Equity Issuance {-}

```{r corpeqissseoipo, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_NFCISS      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$nfc_ipo, color="IPO",linetype="IPO"))
g2 <- geom_line(aes(y=Data$nfc_seo, color="Seasoned Equity Offerings",linetype="Seasoned Equity Offerings"))

color         <- scale_color_manual(" ", breaks=c("Seasoned Equity Offerings","IPO"), values=c( "Seasoned Equity Offerings"="blue", "IPO"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Seasoned Equity Offerings","IPO"), values=c("Seasoned Equity Offerings"=1,"IPO"=1))
size          <- scale_size_manual(" ", breaks=c("Seasoned Equity Offerings","IPO"), values=c("Seasoned Equity Offerings"=2,"IPO"=2))
title         <- ggtitle("Domestic Nonfinancial Corporate Equity Issuance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1994-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="CMD-MD: Source: FRB Enhanced Financial Accounts")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 40, 2),0))

Figure_NFCISS <- Figure_NFCISS + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_NFCISS) +yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/corpeqissseoipo.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/corpeqissseoipo.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/corpeqissseoipo.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "corpeqissseoipo.html"))


```

### Net Equity Issuances-to-GDP {-}

```{r eq_iss_frb_net, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_eq_iss_frb_net      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$equity_iss_net/Data$ngdpm, color="Net Equity Issuances",linetype="Net Equity Issuances"))
g2 <- geom_line(aes(y=Data$equity_retirement_gross/Data$ngdpm, color="Gross Equity Retirement",linetype="Gross Equity Retirement"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Gross Equity Retirement","Net Equity Issuances"), values=c( "Gross Equity Retirement"="blue", "Net Equity Issuances"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Gross Equity Retirement","Net Equity Issuances"), values=c("Gross Equity Retirement"=1,"Net Equity Issuances"=1))
size          <- scale_size_manual(" ", breaks=c("Gross Equity Retirement","Net Equity Issuances"), values=c("Gross Equity Retirement"=2,"Net Equity Issuances"=2))
title         <- ggtitle("Net Equity Issuances-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1996-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, FRB EFA, fraction of nominal GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis())
figure_eq_iss_frb_net <- figure_eq_iss_frb_net + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(figure_eq_iss_frb_net) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/figure_eq_iss_frb_net.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/figure_eq_iss_frb_net.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/figure_eq_iss_frb_net.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "figure_eq_iss_frb_net.html"))

```

### Gross Equity Issuance-to-GDP {-}

```{r grossequityiss_frb, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_eq_iss_frbA      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$equity_iss_gross/Data$ngdpm, color="Gross Equity Issuance",linetype="Gross Equity Issuance"))
g2 <- geom_line(aes(y=Data$equity_retirement_gross/Data$ngdpm, color="Gross Equity Retirement",linetype="Gross Equity Retirement"))

color         <- scale_color_manual(" ", breaks=c("Gross Equity Retirement","Gross Equity Issuance"), values=c( "Gross Equity Retirement"="blue", "Gross Equity Issuance"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Gross Equity Retirement","Gross Equity Issuance"), values=c("Gross Equity Retirement"=1,"Gross Equity Issuance"=1))
size          <- scale_size_manual(" ", breaks=c("Gross Equity Retirement","Gross Equity Issuance"), values=c("Gross Equity Retirement"=2,"Gross Equity Issuance"=2))
title         <- ggtitle("Gross Equity Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1996-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, FRB EFA, fraction of nominal GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis())
figure_eq_iss_frbA <- figure_eq_iss_frbA + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_eq_iss_frbA) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/grossequityiss_frb.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/grossequityiss_frb.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/grossequityiss_frb.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "grossequityiss_frb.html"))

```

### Equity Retirement: Repurchases and Mergers and Acquisitions-to-GDP {-}

```{r eqretirementiss_frb, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_eq_iss_frbB      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$equity_retirement_repurchases/Data$ngdpm, color="Repurchases",linetype="Repurchases"))
g2 <- geom_line(aes(y=Data$equity_retirement_ma/Data$ngdpm, color="Mergers and Acquisitions",linetype="Mergers and Acquisitions"))

color         <- scale_color_manual(" ", breaks=c("Mergers and Acquisitions","Repurchases"), values=c( "Mergers and Acquisitions"="blue", "Repurchases"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mergers and Acquisitions","Repurchases"), values=c("Mergers and Acquisitions"=1,"Repurchases"=1))
size          <- scale_size_manual(" ", breaks=c("Mergers and Acquisitions","Repurchases"), values=c("Mergers and Acquisitions"=2,"Repurchases"=2))
title         <- ggtitle("Equity Retirement: Repurchases and Mergers and Acquisitions-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1996-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, FRB EFA, fraction of nominal GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis())
figure_eq_iss_frbB <- figure_eq_iss_frbB +g1+ g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_eq_iss_frbB) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/eqretirementiss_frb.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/eqretirementiss_frb.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eqretirementiss_frb.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "eqretirementiss_frb.html"))

```

### Corporate Bonds Outstanding-to-GDP {-}

```{r cbondsouttogdp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_CBPARISS      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$uscorpbonds_out/Data$ngdpm, color="Corporate Bonds Outstanding",linetype="Corporate Bonds Outstanding"))
g2 <- geom_line(aes(y=Data$CBPAR_seo, color="Seasoned Equity Offerings",linetype="Seasoned Equity Offerings"))

color         <- scale_color_manual(" ", breaks=c("Seasoned Equity Offerings","Corporate Bonds Outstanding"), values=c( "Seasoned Equity Offerings"="blue", "Corporate Bonds Outstanding"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Seasoned Equity Offerings","Corporate Bonds Outstanding"), values=c("Seasoned Equity Offerings"=1,"Corporate Bonds Outstanding"=1))
size          <- scale_size_manual(" ", breaks=c("Seasoned Equity Offerings","Corporate Bonds Outstanding"), values=c("Seasoned Equity Offerings"=2,"Corporate Bonds Outstanding"=2))
title         <- ggtitle("Corporate Bonds Outstanding-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 30, .5),1))

Figure_CBPARISS <- Figure_CBPARISS + g1  + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_CBPARISS) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/cbondsouttogdp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/cbondsouttogdp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/cbondsouttogdp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "cbondsouttogdp.html"))

```

### 12M ch in Equity Issuance-to-GDP and Stock Prices (Part 1) {-}

```{r eqisspriceplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_eqissprice      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$stockiss_d12, color="12M ch in Equity Issuance-to-GDP",linetype="12M ch in Equity Issuance-to-GDP"))
g2 <- geom_line(aes(y=Data$stockprice_d12*3, color="12M ch in Equity Prices",linetype="12M ch in Equity Prices"))

color         <- scale_color_manual(" ", breaks=c("12M ch in Equity Prices","12M ch in Equity Issuance-to-GDP"), values=c( "12M ch in Equity Prices"="blue", "12M ch in Equity Issuance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("12M ch in Equity Prices","12M ch in Equity Issuance-to-GDP"), values=c("12M ch in Equity Prices"=1,"12M ch in Equity Issuance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("12M ch in Equity Prices","12M ch in Equity Issuance-to-GDP"), values=c("12M ch in Equity Prices"=2,"12M ch in Equity Issuance-to-GDP"=2))
title         <- ggtitle("12M ch in Equity Issuance-to-GDP and Stock Prices (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-01-01"), as.Date("1949-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Equity Issuance-to-GDP is 3MMA, 12M change in Equity Prices times 3, Robert Shiller")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 4,.5),2),limits = c(-4,4))

Figure_eqissprice <- Figure_eqissprice + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(Figure_eqissprice)+yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/eqisspriceplot.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/eqisspriceplot.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eqisspriceplot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "eqisspriceplot.html"))


```

### 12M ch in Equity Issuance-to-GDP and Stock Prices (Part 2) {-}

```{r eqissprice2plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_eqissprice2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y= Data$stockiss_d12, color="12M ch in Equity Issuance-to-GDP",linetype="12M ch in Equity Issuance-to-GDP"))
g2 <- geom_line(aes(y=Data$stockprice_d12*2, color="12M ch in Equity Prices",linetype="12M ch in Equity Prices"))

color         <- scale_color_manual(" ", breaks=c("12M ch in Equity Prices","12M ch in Equity Issuance-to-GDP"), values=c( "12M ch in Equity Prices"="blue", "12M ch in Equity Issuance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("12M ch in Equity Prices","12M ch in Equity Issuance-to-GDP"), values=c("12M ch in Equity Prices"=1,"12M ch in Equity Issuance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("12M ch in Equity Prices","12M ch in Equity Issuance-to-GDP"), values=c("12M ch in Equity Prices"=2,"12M ch in Equity Issuance-to-GDP"=2))
title         <- ggtitle("12M ch in Equity Issuance-to-GDP and Stock Prices (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1949-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Equity Issuance-to-GDP is 3MMA, 12M change in Equity Prices times 2, Robert Shiller")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1.5, 2.5,.25),2),limits = c(-1.5,2.5))

Figure_eqissprice2 <- Figure_eqissprice2 + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(Figure_eqissprice2) +yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/eqissprice2plot.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/eqissprice2plot.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eqissprice2plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "eqissprice2plot.html"))

```

### Mergers and Acquisitions {-}

```{r mergersplotA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed7      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("number")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$mergeacquis, color="Mergers and Acquisitions",linetype="Mergers and Acquisitions"))

color         <- scale_color_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c( "Mergers and Acquisitions"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=2,"Auto Sales"=2))
title         <- ggtitle("Mergers and Acquisitions")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1895-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, IMAA & NBER, Monthly Average, Number")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$mergeacquis,na.rm = TRUE), max(Data$mergeacquis,na.rm = TRUE), 125),0))
figure_ed7 <- figure_ed7 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed7) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/mergersplotA.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mergersplotA.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mergersplotA.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mergersplotA.html"))

```

### Number of Mergers and Acquisitions Deflated by CPI {-}

```{r mergersplotcpi, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed8      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$mergeacquis/Data$pop, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$mergeacquis/Data$cpi, color="Mergers and Acquisitions",linetype="Mergers and Acquisitions"))

color         <- scale_color_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c( "Mergers and Acquisitions"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=2,"Auto Sales"=2))
title         <- ggtitle("Number of Mergers and Acquisitions Deflated by CPI")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, IMAA & NBER, Monthly Average, deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$mergeacquis/Data$wpi,na.rm = TRUE), max(Data$mergeacquis/Data$wpi,na.rm = TRUE), 1),0))
figure_ed8 <- figure_ed8 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed8) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/mergersplotcpi.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mergersplotcpi.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mergersplotcpi.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mergersplotcpi.html"))

```

### Value of Mergers and Acquisitions {-}

```{r mergersvalraw, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ma3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$mergeacquis_val/1000, color="Mergers and Acquisitions",linetype="Mergers and Acquisitions"))

color         <- scale_color_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c( "Mergers and Acquisitions"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=2,"Auto Sales"=2))
title         <- ggtitle("Value of Mergers and Acquisitions")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1988-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: IMAA; Note: Billions of USD")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,400,25),0))

figure_ma3 <- figure_ma3 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ma3) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/mergersvalraw.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mergersvalraw.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mergersvalraw.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mergersvalraw.html"))

```

### Value of Mergers and Acquisitions-to-GDP {-}

```{r mergersplottogdp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ma3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$mergeacquis_val/Data$ngdpm, color="Mergers and Acquisitions",linetype="Mergers and Acquisitions"))

color         <- scale_color_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c( "Mergers and Acquisitions"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Mergers and Acquisitions","Auto Sales"), values=c("Mergers and Acquisitions"=2,"Auto Sales"=2))
title         <- ggtitle("Value of Mergers and Acquisitions-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1988-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, IMAA, Monthly Average, fraction of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$mergeacquis_val/Data$ngdpm,na.rm = TRUE), max(Data$mergeacquis_val/Data$ngdpm,na.rm = TRUE),.02),2))

figure_ma3 <- figure_ma3 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ma3) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/mergersplottogdp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/mergersplottogdp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/mergersplottogdp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "mergersplottogdp.html"))

```

### SP500-to-Retail and Business Sales Ratios {-}

```{r spxtosales, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

spxtosales  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$sp_rsales*100, color="Stock Price-to-Retail Sales Ratio",linetype="Stock Price-to-Retail Sales Ratio"))
g2 <- geom_line(aes(y=Data$sp_bsales*100, color="Stock Price-to-Business Sales Ratio",linetype="Stock Price-to-Business Sales Ratio"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Retail Sales Ratio","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Stock Price-to-Business Sales Ratio"="blue", "Stock Price-to-Retail Sales Ratio"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Retail Sales Ratio","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=1,"Stock Price-to-Retail Sales Ratio"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Retail Sales Ratio","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=2,"Stock Price-to-Retail Sales Ratio"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("SP500-to-Retail and Business Sales Ratios")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Robert Shiller, NBER, FRED")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(.02, max(Data$sp_rsales*100,na.rm = TRUE), .05),2))

spxtosales <- spxtosales +g2+g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(spxtosales) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/spxtosales.pdf" ,height = 6.5,width = 11.5,units = "in")
# ggsave("C:/Users/sabol/Google Drive/blogposts/spxtosales.jpg" ,height = 6.5,width = 11.5,units = "in")
# 
# Status <- paste(title$title,"#data","#economics","#macro","#R","Download series at: https://py.pl/1rJf59",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/spxtosales.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "spxtosales.html"))

```

### SP500-to-Nominal GDP Ratio {-}

```{r spxtpngdp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

spxtpngdp  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$stock_price/Data$ngdpm*100, color="Stock Price-to-NGDP Ratio",linetype="Stock Price-to-NGDP Ratio"))
g2 <- geom_line(aes(y=Data$sp_bsales*100, color="Stock Price-to-Business Sales Ratio",linetype="Stock Price-to-Business Sales Ratio"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-NGDP Ratio","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Stock Price-to-Business Sales Ratio"="blue", "Stock Price-to-NGDP Ratio"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-NGDP Ratio","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=1,"Stock Price-to-NGDP Ratio"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-NGDP Ratio","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=2,"Stock Price-to-NGDP Ratio"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("SP500-to-Nominal GDP Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1850-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, Robert Shiller, NBER, FRED")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(.02, 1, .05),2),limits = c(0,.32))

spxtpngdp <- spxtpngdp + g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(spxtpngdp) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/spxtpngdp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/spxtpngdp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/spxtpngdp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "spxtpngdp.html"))

```

### Real S&P 500 {-}

```{r spxtowpi, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

spxtowpi  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$stock_price/Data$wpi)*100, color="Stock Price-to-Whole Sale Prices",linetype="Stock Price-to-Whole Sale Prices"))
g2 <- geom_line(aes(y=Data$sp_bsales*100, color="Stock Price-to-Business Sales Ratio",linetype="Stock Price-to-Business Sales Ratio"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Whole Sale Prices","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Stock Price-to-Business Sales Ratio"="blue", "Stock Price-to-Whole Sale Prices"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Whole Sale Prices","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=1,"Stock Price-to-Whole Sale Prices"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Whole Sale Prices","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=2,"Stock Price-to-Whole Sale Prices"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Real S&P 500")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1800-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, Robert Shiller, NBER, FRED; Notes: Deflated by wholesale prices, in logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-300, max(log(Data$stock_price/Data$wpi)*100,na.rm = TRUE), 25),1))

spxtowpi <- spxtowpi + g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(spxtowpi) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/spxtowpi.pdf" ,height = 6.5,width = 11.5,units = "in")
# ggsave("C:/Users/sabol/Google Drive/blogposts/spxtowpi.jpg" ,height = 6.5,width = 11.5,units = "in")
# 
# Status <- paste(title$title,"#data","#economics","#sp500","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/spxtowpi.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "spxtowpi.html"))

```

### Real NYSE Trading Volume {-}

```{r nysetowpi, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

nysetowpi  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$nyse_vol/Data$wpi)*100, color="Stock Price-to-Whole Sale Prices",linetype="Stock Price-to-Whole Sale Prices"))
g2 <- geom_line(aes(y=Data$sp_bsales*100, color="Stock Price-to-Business Sales Ratio",linetype="Stock Price-to-Business Sales Ratio"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Whole Sale Prices","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Stock Price-to-Business Sales Ratio"="blue", "Stock Price-to-Whole Sale Prices"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Whole Sale Prices","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=1,"Stock Price-to-Whole Sale Prices"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Stock Price-to-Business Sales Ratio","Stock Price-to-Whole Sale Prices","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Stock Price-to-Business Sales Ratio"=2,"Stock Price-to-Whole Sale Prices"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Real NYSE Trading Volume")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1890-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Sources: Capital Markets Data, Amit Goyal, and FRED; Notes: Deflated by wholesale prices, in logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(500, max(log(Data$nyse_vol/Data$wpi)*100,na.rm = TRUE), 50),1))

nysetowpi <- nysetowpi + g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(nysetowpi) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/nysetowpi.pdf" ,height = 6.5,width = 11.5,units = "in")
# ggsave("C:/Users/sabol/Google Drive/blogposts/nysetowpi.jpg" ,height = 6.5,width = 11.5,units = "in")
# 
# Status <- paste(title$title,"#data","#economics","#NYSE","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/nysetowpi.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "nysetowpi.html"))

```

### Real Equity Margin Debt {-}

```{r realmargindebt, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

realmargindebt  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$margin_debit_balance/Data$cpi)*100, color="Margin Debt-to-CPI",linetype="Margin Debt-to-CPI"))
g2 <- geom_line(aes(y=log(Data$margin_debit_balance/Data$ngdpm)*100, color="Margin Debt-to-Nominal GDP",linetype="Margin Debt-to-Nominal GDP"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Margin Debt-to-Nominal GDP","Margin Debt-to-CPI","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Margin Debt-to-Nominal GDP"="blue", "Margin Debt-to-CPI"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Margin Debt-to-Nominal GDP","Margin Debt-to-CPI","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Margin Debt-to-Nominal GDP"=1,"Margin Debt-to-CPI"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Margin Debt-to-Nominal GDP","Margin Debt-to-CPI","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Margin Debt-to-Nominal GDP"=2,"Margin Debt-to-CPI"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Real Equity Margin Debt")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Sources: Capital Markets Data, NYSE, and FINRA; Notes: Deflated by cpi, in logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(100, max(log(Data$margin_debit_balance/Data$cpi)*100,na.rm = TRUE), 50),1))

realmargindebt <- realmargindebt + g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(realmargindebt) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/realmargindebt.pdf" ,height = 6.5,width = 11.5,units = "in")
# ggsave("C:/Users/sabol/Google Drive/blogposts/realmargindebt.jpg" ,height = 6.5,width = 11.5,units = "in")
# 
# Status <- paste(title$title,"#data","#economics","#NYSE","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/realmargindebt.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "realmargindebt.html"))

```

### Equity Margin Debt-to-GDP {-}

```{r margintogdp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

margintogdp  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$margin_debit_balance/Data$cpi)*100, color="Margin Debt-to-CPI",linetype="Margin Debt-to-CPI"))
g2 <- geom_line(aes(y=(Data$margin_debit_balance/Data$ngdpm), color="Margin Debt-to-Nominal GDP",linetype="Margin Debt-to-Nominal GDP"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Margin Debt-to-Nominal GDP","Margin Debt-to-CPI","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Margin Debt-to-Nominal GDP"="blue", "Margin Debt-to-CPI"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Margin Debt-to-Nominal GDP","Margin Debt-to-CPI","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Margin Debt-to-Nominal GDP"=1,"Margin Debt-to-CPI"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Margin Debt-to-Nominal GDP","Margin Debt-to-CPI","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Margin Debt-to-Nominal GDP"=2,"Margin Debt-to-CPI"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
margintogdp_title         <- ggtitle("Equity Margin Debt-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Sources: Capital Markets Data, NYSE, and FINRA; Notes: Nominal GDP",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,max(Data$margin_debit_balance/Data$ngdpm,na.rm = TRUE), .1),1))

margintogdp <- margintogdp + g2+ color +linetype +size + margintogdp_title + text_options + Date_opts +leg_pos +sub_labs

nberShade(margintogdp) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/margintogdp.pdf" ,height = 6.5,width = 11.5,units = "in")
# ggsave("C:/Users/sabol/Google Drive/blogposts/margintogdp.jpg" ,height = 6.5,width = 11.5,units = "in")
# # 
# Status <- paste(margintogdp_title$title,"#Margin","#SPX","#NYSE","#FINRA",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/margintogdp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "margintogdp.html"))

```

### BAA-10Y Spread and Economic Policy Uncertainty {-}

```{r baaepu, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

baaepu  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$baa - Data$ten_yr_long, color="BAA-10Y Spread",linetype="BAA-10Y Spread"))
g2 <- geom_line(aes(y=Data$epu+2, color="Economic Policy Uncertainty",linetype="Economic Policy Uncertainty"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Economic Policy Uncertainty","BAA-10Y Spread","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Economic Policy Uncertainty"="blue", "BAA-10Y Spread"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Economic Policy Uncertainty","BAA-10Y Spread","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Economic Policy Uncertainty"=1,"BAA-10Y Spread"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Economic Policy Uncertainty","BAA-10Y Spread","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Economic Policy Uncertainty"=2,"BAA-10Y Spread"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("BAA-10Y Spread and Economic Policy Uncertainty")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Moody's, Baker, Scott, Nicholas Bloom and Steven Davis (2012)")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10, 1),1),limits = c(0,10))

baaepu <- baaepu +g1 + g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(baaepu) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/epubaatensp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/epubaatensp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/epubaatensp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "epubaatensp.html"))

```

### BAA-10Y Spread and BAML HY OAS {-}

```{r baatenspout, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

baatenspout  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$baa - Data$ten, color="BAA-10Y Spread",linetype="BAA-10Y Spread"))
g2 <- geom_line(aes(y=ustotaltogdp_ma*10, color="Economic Policy Uncertainty",linetype="Economic Policy Uncertainty"))
g3 <- geom_line(aes(y=Data$pd_npos_g1, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=Data$bamlhy + 2, color="BAML HY OAS",linetype="BAML HY OAS"))

color         <- scale_color_manual(" ", breaks=c("Economic Policy Uncertainty","BAA-10Y Spread","BAML HY OAS","Wage Growth"), values=c( "Economic Policy Uncertainty"="blue", "BAA-10Y Spread"="red","BAML HY OAS" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Economic Policy Uncertainty","BAA-10Y Spread","BAML HY OAS","Wage Growth"), values=c("Economic Policy Uncertainty"=1,"BAA-10Y Spread"=1,"BAML HY OAS"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Economic Policy Uncertainty","BAA-10Y Spread","BAML HY OAS","Wage Growth"), values=c("Economic Policy Uncertainty"=2,"BAA-10Y Spread"=2,"BAML HY OAS"=2,"Wage Growth"=3))
title         <- ggtitle("BAA-10Y Spread and BAML HY OAS")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1928-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: Moody's")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10, 1),1),limits = c(0,8))

baatenspout <- baatenspout +g1 +g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(baatenspout) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/baatensphy.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/baatensphy.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/baatensphy.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "baatensphy.html"))

```

### Excess Corporate Bond Premium {-}

```{r ebpplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ebpplot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$baa - Data$ten_yr_long, color="BAA-10Y Spread",linetype="BAA-10Y Spread"))
g2 <- geom_line(aes(y=Data$ebp, color="Excess Bond Premium",linetype="Excess Bond Premium"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Excess Bond Premium","BAA-10Y Spread","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Excess Bond Premium"="blue", "BAA-10Y Spread"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Excess Bond Premium","BAA-10Y Spread","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Excess Bond Premium"=1,"BAA-10Y Spread"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Excess Bond Premium","BAA-10Y Spread","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Excess Bond Premium"=2,"BAA-10Y Spread"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Excess Corporate Bond Premium")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1972-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: Gilchrist, Simon, and Egon Zakrajek. (2012)")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1,3.5, .5),1),limits = c(-1,3.5))

ebpplot <- ebpplot + g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ebpplot) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/ebp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/ebp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ebp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "ebp.html"))

```

### Commercial Paper Outstanding-to-GDP {-}

```{r cp_out_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

cp_out_plot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$cp_out/Data$ngdpm, color="CP Outstanding",linetype="CP Outstanding"))
g2 <- geom_line(aes(y=Data$ebp, color="Excess Bond Premium",linetype="Excess Bond Premium"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Excess Bond Premium","CP Outstanding","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Excess Bond Premium"="blue", "CP Outstanding"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Excess Bond Premium","CP Outstanding","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Excess Bond Premium"=1,"CP Outstanding"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Excess Bond Premium","CP Outstanding","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Excess Bond Premium"=2,"CP Outstanding"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Commercial Paper Outstanding-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: Federal Reserve")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,3, .1),2),limits = c(0,2))

cp_out_plot <- cp_out_plot + g1 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(cp_out_plot) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/ebp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/ebp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ebp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "ebp.html"))

```

## U.S. Equity Real Industry Price Indexes {-}

### Consumer Goods, Energy, and Manufacturing {-}

```{r indus_idx_plotsA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plotsA  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$nodur_idx/Data$cpi*100), color="Non-Durable Goods",linetype="Non-Durable Goods"))
g2 <- geom_line(aes(y=log(Data$durbl_idx/Data$cpi*100), color="Durable Goods",linetype="Durable Goods"))
g3 <- geom_line(aes(y=log(Data$manuf_idx/Data$cpi*100), color="Manufacturing",linetype="Manufacturing"))
g4 <- geom_line(aes(y=log(Data$enrgy_idx/Data$cpi*100), color="Energy",linetype="Energy"))

color         <- scale_color_manual(" ", breaks=c("Durable Goods","Non-Durable Goods","Energy","Manufacturing"), values=c( "Durable Goods"="blue", "Non-Durable Goods"="red","Energy" = "green","Manufacturing" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Durable Goods","Non-Durable Goods","Energy","Manufacturing"), values=c("Durable Goods"=1,"Non-Durable Goods"=1,"Energy"=1,"Manufacturing"=1))
size          <- scale_size_manual(" ", breaks=c("Durable Goods","Non-Durable Goods","Energy","Manufacturing"), values=c("Durable Goods"=2,"Non-Durable Goods"=2,"Energy"=2,"Manufacturing"=3))
title         <- ggtitle("Real Industry Stock Industries: Consumer Goods, Energy, and Manufacturing")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plotsA <- indus_idx_plotsA + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plotsA) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plotsA.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsA.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsA.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plotsA.html"))

```

### Energy Stock Prices-to-Fuel Prices {-}

```{r indus_idx_plotsA1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plotsA1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$nodur_idx/Data$cpi*100), color="Non-Durable Goods",linetype="Non-Durable Goods"))
g2 <- geom_line(aes(y=log(Data$durbl_idx/Data$cpi*100), color="Durable Goods",linetype="Durable Goods"))
g3 <- geom_line(aes(y=log(Data$manuf_idx/Data$cpi*100), color="Manufacturing",linetype="Manufacturing"))
g4 <- geom_line(aes(y=log(Data$enrgy_idx/Data$fuel*100), color="Energy",linetype="Energy"))

color         <- scale_color_manual(" ", breaks=c("Durable Goods","Non-Durable Goods","Energy","Manufacturing"), values=c( "Durable Goods"="blue", "Non-Durable Goods"="red","Energy" = "green","Manufacturing" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Durable Goods","Non-Durable Goods","Energy","Manufacturing"), values=c("Durable Goods"=1,"Non-Durable Goods"=1,"Energy"=1,"Manufacturing"=1))
size          <- scale_size_manual(" ", breaks=c("Durable Goods","Non-Durable Goods","Energy","Manufacturing"), values=c("Durable Goods"=2,"Non-Durable Goods"=2,"Energy"=2,"Manufacturing"=3))
title         <- ggtitle("Real Energy Stock Prices-to-Fuel Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by fuel price index",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plotsA1 <- indus_idx_plotsA1 + g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plotsA1) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plotsA1.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsA1.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsA1.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plotsA1.html"))

```

###  Hi-Tech, Telecom, Retail and Health {-}

```{r indus_idx_plotsB, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plotsB  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$hitec_idx/Data$cpi*100), color="Hi-Tech",linetype="Hi-Tech"))
g2 <- geom_line(aes(y=log(Data$telcm_idx/Data$cpi*100), color="Telecom",linetype="Telecom"))
g3 <- geom_line(aes(y=log(Data$shops_idx/Data$cpi*100), color="Shops",linetype="Shops"))
g4 <- geom_line(aes(y=log(Data$hlth_idx/Data$cpi*100), color="Health",linetype="Health"))

color         <- scale_color_manual(" ", breaks=c("Telecom","Hi-Tech","Health","Shops"), values=c( "Telecom"="blue", "Hi-Tech"="red","Health" = "green","Shops" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Telecom","Hi-Tech","Health","Shops"), values=c("Telecom"=1,"Hi-Tech"=1,"Health"=1,"Shops"=1))
size          <- scale_size_manual(" ", breaks=c("Telecom","Hi-Tech","Health","Shops"), values=c("Telecom"=2,"Hi-Tech"=2,"Health"=2,"Shops"=3))
title         <- ggtitle("Real Industry Stock Industries: Hi-Tech, Telecom, Retail and Health")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plotsB <- indus_idx_plotsB + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plotsB) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plotsB.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsB.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsB.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plotsB.html"))

```

### Retail Stock Prices-to-Retail Sales {-}

```{r indus_idx_plotsC, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plotsC  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$hitec_idx/Data$cpi*100), color="Hi-Tech",linetype="Hi-Tech"))
g2 <- geom_line(aes(y=log(Data$telcm_idx/Data$cpi*100), color="Telecom",linetype="Telecom"))
g3 <- geom_line(aes(y=log(Data$shops_idx/Data$rsales*1000000), color="Shops",linetype="Shops"))
g4 <- geom_line(aes(y=log(Data$hlth_idx/Data$cpi*100), color="Health",linetype="Health"))

color         <- scale_color_manual(" ", breaks=c("Telecom","Hi-Tech","Health","Shops"), values=c( "Telecom"="blue", "Hi-Tech"="red","Health" = "green","Shops" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Telecom","Hi-Tech","Health","Shops"), values=c("Telecom"=1,"Hi-Tech"=1,"Health"=1,"Shops"=1))
size          <- scale_size_manual(" ", breaks=c("Telecom","Hi-Tech","Health","Shops"), values=c("Telecom"=2,"Hi-Tech"=2,"Health"=2,"Shops"=3))
title         <- ggtitle("Retail Stock Prices-to-Retail Sales")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Source: Kenneth French; Notes: in logs, deflated by Retail Sales",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plotsC <- indus_idx_plotsC + g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plotsC) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plotsC.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsC.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plotsC.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plotsC.html"))

```

### Agriculture and Alcohol {-}

```{r indus_idx_plots, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$agriculture_idx/Data$cpi*100), color="Agriculture",linetype="Agriculture"))
g2 <- geom_line(aes(y=log(Data$food_products_idx/Data$cpi*100), color="Food Products",linetype="Food Products"))
g3 <- geom_line(aes(y=log(Data$candy_and_soda_idx/Data$cpi*100), color="Candy and Soda",linetype="Candy and Soda"))
g4 <- geom_line(aes(y=log(Data$beer_and_liquor_idx/Data$cpi*100), color="Beer and Liquor",linetype="Beer and Liquor"))

color         <- scale_color_manual(" ", breaks=c("Food Products","Agriculture","Beer and Liquor","Candy and Soda"), values=c( "Food Products"="blue", "Agriculture"="red","Beer and Liquor" = "green","Candy and Soda" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Food Products","Agriculture","Beer and Liquor","Candy and Soda"), values=c("Food Products"=1,"Agriculture"=1,"Beer and Liquor"=1,"Candy and Soda"=1))
size          <- scale_size_manual(" ", breaks=c("Food Products","Agriculture","Beer and Liquor","Candy and Soda"), values=c("Food Products"=2,"Agriculture"=2,"Beer and Liquor"=2,"Candy and Soda"=3))
title         <- ggtitle("Real Industry Stock Indexes: Agriculture and Alcohol")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100, .5),1))

indus_idx_plots <- indus_idx_plots + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots.html"))

```

### Tobacco, Recreation, Entertainment and Publishing {-}

```{r indus_idx_plots2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots2  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$tobacco_products_idx/Data$cpi*100), color="Tobacco Products",linetype="Tobacco Products"))
g2 <- geom_line(aes(y=log(Data$recreation_idx/Data$cpi*100), color="Recreation",linetype="Recreation"))
g3 <- geom_line(aes(y=log(Data$entertainment_idx/Data$cpi*100), color="Entertainment",linetype="Entertainment"))
g4 <- geom_line(aes(y=log(Data$printing_and_publishing_idx/Data$cpi*100), color="Printing and Publishing",linetype="Printing and Publishing"))

color         <- scale_color_manual(" ", breaks=c("Recreation","Tobacco Products","Printing and Publishing","Entertainment"), values=c( "Recreation"="blue", "Tobacco Products"="red","Printing and Publishing" = "green","Entertainment" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Recreation","Tobacco Products","Printing and Publishing","Entertainment"), values=c("Recreation"=1,"Tobacco Products"=1,"Printing and Publishing"=1,"Entertainment"=1))
size          <- scale_size_manual(" ", breaks=c("Recreation","Tobacco Products","Printing and Publishing","Entertainment"), values=c("Recreation"=2,"Tobacco Products"=2,"Printing and Publishing"=2,"Entertainment"=3))
title         <- ggtitle("Real Industry Stock Indexes: Part 2")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots2 <- indus_idx_plots2 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots2) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots2.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots2.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots2.html"))

```

### Consumer Goods and Apparel {-}

```{r indus_idx_plots3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots3  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$consumer_goods_idx/Data$cpi*100), color="Consumer Goods",linetype="Consumer Goods"))
g2 <- geom_line(aes(y=log(Data$apparel_idx/Data$cpi*100), color="Apparel",linetype="Apparel"))
g3 <- geom_line(aes(y=log(Data$candy_and_soda_idx/Data$cpi*100), color="Candy and Soda",linetype="Candy and Soda"))
g4 <- geom_line(aes(y=log(Data$beer_and_liquor_idx/Data$cpi*100), color="Beer and Liquor",linetype="Beer and Liquor"))

color         <- scale_color_manual(" ", breaks=c("Apparel","Consumer Goods","Beer and Liquor","Candy and Soda"), values=c( "Apparel"="blue", "Consumer Goods"="red","Beer and Liquor" = "black","Candy and Soda" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Apparel","Consumer Goods","Beer and Liquor","Candy and Soda"), values=c("Apparel"=1,"Consumer Goods"=1,"Beer and Liquor"=1,"Candy and Soda"=1))
size          <- scale_size_manual(" ", breaks=c("Apparel","Consumer Goods","Beer and Liquor","Candy and Soda"), values=c("Apparel"=2,"Consumer Goods"=2,"Beer and Liquor"=2,"Candy and Soda"=3))
title         <- ggtitle("Real Industry Stock Indexes: Consumer Goods and Apparel")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100, .5),1))

indus_idx_plots3 <- indus_idx_plots3 + g1 +g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plots3) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots3.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots3.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots3.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots3.html"))

```

### Medical {-}

```{r indus_idx_plots4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots4  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$healthcare_idx/Data$cpi*100), color="Health Care",linetype="Health Care"))
g2 <- geom_line(aes(y=log(Data$medical_equipment_idx/Data$cpi*100), color="Medical Equipment",linetype="Medical Equipment"))
g3 <- geom_line(aes(y=log(Data$pharmaceutical_products_idx/Data$cpi*100), color="Pharmaceutical Products",linetype="Pharmaceutical Products"))
g4 <- geom_line(aes(y=log(Data$beer_and_liquor_idx/Data$cpi*100), color="Beer and Liquor",linetype="Beer and Liquor"))

color         <- scale_color_manual(" ", breaks=c("Medical Equipment","Health Care","Beer and Liquor","Pharmaceutical Products"), values=c( "Medical Equipment"="blue", "Health Care"="red","Beer and Liquor" = "black","Pharmaceutical Products" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Medical Equipment","Health Care","Beer and Liquor","Pharmaceutical Products"), values=c("Medical Equipment"=1,"Health Care"=1,"Beer and Liquor"=1,"Pharmaceutical Products"=1))
size          <- scale_size_manual(" ", breaks=c("Medical Equipment","Health Care","Beer and Liquor","Pharmaceutical Products"), values=c("Medical Equipment"=2,"Health Care"=2,"Beer and Liquor"=2,"Pharmaceutical Products"=3))
title         <- ggtitle("Real Industry Stock Indexes: Medical")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-100,100, .5),1))

indus_idx_plots4 <- indus_idx_plots4 + g1 +g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots4) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots4.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots4.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots4.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots4.html"))

```

### Chemicals, Rubber and Plastics, Textiles, and Construction Materials{-}

```{r indus_idx_plots5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots5  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$chemicals_idx/Data$cpi*100), color="Chemicals",linetype="Chemicals"))
g2 <- geom_line(aes(y=log(Data$rubber_and_plastics_products_idx/Data$cpi*100), color="Rubber and Plastics",linetype="Rubber and Plastics"))
g3 <- geom_line(aes(y=log(Data$textile_products_idx/Data$cpi*100), color="Textile Products",linetype="Textile Products"))
g4 <- geom_line(aes(y=log(Data$construction_materials_idx/Data$cpi*100), color="Construction Materials",linetype="Construction Materials"))

color         <- scale_color_manual(" ", breaks=c("Rubber and Plastics","Chemicals","Construction Materials","Textile Products"), values=c( "Rubber and Plastics"="blue", "Chemicals"="red","Construction Materials" = "green","Textile Products" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Rubber and Plastics","Chemicals","Construction Materials","Textile Products"), values=c("Rubber and Plastics"=1,"Chemicals"=1,"Construction Materials"=1,"Textile Products"=1))
size          <- scale_size_manual(" ", breaks=c("Rubber and Plastics","Chemicals","Construction Materials","Textile Products"), values=c("Rubber and Plastics"=2,"Chemicals"=2,"Construction Materials"=2,"Textile Products"=3))
title         <- ggtitle("Real Industry Stock Indexes: Materials")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots5 <- indus_idx_plots5 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plots5) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots5.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots5.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots5.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots5.html"))

```

### Construction, Steel Works, Fabricated Products, and Machinery {-}

```{r indus_idx_plots6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots6  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$construction_idx/Data$cpi*100), color="Construction",linetype="Construction"))
g2 <- geom_line(aes(y=log(Data$steel_works_idx/Data$cpi*100), color="Steel Works",linetype="Steel Works"))
g3 <- geom_line(aes(y=log(Data$fabricated_products_idx/Data$cpi*100), color="Fabricated Products",linetype="Fabricated Products"))
g4 <- geom_line(aes(y=log(Data$machinery_idx/Data$cpi*100), color="Machinery",linetype="Machinery"))

color         <- scale_color_manual(" ", breaks=c("Steel Works","Construction","Machinery","Fabricated Products"), values=c( "Steel Works"="blue", "Construction"="red","Machinery" = "green","Fabricated Products" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Steel Works","Construction","Machinery","Fabricated Products"), values=c("Steel Works"=1,"Construction"=1,"Machinery"=1,"Fabricated Products"=1))
size          <- scale_size_manual(" ", breaks=c("Steel Works","Construction","Machinery","Fabricated Products"), values=c("Steel Works"=2,"Construction"=2,"Machinery"=2,"Fabricated Products"=3))
title         <- ggtitle("Real Industry Stock Indexes: Industrial Fabrication")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots6 <- indus_idx_plots6 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots6) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots6.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots6.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots6.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots6.html"))

```

### Autos, Aircraft, Shipbuilding and Railroad Equipment, and Defense {-}

```{r indus_idx_plots7, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots7  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$automobiles_and_trucks_idx/Data$cpi*100), color="Automobiles and Trucks",linetype="Automobiles and Trucks"))
g2 <- geom_line(aes(y=log(Data$aircraft_idx/Data$cpi*100), color="Aircraft",linetype="Aircraft"))
g3 <- geom_line(aes(y=log(Data$shipbuilding_and_railroad_equipment_idx/Data$cpi*100), color="Shipbuilding and Railroad Equipment",linetype="Shipbuilding and Railroad Equipment"))
g4 <- geom_line(aes(y=log(Data$defense_idx/Data$cpi*100), color="Defense",linetype="Defense"))

color         <- scale_color_manual(" ", breaks=c("Aircraft","Automobiles and Trucks","Defense","Shipbuilding and Railroad Equipment"), values=c( "Aircraft"="blue", "Automobiles and Trucks"="red","Defense" = "green","Shipbuilding and Railroad Equipment" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Aircraft","Automobiles and Trucks","Defense","Shipbuilding and Railroad Equipment"), values=c("Aircraft"=1,"Automobiles and Trucks"=1,"Defense"=1,"Shipbuilding and Railroad Equipment"=1))
size          <- scale_size_manual(" ", breaks=c("Aircraft","Automobiles and Trucks","Defense","Shipbuilding and Railroad Equipment"), values=c("Aircraft"=2,"Automobiles and Trucks"=2,"Defense"=2,"Shipbuilding and Railroad Equipment"=3))
title         <- ggtitle("Real Industry Stock Indexes: Transportation and Defense")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100, .5),1))

indus_idx_plots7 <- indus_idx_plots7 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plots7) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots7.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots7.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots7.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots7.html"))

```

### Metals and Energy {-}

```{r indus_idx_plots8, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots8  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$precious_metals_idx/Data$cpi*100), color="Precious Metals",linetype="Precious Metals"))
g2 <- geom_line(aes(y=log(Data$non.metallic_and_industrial_metal_mining_idx/Data$cpi*100), color="Non-Metallic and Industrial Metal Mining",linetype="Non-Metallic and Industrial Metal Mining"))
g3 <- geom_line(aes(y=log(Data$coal_idx/Data$cpi*100), color="Coal",linetype="Coal"))
g4 <- geom_line(aes(y=log(Data$petroleum_and_natural_gas_idx/Data$cpi*100), color="Petroleum and Natural Gas",linetype="Petroleum and Natural Gas"))

color         <- scale_color_manual(" ", breaks=c("Non-Metallic and Industrial Metal Mining","Precious Metals","Petroleum and Natural Gas","Coal"), values=c( "Non-Metallic and Industrial Metal Mining"="blue", "Precious Metals"="red","Petroleum and Natural Gas" = "green","Coal" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Metallic and Industrial Metal Mining","Precious Metals","Petroleum and Natural Gas","Coal"), values=c("Non-Metallic and Industrial Metal Mining"=1,"Precious Metals"=1,"Petroleum and Natural Gas"=1,"Coal"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Metallic and Industrial Metal Mining","Precious Metals","Petroleum and Natural Gas","Coal"), values=c("Non-Metallic and Industrial Metal Mining"=2,"Precious Metals"=2,"Petroleum and Natural Gas"=2,"Coal"=3))
title         <- ggtitle("Real Industry Stock Indexes: Metals and Energy")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100, .5),1))

indus_idx_plots8 <- indus_idx_plots8 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots8) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots8.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots8.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots8.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots8.html"))

```

### Utilities, Communication, Personal and Business Services {-}

```{r indus_idx_plots9, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots9  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$utilities_idx/Data$cpi*100), color="Utilities",linetype="Utilities"))
g2 <- geom_line(aes(y=log(Data$communication_idx/Data$cpi*100), color="Communication",linetype="Communication"))
g3 <- geom_line(aes(y=log(Data$personal_services_idx/Data$cpi*100), color="Personal Services",linetype="Personal Services"))
g4 <- geom_line(aes(y=log(Data$business_services_idx/Data$cpi*100), color="Business Services",linetype="Business Services"))

color         <- scale_color_manual(" ", breaks=c("Communication","Utilities","Business Services","Personal Services"), values=c( "Communication"="blue", "Utilities"="red","Business Services" = "green","Personal Services" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Communication","Utilities","Business Services","Personal Services"), values=c("Communication"=1,"Utilities"=1,"Business Services"=1,"Personal Services"=1))
size          <- scale_size_manual(" ", breaks=c("Communication","Utilities","Business Services","Personal Services"), values=c("Communication"=2,"Utilities"=2,"Business Services"=2,"Personal Services"=3))
title         <- ggtitle("Real Industry Stock Indexes: Utilities and Services")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100, .5),1))

indus_idx_plots9 <- indus_idx_plots9 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots9) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots9.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots9.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots9.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots9.html"))

```

### Computers, Software, Electronic Equipment, and Measuring and Control Equipment{-}

```{r indus_idx_plots10, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots10  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$computers_idx/Data$cpi*100), color="Computers",linetype="Computers"))
g2 <- geom_line(aes(y=log(Data$software_idx/Data$cpi*100), color="Software",linetype="Software"))
g3 <- geom_line(aes(y=log(Data$electronic_equipment_idx/Data$cpi*100), color="Electronic Equipment",linetype="Electronic Equipment"))
g4 <- geom_line(aes(y=log(Data$measuring_and_control_equipment_idx/Data$cpi*100), color="Measuring and Control Equipment",linetype="Measuring and Control Equipment"))

color         <- scale_color_manual(" ", breaks=c("Software","Computers","Measuring and Control Equipment","Electronic Equipment"), values=c( "Software"="blue", "Computers"="red","Measuring and Control Equipment" = "green","Electronic Equipment" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Software","Computers","Measuring and Control Equipment","Electronic Equipment"), values=c("Software"=1,"Computers"=1,"Measuring and Control Equipment"=1,"Electronic Equipment"=1))
size          <- scale_size_manual(" ", breaks=c("Software","Computers","Measuring and Control Equipment","Electronic Equipment"), values=c("Software"=2,"Computers"=2,"Measuring and Control Equipment"=2,"Electronic Equipment"=3))
title         <- ggtitle("Real Industry Stock Indexes: Technology")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots10 <- indus_idx_plots10 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots10) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots10.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots10.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots10.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots10.html"))

```

### Business supplies, Shipping Containers, and Transportation {-}

```{r indus_idx_plots11, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots11  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$business_supplies_idx/Data$cpi*100), color="Business Supplies",linetype="Business Supplies"))
g2 <- geom_line(aes(y=log(Data$shipping_containers_idx/Data$cpi*100), color="Shipping Containers",linetype="Shipping Containers"))
g3 <- geom_line(aes(y=log(Data$transportation_idx/Data$cpi*100), color="Transportation",linetype="Transportation"))
g4 <- geom_line(aes(y=log(Data$beer_and_liquor_idx/Data$cpi*100), color="Beer and Liquor",linetype="Beer and Liquor"))

color         <- scale_color_manual(" ", breaks=c("Shipping Containers","Business Supplies","Beer and Liquor","Transportation"), values=c( "Shipping Containers"="blue", "Business Supplies"="red","Beer and Liquor" = "green","Transportation" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Shipping Containers","Business Supplies","Beer and Liquor","Transportation"), values=c("Shipping Containers"=1,"Business Supplies"=1,"Beer and Liquor"=1,"Transportation"=1))
size          <- scale_size_manual(" ", breaks=c("Shipping Containers","Business Supplies","Beer and Liquor","Transportation"), values=c("Shipping Containers"=2,"Business Supplies"=2,"Beer and Liquor"=2,"Transportation"=3))
title         <- ggtitle("Real Industry Stock Indexes: Transportation and Shipping")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots11 <- indus_idx_plots11 + g1 +g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots11) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots11.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots11.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots11.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots11.html"))

```

### Wholesale, Retail, Hospitality and Other {-}

```{r indus_idx_plots12, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots12  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$wholesale_idx/Data$cpi*100), color="Wholesale",linetype="Wholesale"))
g2 <- geom_line(aes(y=log(Data$retail_idx/Data$cpi*100), color="Retail",linetype="Retail"))
g3 <- geom_line(aes(y=log(Data$hospitality_industry_idx/Data$cpi*100), color="Hospitality",linetype="Hospitality"))
g4 <- geom_line(aes(y=log(Data$other_idx/Data$cpi*100), color="Other",linetype="Other"))

color         <- scale_color_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c( "Retail"="blue", "Wholesale"="red","Other" = "green","Hospitality" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c("Retail"=1,"Wholesale"=1,"Other"=1,"Hospitality"=1))
size          <- scale_size_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c("Retail"=2,"Wholesale"=2,"Other"=2,"Hospitality"=3))
title         <- ggtitle("Real Industry Stock Indexes: Wholesale and Retail Business")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots12 <- indus_idx_plots12 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots12) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots12.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots12.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots12.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots12.html"))

```

### Wholesale and Retail Business Indexes-to-Sales {-}

```{r indus_idx_plots12a, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots12a  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$wholesale_idx/Data$bsales*1000), color="Wholesale",linetype="Wholesale"))
g2 <- geom_line(aes(y=log(Data$retail_idx/Data$rsales*1000), color="Retail",linetype="Retail"))
g3 <- geom_line(aes(y=log(Data$hospitality_industry_idx/Data$cpi*100), color="Hospitality",linetype="Hospitality"))
g4 <- geom_line(aes(y=log(Data$other_idx/Data$cpi*100), color="Other",linetype="Other"))

color         <- scale_color_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c( "Retail"="blue", "Wholesale"="red","Other" = "green","Hospitality" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c("Retail"=1,"Wholesale"=1,"Other"=1,"Hospitality"=1))
size          <- scale_size_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c("Retail"=2,"Wholesale"=2,"Other"=2,"Hospitality"=3))
title         <- ggtitle("Wholesale and Retail Business Indexes-to-Sales")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by retail and business sales",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots12a <- indus_idx_plots12a + g1 +g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots12a) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots12a.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots12a.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots12a.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots12a.html"))

```

### Wholesale Stock Prices-to-Wholesalers Sales {-}

```{r indus_idx_plots12b, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots12b  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$wholesale_idx/Data$wholesale_sales*100), color="Wholesale",linetype="Wholesale"))
g2 <- geom_line(aes(y=log(Data$retail_idx/Data$cpi*100), color="Retail",linetype="Retail"))
g3 <- geom_line(aes(y=log(Data$hospitality_industry_idx/Data$cpi*100), color="Hospitality",linetype="Hospitality"))
g4 <- geom_line(aes(y=log(Data$other_idx/Data$cpi*100), color="Other",linetype="Other"))

color         <- scale_color_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c( "Retail"="blue", "Wholesale"="red","Other" = "green","Hospitality" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c("Retail"=1,"Wholesale"=1,"Other"=1,"Hospitality"=1))
size          <- scale_size_manual(" ", breaks=c("Retail","Wholesale","Other","Hospitality"), values=c("Retail"=2,"Wholesale"=2,"Other"=2,"Hospitality"=3))
title         <- ggtitle("Wholesale Stock Prices-to-Wholesalers Sales")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1939-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots12b <- indus_idx_plots12b + g1 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(indus_idx_plots12b) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots12b.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots12b.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots12b.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots12b.html"))

```

### Banking, Insurance, Real Estate, and Trading {-}

```{r indus_idx_plots13, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

indus_idx_plots13  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$banking_idx/Data$cpi*100), color="Banking",linetype="Banking"))
g2 <- geom_line(aes(y=log(Data$insurance_idx/Data$cpi*100), color="Insurance",linetype="Insurance"))
g3 <- geom_line(aes(y=log(Data$real_estate_idx/Data$cpi*100), color="Real Estate",linetype="Real Estate"))
g4 <- geom_line(aes(y=log(Data$trading_idx/Data$cpi*100), color="Trading",linetype="Trading"))

color         <- scale_color_manual(" ", breaks=c("Insurance","Banking","Trading","Real Estate"), values=c( "Insurance"="blue", "Banking"="red","Trading" = "green","Real Estate" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Insurance","Banking","Trading","Real Estate"), values=c("Insurance"=1,"Banking"=1,"Trading"=1,"Real Estate"=1))
size          <- scale_size_manual(" ", breaks=c("Insurance","Banking","Trading","Real Estate"), values=c("Insurance"=2,"Banking"=2,"Trading"=2,"Real Estate"=3))
title         <- ggtitle("Real Industry Stock Indexes: Finance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Kenneth French; Notes: in logs, deflated by CPI",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,100, .5),1))

indus_idx_plots13 <- indus_idx_plots13 + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(indus_idx_plots13) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/indus_idx_plots13.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/indus_idx_plots13.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/indus_idx_plots13.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "indus_idx_plots13.html"))

```


## State and Local Government {-}

### State & Local Government Bond Issuance-to-GDP {-}

```{r muniissplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

muni_issplot      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=muninewcapitaltogdp_ma, color="New Capital Issuance-to-GDP",linetype="New Capital Issuance-to-GDP"))
g2 <- geom_line(aes(y=munirefitogdp_ma, color="Refunding Issuance-to-GDP",linetype="Refunding Issuance-to-GDP"))
g3 <- geom_line(aes(y=munitogdp, color="Muni Issuance-to-GDP",linetype="Muni Issuance-to-GDP"))
g4 <- geom_line(aes(y=corpbtogdp, color="Corporate Bond Issuance-to-GDP",linetype="Corporate Bond Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Refunding Issuance-to-GDP","New Capital Issuance-to-GDP","Corporate Bond Issuance-to-GDP","Muni Issuance-to-GDP"), values=c( "Refunding Issuance-to-GDP"="blue", "New Capital Issuance-to-GDP"="red","Corporate Bond Issuance-to-GDP" = "black","Muni Issuance-to-GDP" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Refunding Issuance-to-GDP","New Capital Issuance-to-GDP","Corporate Bond Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Refunding Issuance-to-GDP"=1,"New Capital Issuance-to-GDP"=1,"Corporate Bond Issuance-to-GDP"=1,"Muni Issuance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Refunding Issuance-to-GDP","New Capital Issuance-to-GDP","Corporate Bond Issuance-to-GDP","Muni Issuance-to-GDP"), values=c("Refunding Issuance-to-GDP"=2,"New Capital Issuance-to-GDP"=2,"Corporate Bond Issuance-to-GDP"=2,"Muni Issuance-to-GDP"=2))
title         <- ggtitle("State & Local Government Bond Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 3MMA; Source: FRB")

muni_issplot <- muni_issplot +g1+ g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(muni_issplot)

#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/ebp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/ebp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ebp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "ebp.html"))

```

### Refunding Bond Issuance-to-GDP and Change in Muni Yields {-}

```{r muniyieldplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

muni_yieldplot      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=muninewcapitaltogdp_ma, color="New Capital Issuance-to-GDP",linetype="New Capital Issuance-to-GDP"))
g2 <- geom_line(aes(y=munirefitogdp_ma, color="Refunding Issuance-to-GDP",linetype="Refunding Issuance-to-GDP"))
g3 <- geom_line(aes(y=-Data$muni_yield_d12/100, color="-1*12m Change 20 - Bond GO Index",linetype="-1*12m Change 20 - Bond GO Index"))
g4 <- geom_line(aes(y=corpbtogdp, color="Corporate Bond Issuance-to-GDP",linetype="Corporate Bond Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Refunding Issuance-to-GDP","New Capital Issuance-to-GDP","Corporate Bond Issuance-to-GDP","-1*12m Change 20 - Bond GO Index"), values=c( "Refunding Issuance-to-GDP"="blue", "New Capital Issuance-to-GDP"="red","Corporate Bond Issuance-to-GDP" = "black","-1*12m Change 20 - Bond GO Index" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Refunding Issuance-to-GDP","New Capital Issuance-to-GDP","Corporate Bond Issuance-to-GDP","-1*12m Change 20 - Bond GO Index"), values=c("Refunding Issuance-to-GDP"=1,"New Capital Issuance-to-GDP"=1,"Corporate Bond Issuance-to-GDP"=1,"-1*12m Change 20 - Bond GO Index"=1))
size          <- scale_size_manual(" ", breaks=c("Refunding Issuance-to-GDP","New Capital Issuance-to-GDP","Corporate Bond Issuance-to-GDP","-1*12m Change 20 - Bond GO Index"), values=c("Refunding Issuance-to-GDP"=2,"New Capital Issuance-to-GDP"=2,"Corporate Bond Issuance-to-GDP"=2,"-1*12m Change 20 - Bond GO Index"=2))
title         <- ggtitle("State & Local Government Refunding Bond Issuance-to-GDP and Change in Muni Yields")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: -diff(20 - Bond GO Index,12)/100 and 3MMA in Refunding Issuance; Source: FRB, Bond Buyer")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-.04,.04, .01),2),limits = c(-.04,.04))

muni_yieldplot <- muni_yieldplot + g2 +g3+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(muni_yieldplot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/munirefundingandyieldd12.jpg" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/ebp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/ebp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ebp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "ebp.html"))

```

### Muni Issuance-to-GDP: GO and Revenue Bonds {-}

```{r munidetailA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

munidetailAfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=stateandlocal_go_ma, color="General Obligation",linetype="General Obligation"))
g2 <- geom_line(aes(y=stateandlocal_revenue_ma, color="Revenue",linetype="Revenue"))
g3 <- geom_line(aes(y=Data$usbillsandcertif_out/Data$ngdpm, color="Bills and Certificates",linetype="Bills and Certificates"))
g4 <- geom_line(aes(y=Data$usttotala_to_gdp, color="Gross",linetype="Gross"))

color         <- scale_color_manual(" ", breaks=c("Revenue","General Obligation","Gross","Bills and Certificates"), values=c( "Revenue"="blue", "General Obligation"="red","Gross" = "black","Bills and Certificates" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Revenue","General Obligation","Gross","Bills and Certificates"), values=c("Revenue"=1,"General Obligation"=1,"Gross"=1,"Bills and Certificates"=2))
size          <- scale_size_manual(" ", breaks=c("Revenue","General Obligation","Gross","Bills and Certificates"), values=c("Revenue"=2,"General Obligation"=2,"Gross"=2,"Bills and Certificates"=3))
title         <- ggtitle("Muni Issuance-to-GDP: GO and Revenue Bonds")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1958-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 6MMA; Source: FRB")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1, .005),3))

munidetailAfig <- munidetailAfig +g1+ g2 + color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts
nberShade(munidetailAfig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/ebp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/ebp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ebp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "ebp.html"))

```

### Muni Sector Issuance-to-GDP {-}

```{r munidetailB, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

munidetailBfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=stateandlocal_education_ma, color="Education",linetype="Education"))
g2 <- geom_line(aes(y=stateandlocal_industrial_aid_ma, color="Industrial Aid",linetype="Industrial Aid"))
g3 <- geom_line(aes(y=stateandlocal_transport_ma, color="Transportation",linetype="Transportation"))
g4 <- geom_line(aes(y=stateandlocal_utilities_ma, color="Utilities",linetype="Utilities"))

color         <- scale_color_manual(" ", breaks=c("Industrial Aid","Education","Utilities","Transportation"), values=c( "Industrial Aid"="blue", "Education"="red","Utilities" = "black","Transportation" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Industrial Aid","Education","Utilities","Transportation"), values=c("Industrial Aid"=1,"Education"=1,"Utilities"=1,"Transportation"=2))
size          <- scale_size_manual(" ", breaks=c("Industrial Aid","Education","Utilities","Transportation"), values=c("Industrial Aid"=2,"Education"=2,"Utilities"=2,"Transportation"=3))
title         <- ggtitle("Muni Sector Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1947-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 6MMA; Source: FRB")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1, .001),3))

munidetailBfig <- munidetailBfig +g1+ g2 + g3 +g4+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts

nberShade(munidetailBfig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/ebp.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/ebp.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ebp.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "ebp.html"))

```

## Primary Dealer Net Positions {-}

### Primary Dealer Net Positions in Treasury Securities {-}

```{r pdnpos1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnpos1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=total_npos_to_parpriv/1000, color="Treasury Net Positions",linetype="Treasury Net Positions"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Treasury Net Positions"), values=c( "Private"="blue", "Treasury Net Positions"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Treasury Net Positions"), values=c("Private"=1,"Treasury Net Positions"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Treasury Net Positions"), values=c("Private"=2,"Treasury Net Positions"=2))
title         <- ggtitle("Primary Dealer Net Positions in Treasury Securities")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1956-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Par Privately Held Treasuries Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(total_npos_to_parpriv,na.rm = TRUE), max(total_npos_to_parpriv,na.rm = TRUE), .01),2))
pdnpos1_fig <- pdnpos1_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdnpos1_fig) + yscale

# ggsave("temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- title$title
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")
```

### Net Positions in Treasury Securities with less than one-year to maturity {-}

```{r pdnpos2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnpos2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=pd_npos_l1toout, color="Less than 1yr",linetype="Less than 1yr"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Less than 1yr"), values=c( "Private"="blue", "Less than 1yr"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Less than 1yr"), values=c("Private"=1,"Less than 1yr"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Less than 1yr"), values=c("Private"=2,"Less than 1yr"=2))
title         <- ggtitle("Primary Dealer Net Positions in Treasury Securities with less than one-year to maturity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1956-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Bills and Certificates Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(pd_npos_l1toout,na.rm = TRUE), max(pd_npos_l1toout,na.rm = TRUE), .01),2))
pdnpos2_fig <- pdnpos2_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdnpos2_fig) + yscale

```

### Net Positions in Treasury Securities with greater than one-year till maturity {-}

```{r pdnpos3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnpos3_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=pd_npos_g1toout, color="Greater than 1yr",linetype="Greater than 1yr"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Greater than 1yr"), values=c( "Private"="blue", "Greater than 1yr"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Greater than 1yr"), values=c("Private"=1,"Greater than 1yr"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Greater than 1yr"), values=c("Private"=2,"Greater than 1yr"=2))
title         <- ggtitle("Primary Dealer Net Positions in Treasury Securities with greater than one-year till maturity")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1956-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasury Notes and Bonds Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(pd_npos_g1toout,na.rm = TRUE), max(pd_npos_g1toout,na.rm = TRUE), .01),2))
pdnpos3_fig <- pdnpos3_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdnpos3_fig) + yscale

# ggsave("temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Net Duration of Treasury Positions {-}

```{r pdnpos4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnpos4_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=netdur_npos, color="Net Duration",linetype="Net Duration"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Net Duration"), values=c( "Private"="blue", "Net Duration"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Net Duration"), values=c("Private"=1,"Net Duration"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Net Duration"), values=c("Private"=2,"Net Duration"=2))
title         <- ggtitle("Primary Dealer Net Duration of Treasury Positions")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1956-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: in years")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(netdur_npos,na.rm = TRUE), max(netdur_npos,na.rm = TRUE), 2),0))
pdnpos4_fig <- pdnpos4_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdnpos4_fig) + yscale

```

### Net Positions in Treasury Securities > 7-yr {-}

```{r pdnpos5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnpos5_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$pd_npos_g7/Data$usbonds_out, color=" > 7-yr",linetype=" > 7-yr"))
g2 <- geom_line(aes(y=Data$pd_npos_g7/Data$usnotesandbonds_out, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private"," > 7-yr"), values=c( "Private"="blue", " > 7-yr"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private"," > 7-yr"), values=c("Private"=1," > 7-yr"=1))
size          <- scale_size_manual(" ", breaks=c("Private"," > 7-yr"), values=c("Private"=2," > 7-yr"=2))
title         <- ggtitle("Primary Dealer Net Positions in Treasury Securities > 7-yr")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1956-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Bonds Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$pd_npos_g7/Data$usbonds_out,na.rm = TRUE), max(Data$pd_npos_g7/Data$usbonds_out,na.rm = TRUE), .01),2))
pdnpos5_fig <- pdnpos5_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdnpos5_fig) + yscale

```

### Net Positions in Federal Agency Debt {-}

```{r pdnpos6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnpos6_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$pd_npos_gse_and_mbs/fa_out, color="Federal Agency Debt and MBS",linetype="Federal Agency Debt and MBS"))
g2 <- geom_line(aes(y=Data$pd_npos_gse/fa_out, color="Federal Agency Debt",linetype="Federal Agency Debt"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Federal Agency Debt","Federal Agency Debt and MBS"), values=c( "Federal Agency Debt"="blue", "Federal Agency Debt and MBS"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Federal Agency Debt","Federal Agency Debt and MBS"), values=c("Federal Agency Debt"=1,"Federal Agency Debt and MBS"=1))
size          <- scale_size_manual(" ", breaks=c("Federal Agency Debt","Federal Agency Debt and MBS"), values=c("Federal Agency Debt"=2,"Federal Agency Debt and MBS"=2))
title         <- ggtitle("Primary Dealer Net Positions in Federal Agency Debt")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1989-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Federal Agency Debt Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$pd_npos_gse/fa_out,na.rm = TRUE), max(Data$pd_npos_gse/fa_out,na.rm = TRUE), .01),2))
pdnpos6_fig <- pdnpos6_fig + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(pdnpos6_fig) + yscale

```

### Primary Dealer Net Treasury Positions and The BAA-10yr Spread {-}

```{r pdnposbaa, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdnposbaa_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$total_npos_to_gdp, color="Total Treasury Net Positions-to-GDP",linetype="Total Treasury Net Positions-to-GDP"))
g2 <- geom_line(aes(y=(Data$baa - Data$ten)*4-4, color="BAA-10yr Spread",linetype="BAA-10yr Spread"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("BAA-10yr Spread","Total Treasury Net Positions-to-GDP"), values=c( "BAA-10yr Spread"="blue", "Total Treasury Net Positions-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("BAA-10yr Spread","Total Treasury Net Positions-to-GDP"), values=c("BAA-10yr Spread"=1,"Total Treasury Net Positions-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("BAA-10yr Spread","Total Treasury Net Positions-to-GDP"), values=c("BAA-10yr Spread"=2,"Total Treasury Net Positions-to-GDP"=2))
title         <- ggtitle("Primary Dealer Net Treasury Positions and The BAA-10yr Spread")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1963-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, BAA-10Y is multiplied by 4 - 4")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$total_npos_to_gdp,na.rm = TRUE), max((Data$baa - Data$ten)*4-4,na.rm = TRUE), 2),2),limits = c(-13,20))
pdnposbaa_fig <- pdnposbaa_fig + g2 +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs+hline

nberShade(pdnposbaa_fig) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/pdnposbaa.jpg" ,height = 6.5,width = 11.5,units = "in")


```

## Net Repo {-}

### Net Repo {-}

```{r pdrepo1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdrepo1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$net_repo/Data$usttotala_out, color="Net Repo",linetype="Net Repo"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Net Repo"), values=c( "Private"="blue", "Net Repo"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Net Repo"), values=c("Private"=1,"Net Repo"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Net Repo"), values=c("Private"=2,"Net Repo"=2))
title         <- ggtitle("Primary Dealer Net Repo")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1963-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasuries Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$net_repo/Data$usttotala_out,na.rm = TRUE), max(Data$net_repo/Data$usttotala_out,na.rm = TRUE), .05),2))
pdrepo1_fig <- pdrepo1_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdrepo1_fig) + yscale

```

### Net O/N Repo {-}

```{r pdrepo2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdrepo2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$net_repo_on/Data$usttotala_out, color="O/N",linetype="O/N"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","O/N"), values=c( "Private"="blue", "O/N"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","O/N"), values=c("Private"=1,"O/N"=1))
size          <- scale_size_manual(" ", breaks=c("Private","O/N"), values=c("Private"=2,"O/N"=2))
title         <- ggtitle("Primary Dealer Net O/N Repo")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1979-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasuries Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$net_repo_on/Data$usttotala_out,na.rm = TRUE), max(Data$net_repo_on/Data$usttotala_out,na.rm = TRUE), .05),2))
pdrepo2_fig <- pdrepo2_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdrepo2_fig) + yscale

```

### Net Term Repo {-}

```{r pdrepo3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

pdrepo3_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$net_repo_term/Data$usttotala_out, color="Term",linetype="Term"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Term"), values=c( "Private"="blue", "Term"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Term"), values=c("Private"=1,"Term"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Term"), values=c("Private"=2,"Term"=2))
title         <- ggtitle("Primary Dealer Net Term Repo")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1979-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasuries Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$net_repo_term/Data$usttotala_out,na.rm = TRUE), max(Data$net_repo_term/Data$usttotala_out,na.rm = TRUE), .01),2))
pdrepo3_fig <- pdrepo3_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(pdrepo3_fig) + yscale

```

## Transactions {-}

### Primary Dealer Transactions {-}

```{r trans1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

trans1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$pdtrantotal/Data$usttotala_out, color="Transactions in Treasuries",linetype="Transactions in Treasuries"))
g2 <- geom_line(aes(y=Data$pdtranagencyandmbs/fa_out, color="Transactions in Federal Agency Debt and MBS",linetype="Transactions in Federal Agency Debt and MBS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Transactions in Federal Agency Debt and MBS","Transactions in Treasuries"), values=c( "Transactions in Federal Agency Debt and MBS"="blue", "Transactions in Treasuries"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Transactions in Federal Agency Debt and MBS","Transactions in Treasuries"), values=c("Transactions in Federal Agency Debt and MBS"=1,"Transactions in Treasuries"=1))
size          <- scale_size_manual(" ", breaks=c("Transactions in Federal Agency Debt and MBS","Transactions in Treasuries"), values=c("Transactions in Federal Agency Debt and MBS"=2,"Transactions in Treasuries"=2))
title         <- ggtitle("Primary Dealer Transactions")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1961-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$pdtranagencyandmbs/fa_out,na.rm = TRUE), max(Data$pdtranagencyandmbs/fa_out,na.rm = TRUE), .05),2))
trans1_fig <- trans1_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(trans1_fig) + yscale

```

### Agency Debt and MBS Transactions {-}

```{r trans3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

trans3_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$pdtran_agencydebt/Data$ngdpm, color="Agency Debt",linetype="Agency Debt"))
g2 <- geom_line(aes(y=Data$pdtran_agencymbs/Data$ngdpm, color="Agency MBS",linetype="Agency MBS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Agency MBS","Agency Debt"), values=c( "Agency MBS"="blue", "Agency Debt"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Agency MBS","Agency Debt"), values=c("Agency MBS"=1,"Agency Debt"=1))
size          <- scale_size_manual(" ", breaks=c("Agency MBS","Agency Debt"), values=c("Agency MBS"=2,"Agency Debt"=2))
title         <- ggtitle("Primary Dealer Agency Debt and MBS Transactions")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1989-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank())
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of GDP")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,2, .05),2))
trans3_fig <- trans3_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(trans3_fig) + yscale

```

### Treasury Transactions {-}

```{r trans2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

trans2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$pdtranl1/Data$ngdpm, color="< 1",linetype="< 1"))
g2 <- geom_line(aes(y=Data$pdtranl5/Data$ngdpm, color="1 < Trans < 5",linetype="1 < Trans < 5"))
g3 <- geom_line(aes(y=Data$pdtran5to10/Data$ngdpm, color="5 < Trans < 10",linetype="5 < Trans < 10"))
g4 <- geom_line(aes(y=Data$pdtran10plus/Data$ngdpm, color="> 10",linetype="> 10"))
g5 <- geom_line(aes(y=Data$pdtrang5/Data$ngdpm, color="> 5 yr",linetype="> 5 yr"))

color         <- scale_color_manual(" ", breaks=c("1 < Trans < 5","< 1","> 10","5 < Trans < 10","> 5 yr"), values=c( "1 < Trans < 5"="blue", "< 1"="red","> 10" = "black","5 < Trans < 10" ="purple","> 5 yr" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("1 < Trans < 5","< 1","> 10","5 < Trans < 10","> 5 yr"), values=c("1 < Trans < 5"=1,"< 1"=1,"> 10"=1,"5 < Trans < 10"=2,"> 5 yr"=1))
size          <- scale_size_manual(" ", breaks=c("1 < Trans < 5","< 1","> 10","5 < Trans < 10","> 5 yr"), values=c("1 < Trans < 5"=2,"< 1"=2,"> 10"=2,"5 < Trans < 10"=3,"> 5 yr"=3))
title         <- ggtitle("Primary Dealer Treasury Transactions")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1961-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: NY Fed, Notes: Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1,.05),2))
vline <- geom_vline(xintercept = as.Date("1961-01-01"),show.legend = TRUE)
trans2 <- trans2 +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(trans2) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/trans2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs","#economics","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/trans2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("trans2.jpg")
```

## Fed Holdings of Treasuries {-}

### Holdings of Treasuries {-}

```{r fedholds1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fedholds1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$fedhold/Data$usttotala_out, color="Fed Holdings of Treasuries",linetype="Fed Holdings of Treasuries"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Fed Holdings of Treasuries"), values=c( "Private"="blue", "Fed Holdings of Treasuries"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Fed Holdings of Treasuries"), values=c("Private"=1,"Fed Holdings of Treasuries"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Fed Holdings of Treasuries"), values=c("Private"=2,"Fed Holdings of Treasuries"=2))
title         <- ggtitle("Federal Reserve Holdings of Treasuries")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasuries Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$fedhold/Data$usttotala_out,na.rm = TRUE), max(Data$fedhold/Data$usttotala_out,na.rm = TRUE), .05),2))
fedholds1_fig <- fedholds1_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs +yscale

nberShade(fedholds1_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/fedtsybalancesheet.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Holdings as a fraction outstanding {-}

```{r fedholds2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fedholds2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$fedhold_certifandbills/Data$usbillsandcertif_out, color="Holdings of Bills and Certificates as a fraction of Outstanding",linetype="Holdings of Bills and Certificates as a fraction of Outstanding"))
g2 <- geom_line(aes(y=Data$fedhold_notesandbonds/Data$usnotesandbonds_out, color="Holdings of Notes and Bonds as a fraction of Outstanding",linetype="Holdings of Notes and Bonds as a fraction of Outstanding"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Holdings of Notes and Bonds as a fraction of Outstanding","Holdings of Bills and Certificates as a fraction of Outstanding"), values=c( "Holdings of Notes and Bonds as a fraction of Outstanding"="blue", "Holdings of Bills and Certificates as a fraction of Outstanding"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Holdings of Notes and Bonds as a fraction of Outstanding","Holdings of Bills and Certificates as a fraction of Outstanding"), values=c("Holdings of Notes and Bonds as a fraction of Outstanding"=1,"Holdings of Bills and Certificates as a fraction of Outstanding"=1))
size          <- scale_size_manual(" ", breaks=c("Holdings of Notes and Bonds as a fraction of Outstanding","Holdings of Bills and Certificates as a fraction of Outstanding"), values=c("Holdings of Notes and Bonds as a fraction of Outstanding"=2,"Holdings of Bills and Certificates as a fraction of Outstanding"=2))
title         <- ggtitle("Federal Reserve Holdings of Treasuries")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$fedhold_certifandbills/Data$usbillsandcertif_out,na.rm = TRUE), max(Data$fedhold_certifandbills/Data$usbillsandcertif_out,na.rm = TRUE), .1),2))
fedholds2_fig <- fedholds2_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fedholds2_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/fedholds_tsypt2.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### Holding of Treasuries greater than 10-yrs {-}

```{r fedholds4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fedholds4_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$fedgreater10y/Data$usbonds_out, color=">10yr",linetype=">10yr"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private",">10yr"), values=c( "Private"="blue", ">10yr"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private",">10yr"), values=c("Private"=1,">10yr"=1))
size          <- scale_size_manual(" ", breaks=c("Private",">10yr"), values=c("Private"=2,">10yr"=2))
title         <- ggtitle("Fed Holding of Treasuries greater than 10-yrs")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1939-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasury Bonds Outstanding")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$fedgreater10y/Data$usbonds_out,na.rm = TRUE), max(Data$fedgreater10y/Data$usbonds_out,na.rm = TRUE), .05),2))
fedholds4_fig <- fedholds4_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(fedholds4_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/fedholdgreatertenyr.jpg" ,height = 6.5,width = 11.5,units = "in")
```

### Net Duration of The Federal Reserves Treasury Holdings {-}

```{r fedholds3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fedholds3_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$fed_net_tsy_dur, color="Net Duration",linetype="Net Duration"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Net Duration"), values=c( "Private"="blue", "Net Duration"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Net Duration"), values=c("Private"=1,"Net Duration"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Net Duration"), values=c("Private"=2,"Net Duration"=2))
title         <- ggtitle("Net Duration of The Federal Reserves Treasury Holdings")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1939-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: in years")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$fed_net_tsy_dur,na.rm = TRUE), max(Data$fed_net_tsy_dur,na.rm = TRUE), 1),0))
fedholds3_fig <- fedholds3_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs +yscale

nberShade(fedholds3_fig) + yscale

```

### Maturity of Federal Reserve Treasury Holdings-to-GDP {-}

```{r fedholds5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fedholds5_fig  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fedl15d/Data$ngdpm, color="< 15 days",linetype="< 15 days"))
g2 <- geom_line(aes(y=Data$fedl15to90d/Data$ngdpm, color="15-to-90 days",linetype="15-to-90 days"))
g4 <- geom_line(aes(y=Data$fedl90to1y/Data$ngdpm, color="91 days-to-1 year",linetype="91 days-to-1 year"))
g5 <- geom_line(aes(y=Data$fedl1to5y/Data$ngdpm, color="1-to-5 years",linetype="1-to-5 years"))
g3 <- geom_line(aes(y=Data$fedl5to10y/Data$ngdpm, color="5-to-10 years",linetype="5-to-10 years"))
g6 <- geom_line(aes(y=Data$fedgreater10y/Data$ngdpm, color="> 10 years",linetype="> 10 years"))
g7 <- geom_line(aes(y=Data$fiveotrsp, color="5Y Treasuries",linetype="5Y Treasuries"))


color         <- scale_color_manual(" ", breaks=c("< 15 days","15-to-90 days","5-to-10 years","91 days-to-1 year","1-to-5 years","> 10 years","5Y Treasuries"), values=c( "15-to-90 days"="blue", "< 15 days"="dark green","1-to-5 years" = "black","91 days-to-1 year" ="green","5-to-10 years"="red","> 10 years" = "purple","5Y Treasuries" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("< 15 days","15-to-90 days","5-to-10 years","91 days-to-1 year","1-to-5 years","> 10 years","5Y Treasuries"), values=c("15-to-90 days"=1,"< 15 days"=1,"1-to-5 years"=1,"91 days-to-1 year"=1,"5-to-10 years"=1,"> 10 years"=1,"5Y Treasuries"=1))
size          <- scale_size_manual(" ", breaks=c("< 15 days","15-to-90 days","5-to-10 years","91 days-to-1 year","1-to-5 years","> 10 years","5Y Treasuries"), values=c("15-to-90 days"=2,"< 15 days"=2,"1-to-5 years"=2,"91 days-to-1 year"=3,"5-to-10 years"=2,"> 10 years"=2,"5Y Treasuries"=3))
title         <- ggtitle("Maturity of Federal Reserve Treasury Holdings-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.90), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1, .1),1),limits = c(0,1))

fedholds5_fig <- fedholds5_fig +g1+g2+g3+g4+g5+g6+ color +linetype +size + title + text_options + Date_opts +hline+leg_pos +sub_labs

nberShade(fedholds5_fig) + yscale
```

## Bank Assets {-}

### Bank Holdings of Treasury & Agency Securities {-}

```{r banksholds1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

banksholds1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$all_bank_tsy_agency/Data$ngdpm*1000, color="All Bank Holdings of Treasuries & Agencies",linetype="All Bank Holdings of Treasuries & Agencies"))
g2 <- geom_line(aes(y=Data$ldom_bank_tsy/Data$ngdpm, color="Large Domestic Bank Holdings of Treasuries",linetype="Large Domestic Bank Holdings of Treasuries"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Large Domestic Bank Holdings of Treasuries","All Bank Holdings of Treasuries & Agencies"), values=c( "Large Domestic Bank Holdings of Treasuries"="blue", "All Bank Holdings of Treasuries & Agencies"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Large Domestic Bank Holdings of Treasuries","All Bank Holdings of Treasuries & Agencies"), values=c("Large Domestic Bank Holdings of Treasuries"=1,"All Bank Holdings of Treasuries & Agencies"=1))
size          <- scale_size_manual(" ", breaks=c("Large Domestic Bank Holdings of Treasuries","All Bank Holdings of Treasuries & Agencies"), values=c("Large Domestic Bank Holdings of Treasuries"=2,"All Bank Holdings of Treasuries & Agencies"=2))
title         <- ggtitle("Bank Holdings of Treasury & Agency Securities")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of NGDP")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, max(Data$fed_net_tsy_dur,na.rm = TRUE), .2),1))
banksholds1_fig <- banksholds1_fig + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs +yscale

nberShade(banksholds1_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/bank_hold_pt1.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Large Domestic Bank Holdings of Agency MBS and Treasuries {-}

```{r banksholds2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

banksholds2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$ldom_bank_mbs/1000, color="Large Domestic Bank Holdings of Agency MBS",linetype="Large Domestic Bank Holdings of Agency MBS"))
g2 <- geom_line(aes(y=Data$ldom_bank_tsy/1000, color="Large Domestic Bank Holdings of Treasuries",linetype="Large Domestic Bank Holdings of Treasuries"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Large Domestic Bank Holdings of Treasuries","Large Domestic Bank Holdings of Agency MBS"), values=c( "Large Domestic Bank Holdings of Treasuries"="blue", "Large Domestic Bank Holdings of Agency MBS"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Large Domestic Bank Holdings of Treasuries","Large Domestic Bank Holdings of Agency MBS"), values=c("Large Domestic Bank Holdings of Treasuries"=1,"Large Domestic Bank Holdings of Agency MBS"=1))
size          <- scale_size_manual(" ", breaks=c("Large Domestic Bank Holdings of Treasuries","Large Domestic Bank Holdings of Agency MBS"), values=c("Large Domestic Bank Holdings of Treasuries"=2,"Large Domestic Bank Holdings of Agency MBS"=2))
title         <- ggtitle("Large Domestic Bank Holdings of Agency MBS and Treasuries")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: in Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,2000, 100),0),limits = c(0,1600))
banksholds2_fig <- banksholds2_fig + g1+g2+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs +yscale

nberShade(banksholds2_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/bank_hold_pt2.jpg" ,height = 6.5,width = 11.5,units = "in")

```

```{r fdic_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# fdic_plot1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$fdic_real_estate_loans_secured_by_farmland_total_outstanding, color="3m",linetype="3m"))
# g2 <- geom_line(aes(y=Data$fdic_construction_and_development_loans_total_outstanding, color="2Y",linetype="2Y"))
# g4 <- geom_line(aes(y=Data$fdic_14_family_residential_mortgages, color="5Y",linetype="5Y"))
# g5 <- geom_line(aes(y=Data$fdic_commercial_and_industrial_loans_total_outstanding, color="10Y",linetype="10Y"))
# g3 <- geom_line(aes(y=Data$fdic_auto_loans_total_outstanding, color="3Y",linetype="3Y"))
# g6 <- geom_line(aes(y=Data$fdic_assets_in_foreign_offices, color="15Y",linetype="15Y"))
# g7 <- geom_line(aes(y=Data$fdic_total_re_loans_total_outstanding, color="20Y",linetype="20Y"))
# 
# 
# color         <- scale_color_manual(" ", breaks=c("3m","2Y","3Y","5Y","10Y","15Y","20Y"), values=c( "2Y"="blue", "3m"="red","10Y" = "black","5Y" ="green","3Y"="red","15Y" = "black","20Y" ="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("3m","2Y","3Y","5Y","10Y","15Y","20Y"), values=c("2Y"=1,"3m"=1,"10Y"=1,"5Y"=1,"3Y"=2,"15Y"=2,"20Y"=2))
# size          <- scale_size_manual(" ", breaks=c("3m","2Y","3Y","5Y","10Y","15Y","20Y"), values=c("2Y"=2,"3m"=2,"10Y"=2,"5Y"=3,"3Y"=2,"15Y"=2,"20Y"=3))
# title         <- ggtitle("Term Structure")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1984-03-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data")
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$threem,na.rm = TRUE), max(Data$threem,na.rm = TRUE), 1),0))
# 
# fdic_plot1 <- fdic_plot1 +g1+g2+g3+g4+g5+g6+g7 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs
# 
# nberShade(fdic_plot1) + yscale
# #ggsave("C:/Users/sabol/Google Drive/blogposts/termstructureplot.jpg" ,height = 6.5,width = 11.5,units = "in")

```

## U.S. Interest Rates {-}

### Term Structure {-}

```{r termstrucplot_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

termstrucplot_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$threem, color="3m",linetype="3m"))
g2 <- geom_line(aes(y=Data$two, color="2Y",linetype="2Y"))
g4 <- geom_line(aes(y=Data$five, color="5Y",linetype="5Y"))
g5 <- geom_line(aes(y=Data$ten, color="10Y",linetype="10Y"))
g3 <- geom_line(aes(y=Data$three, color="3Y",linetype="3Y"))
g6 <- geom_line(aes(y=Data$fifteen, color="15Y",linetype="15Y"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("3m","2Y","3Y","5Y","10Y","15Y","20Y"), values=c( "2Y"="blue", "3m"="red","10Y" = "black","5Y" ="green","3Y"="red","15Y" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("3m","2Y","3Y","5Y","10Y","15Y","20Y"), values=c("2Y"=1,"3m"=1,"10Y"=1,"5Y"=1,"3Y"=2,"15Y"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("3m","2Y","3Y","5Y","10Y","15Y","20Y"), values=c("2Y"=2,"3m"=2,"10Y"=2,"5Y"=3,"3Y"=2,"15Y"=2,"20Y"=3))
title         <- ggtitle("Term Structure")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1928-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$threem,na.rm = TRUE), max(Data$threem,na.rm = TRUE), 1),0))

termstrucplot_hist <- termstrucplot_hist +g1+g2+g3+g4+g5+g6+g7 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(termstrucplot_hist) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/termstructureplot.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Short-term Interest Rates {-}

```{r shortrates_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

shortrates_plot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$threem, color="3M T-Bill",linetype="3M T-Bill"))
g2 <- geom_line(aes(y=Data$cp_rate, color="Commercial Paper",linetype="Commercial Paper"))
g4 <- geom_line(aes(y=Data$fedfunds, color="Federal Funds",linetype="Federal Funds"))
g5 <- geom_line(aes(y=Data$ten, color="10Y",linetype="10Y"))
g3 <- geom_line(aes(y=Data$three, color="3Y",linetype="3Y"))
g6 <- geom_line(aes(y=Data$fifteen, color="1Federal Funds",linetype="1Federal Funds"))
g7 <- geom_line(aes(y=Data$twenty, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("3M T-Bill","Commercial Paper","3Y","Federal Funds","10Y","Federal Funds","20Y"), values=c( "Commercial Paper"="blue", "3M T-Bill"="red","10Y" = "black","Federal Funds" ="black","3Y"="red","Federal Funds" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("3M T-Bill","Commercial Paper","3Y","Federal Funds","10Y","1Federal Funds","20Y"), values=c("Commercial Paper"=1,"3M T-Bill"=1,"10Y"=1,"Federal Funds"=1,"3Y"=2,"1Federal Funds"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("3M T-Bill","Commercial Paper","3Y","Federal Funds","10Y","Federal Funds","20Y"), values=c("Commercial Paper"=2,"3M T-Bill"=2,"10Y"=2,"Federal Funds"=3,"3Y"=2,"1Federal Funds"=2,"20Y"=3))
title         <- ggtitle("Short-term Interest Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1920-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$threem,na.rm = TRUE), max(Data$fedfunds,na.rm = TRUE), 1),0))

shortrates_plot <- shortrates_plot +g1+g2+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(shortrates_plot) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/shortratesplot.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Long-term Interest Rates {-}

```{r longbonds_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ed18  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$muni_yield, color="Muni yield",linetype="Muni yield"))
g2 <- geom_line(aes(y=Data$baa, color="BAA Corporate",linetype="BAA Corporate"))
g3 <- geom_line(aes(y=Data$ten_yr_long, color="Treasury 10Y",linetype="Treasury 10Y"))
g4 <- geom_line(aes(y=Data$mort_rate, color="Mortgage rate",linetype="Mortgage rate"))

color         <- scale_color_manual(" ", breaks=c("BAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c( "BAA Corporate"="blue", "Muni yield"="red","Mortgage rate" = "black","Treasury 10Y" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("BAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c("BAA Corporate"=1,"Muni yield"=1,"Mortgage rate"=1,"Treasury 10Y"=1))
size          <- scale_size_manual(" ", breaks=c("BAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c("BAA Corporate"=2,"Muni yield"=2,"Mortgage rate"=2,"Treasury 10Y"=3))
title         <- ggtitle("Long-term Interest Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1800-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$ten,na.rm = TRUE), max(Data$mort_rate,na.rm = TRUE), 1),0))

ed18 <- ed18 +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ed18) + yscale
```

### AAA Corporate Bond Yield and US Treasury Bond Yield {-}

```{r usa_aaa, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

usa_aaa  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$muni_yield, color="Muni yield",linetype="Muni yield"))
g2 <- geom_line(aes(y=Data$aaa, color="AAA Corporate",linetype="AAA Corporate"))
g3 <- geom_line(aes(y=Data$ten_yr_long, color="Treasury 10Y",linetype="Treasury 10Y"))
g4 <- geom_line(aes(y=Data$mort_rate, color="Mortgage rate",linetype="Mortgage rate"))

color         <- scale_color_manual(" ", breaks=c("AAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c( "AAA Corporate"="blue", "Muni yield"="red","Mortgage rate" = "black","Treasury 10Y" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("AAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c("AAA Corporate"=1,"Muni yield"=1,"Mortgage rate"=1,"Treasury 10Y"=1))
size          <- scale_size_manual(" ", breaks=c("AAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c("AAA Corporate"=2,"Muni yield"=2,"Mortgage rate"=2,"Treasury 10Y"=3))
title         <- ggtitle("AAA Corporate Bond Yield and US Treasury Bond Yield")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1857-01-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$ten,na.rm = TRUE), max(Data$mort_rate,na.rm = TRUE), 1),0))

usa_aaa <- usa_aaa +g2+g3 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(usa_aaa) + yscale

```

### Long-term Interest Rates: 1999- {-}

```{r longbonds_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

longbonds_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$muni_yield, color="Muni yield",linetype="Muni yield"))
g2 <- geom_line(aes(y=Data$baa, color="BAA Corporate",linetype="BAA Corporate"))
g3 <- geom_line(aes(y=Data$ten, color="Treasury 10Y",linetype="Treasury 10Y"))
g4 <- geom_line(aes(y=Data$mort_rate, color="Mortgage rate",linetype="Mortgage rate"))

color         <- scale_color_manual(" ", breaks=c("BAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c( "BAA Corporate"="blue", "Muni yield"="red","Mortgage rate" = "black","Treasury 10Y" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("BAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c("BAA Corporate"=1,"Muni yield"=1,"Mortgage rate"=1,"Treasury 10Y"=1))
size          <- scale_size_manual(" ", breaks=c("BAA Corporate","Muni yield","Mortgage rate","Treasury 10Y"), values=c("BAA Corporate"=2,"Muni yield"=2,"Mortgage rate"=2,"Treasury 10Y"=3))
title         <- ggtitle("Long-term Interest Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,9,by = .5),2),limits = c(0,9))

longbonds_recent <- longbonds_recent +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(longbonds_recent) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/longbonds_recent.jpg" ,height = 6.5,width = 11.5,units = "in")

```

## Expectations {-}

### Short-term Inflation Expectations {-}

```{r infexp_short_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

infexp_short_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$um_expcpi1yr_median, color="UMICH 1yr - Median",linetype="UMICH 1yr - Median"))
g2 <- geom_line(aes(y=Data$cpiinf_expect_st, color="Exp CPI <= 1 yr",linetype="Exp CPI <= 1 yr"))
g4 <- geom_line(aes(y=Data$gdpinf_expect_st, color="Exp GDP DEF <= 1 yr",linetype="Exp GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$infexpst, color="Exp Inf <= 1 yr",linetype="Exp Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$inf_exp_st_alt_b, color="Exp Inf <= 1 yr (Alternative)",linetype="Exp Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$um_expcpi1yr_mean  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("UMICH 1yr - Median","Exp CPI <= 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "Exp CPI <= 1 yr"="blue", "UMICH 1yr - Median"="red","Exp Inf <= 1 yr" = "black","Exp GDP DEF <= 1 yr" ="green","Exp Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("UMICH 1yr - Median","Exp CPI <= 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("Exp CPI <= 1 yr"=1,"UMICH 1yr - Median"=1,"Exp Inf <= 1 yr"=1,"Exp GDP DEF <= 1 yr"=1,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("UMICH 1yr - Median","Exp CPI <= 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("Exp CPI <= 1 yr"=2,"UMICH 1yr - Median"=2,"Exp Inf <= 1 yr"=2,"Exp GDP DEF <= 1 yr"=3,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Short-term Inflation Expectations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1944-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: UMICH, SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

infexp_short_hist <- infexp_short_hist +g1+g2+g4+g5+g6+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(infexp_short_hist) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Short-term Inflation Expectations: 2000- {-}

```{r infexp_short_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

infexp_short_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$um_expcpi1yr_median, color="UMICH 1yr - Median",linetype="UMICH 1yr - Median"))
g2 <- geom_line(aes(y=Data$cpiinf_expect_st, color="Exp CPI <= 1 yr",linetype="Exp CPI <= 1 yr"))
g4 <- geom_line(aes(y=Data$gdpinf_expect_st, color="Exp GDP DEF <= 1 yr",linetype="Exp GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$infexpst, color="Exp Inf <= 1 yr",linetype="Exp Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$inf_exp_st_alt_b, color="Exp Inf <= 1 yr (Alternative)",linetype="Exp Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$um_expcpi1yr_mean  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("UMICH 1yr - Median","Exp CPI <= 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "Exp CPI <= 1 yr"="blue", "UMICH 1yr - Median"="red","Exp Inf <= 1 yr" = "black","Exp GDP DEF <= 1 yr" ="green","Exp Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("UMICH 1yr - Median","Exp CPI <= 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("Exp CPI <= 1 yr"=1,"UMICH 1yr - Median"=1,"Exp Inf <= 1 yr"=1,"Exp GDP DEF <= 1 yr"=1,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("UMICH 1yr - Median","Exp CPI <= 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("Exp CPI <= 1 yr"=2,"UMICH 1yr - Median"=2,"Exp Inf <= 1 yr"=2,"Exp GDP DEF <= 1 yr"=3,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Short-term Inflation Expectations: Recent History")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: UMICH, SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .5),1),limits = c(-1.5,7))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

infexp_short_recent <- infexp_short_recent +g1+g6+g4+g5+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(infexp_short_recent) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Long-term Inflation Expectations {-}

```{r infexp_long_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

infexp_long_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$um_expcpi5yr_median, color="UMICH 5 yr - Median",linetype="UMICH 5 yr - Median"))
g2 <- geom_line(aes(y=Data$cpiinf_expect_lt, color="Exp CPI > 1 yr",linetype="Exp CPI > 1 yr"))
g4 <- geom_line(aes(y=Data$gdpinf_expect_lt, color="Exp GDP DEF > 1 yr",linetype="Exp GDP DEF > 1 yr"))
g5 <- geom_line(aes(y=Data$infexplt, color="Exp Inf > 1 yr",linetype="Exp Inf > 1 yr"))
g3 <- geom_line(aes(y=Data$infexp120, color="Exp Inf 10 yr (Aruoba)",linetype="Exp Inf 10 yr (Aruoba)"))
g6 <- geom_line(aes(y=Data$um_expcpi5yr_mean  , color="UMICH 5 yr - Mean",linetype="UMICH 5 yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("UMICH 5 yr - Median","Exp CPI > 1 yr","Exp Inf 10 yr (Aruoba)","Exp GDP DEF > 1 yr","Exp Inf > 1 yr","UMICH 5 yr - Mean","20Y"), values=c( "Exp CPI > 1 yr"="blue", "UMICH 5 yr - Median"="red","Exp Inf > 1 yr" = "black","Exp GDP DEF > 1 yr" ="green","Exp Inf 10 yr (Aruoba)"="red","UMICH 5 yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("UMICH 5 yr - Median","Exp CPI > 1 yr","Exp Inf 10 yr (Aruoba)","Exp GDP DEF > 1 yr","Exp Inf > 1 yr","UMICH 5 yr - Mean","20Y"), values=c("Exp CPI > 1 yr"=1,"UMICH 5 yr - Median"=1,"Exp Inf > 1 yr"=1,"Exp GDP DEF > 1 yr"=1,"Exp Inf 10 yr (Aruoba)"=2,"UMICH 5 yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("UMICH 5 yr - Median","Exp CPI > 1 yr","Exp Inf 10 yr (Aruoba)","Exp GDP DEF > 1 yr","Exp Inf > 1 yr","UMICH 5 yr - Mean","20Y"), values=c("Exp CPI > 1 yr"=2,"UMICH 5 yr - Median"=2,"Exp Inf > 1 yr"=2,"Exp GDP DEF > 1 yr"=3,"Exp Inf 10 yr (Aruoba)"=2,"UMICH 5 yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Long-term Inflation Expectations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1944-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: UMICH, SPF, Greenbook, Aruoba, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

infexp_long_hist <- infexp_long_hist +g1+g4+g5+g6+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(infexp_long_hist) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Long-term Inflation Expectations: 2000- {-}

```{r infexp_long_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

infexp_long_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$um_expcpi5yr_median, color="UMICH 5 yr - Median",linetype="UMICH 5 yr - Median"))
g2 <- geom_line(aes(y=Data$cpiinf_expect_lt, color="Exp CPI > 1 yr",linetype="Exp CPI > 1 yr"))
g4 <- geom_line(aes(y=Data$gdpinf_expect_lt, color="Exp GDP DEF > 1 yr",linetype="Exp GDP DEF > 1 yr"))
g5 <- geom_line(aes(y=Data$infexplt, color="Exp Inf > 1 yr",linetype="Exp Inf > 1 yr"))
g3 <- geom_line(aes(y=Data$infexp120, color="Exp Inf 10 yr (Aruoba)",linetype="Exp Inf 10 yr (Aruoba)"))
g6 <- geom_line(aes(y=Data$um_expcpi5yr_mean  , color="UMICH 5 yr - Mean",linetype="UMICH 5 yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("UMICH 5 yr - Median","Exp CPI > 1 yr","Exp Inf 10 yr (Aruoba)","Exp GDP DEF > 1 yr","Exp Inf > 1 yr","UMICH 5 yr - Mean","20Y"), values=c( "Exp CPI > 1 yr"="blue", "UMICH 5 yr - Median"="red","Exp Inf > 1 yr" = "black","Exp GDP DEF > 1 yr" ="green","Exp Inf 10 yr (Aruoba)"="red","UMICH 5 yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("UMICH 5 yr - Median","Exp CPI > 1 yr","Exp Inf 10 yr (Aruoba)","Exp GDP DEF > 1 yr","Exp Inf > 1 yr","UMICH 5 yr - Mean","20Y"), values=c("Exp CPI > 1 yr"=1,"UMICH 5 yr - Median"=1,"Exp Inf > 1 yr"=1,"Exp GDP DEF > 1 yr"=1,"Exp Inf 10 yr (Aruoba)"=2,"UMICH 5 yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("UMICH 5 yr - Median","Exp CPI > 1 yr","Exp Inf 10 yr (Aruoba)","Exp GDP DEF > 1 yr","Exp Inf > 1 yr","UMICH 5 yr - Mean","20Y"), values=c("Exp CPI > 1 yr"=2,"UMICH 5 yr - Median"=2,"Exp Inf > 1 yr"=2,"Exp GDP DEF > 1 yr"=3,"Exp Inf 10 yr (Aruoba)"=2,"UMICH 5 yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Long-term Inflation Expectations: Recent History")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.98), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: UMICH, SPF, Greenbook, Aruoba, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .25),2),limits = c(1,4.5))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

infexp_long_recent <- infexp_long_recent +g1+g6+g4+g3+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(infexp_long_recent) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Term Structure of Inflation Expectations {-}

```{r infexpterm_struct, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

infexpterm_struct  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$infexp12, color="1Y",linetype="1Y"))
g2 <- geom_line(aes(y=Data$infexp24, color="2Y",linetype="2Y"))
g4 <- geom_line(aes(y=Data$infexp36, color="3Y",linetype="3Y"))
g5 <- geom_line(aes(y=Data$infexp48, color="4Y",linetype="4Y"))
g3 <- geom_line(aes(y=Data$infexp60, color="5Y",linetype="5Y"))
g6 <- geom_line(aes(y=Data$infexp84  , color="7Y",linetype="7Y"))
g7 <- geom_line(aes(y=Data$infexp120, color="10Y",linetype="10Y"))


color         <- scale_color_manual(" ", breaks=c("1Y","2Y","5Y","3Y","4Y","7Y","10Y"), values=c( "2Y"="blue", "1Y"="red","4Y" = "black","3Y" ="green","5Y"="red","7Y" = "black","10Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("1Y","2Y","5Y","3Y","4Y","7Y","10Y"), values=c("2Y"=1,"1Y"=1,"4Y"=1,"3Y"=1,"5Y"=2,"7Y"=2,"10Y"=2))
size          <- scale_size_manual(" ", breaks=c("1Y","2Y","5Y","3Y","4Y","7Y","10Y"), values=c("2Y"=2,"1Y"=2,"4Y"=2,"3Y"=3,"5Y"=2,"7Y"=2,"10Y"=3))
title         <- ggtitle("Term Structure of Inflation Expectations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.9, 0.98), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Aruoba",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .1),2))
hline         <- geom_hline(yintercept = 2, linetype="dashed")

infexpterm_struct <- infexpterm_struct +g1+g6+g4+g3+g2+g5+g7+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(infexpterm_struct) + yscale +hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Nominal GDP Expectations {-}

```{r ngdpexp_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ngdpexp_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ngdp_expect_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$ngdp_expect_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$ngdp_expect_all, color="Exp GDP DEF <= 1 yr",linetype="Exp GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$infexpst, color="Exp Inf <= 1 yr",linetype="Exp Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$inf_exp_st_alt_b, color="Exp Inf <= 1 yr (Alternative)",linetype="Exp Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$um_expcpi1yr_mean  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","Exp Inf <= 1 yr" = "black","Exp GDP DEF <= 1 yr" ="green","Exp Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"Exp Inf <= 1 yr"=1,"Exp GDP DEF <= 1 yr"=1,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"Exp Inf <= 1 yr"=2,"Exp GDP DEF <= 1 yr"=3,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Nominal GDP Expectations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1952-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

ngdpexp_hist <- ngdpexp_hist +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ngdpexp_hist) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### :Nominal GDP Expectations: 2000- {-}

```{r ngdpexp_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ngdpexp_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ngdp_expect_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$ngdp_expect_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$ngdp_expect_all, color="Exp GDP DEF <= 1 yr",linetype="Exp GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$infexpst, color="Exp Inf <= 1 yr",linetype="Exp Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$inf_exp_st_alt_b, color="Exp Inf <= 1 yr (Alternative)",linetype="Exp Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$um_expcpi1yr_mean  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","Exp Inf <= 1 yr" = "black","Exp GDP DEF <= 1 yr" ="green","Exp Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"Exp Inf <= 1 yr"=1,"Exp GDP DEF <= 1 yr"=1,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"Exp Inf <= 1 yr"=2,"Exp GDP DEF <= 1 yr"=3,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Nominal GDP Expectations: Recent")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston Survey",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 2),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

ngdpexp_recent <- ngdpexp_recent +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ngdpexp_recent) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### ISM and Short-term Less Long-term Expected NGDP Growth {-}

```{r ngdpexpism, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ngdpexpism      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$ngdp_expect_st - Data$ngdp_expect_lt, color="Expected NGDP (ST - LT)",linetype="Expected NGDP (ST - LT)"))
g2 <- geom_line(aes(y=(Data$ism-50)/5, color="ISM",linetype="ISM"))

color         <- scale_color_manual(" ", breaks=c("ISM","Expected NGDP (ST - LT)"), values=c( "ISM"="blue", "Expected NGDP (ST - LT)"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("ISM","Expected NGDP (ST - LT)"), values=c("ISM"=1,"Expected NGDP (ST - LT)"=1))
size          <- scale_size_manual(" ", breaks=c("ISM","Expected NGDP (ST - LT)"), values=c("ISM"=2,"Expected NGDP (ST - LT)"=2))
title         <- ggtitle("ISM and Short-term Less Long-term Expected NGDP Growth")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1949-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.20), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: (ISM-50)/5; Sources: Philly Fed, ISM",caption = "@capitalmarketz")

# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5, 4, 1),0),limits = c(-5,4))
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-12, 9, 1),0),limits = c(-12,9))

figure_ngdpexpism <- figure_ngdpexpism + g2 +g1+ color +linetype +size + title +text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(figure_ngdpexpism) + yscale
# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")
```

### Real GDP Expectations {-}

```{r rgdpexp_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rgdpexp_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_expect_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$rgdp_expect_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$rgdp_expect_all, color="Exp GDP DEF <= 1 yr",linetype="Exp GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$infexpst, color="Exp Inf <= 1 yr",linetype="Exp Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$inf_exp_st_alt_b, color="Exp Inf <= 1 yr (Alternative)",linetype="Exp Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$um_expcpi1yr_mean  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","Exp Inf <= 1 yr" = "black","Exp GDP DEF <= 1 yr" ="green","Exp Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"Exp Inf <= 1 yr"=1,"Exp GDP DEF <= 1 yr"=1,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"Exp Inf <= 1 yr"=2,"Exp GDP DEF <= 1 yr"=3,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Real GDP Expectations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1968-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

rgdpexp_hist <- rgdpexp_hist +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(rgdpexp_hist) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Real GDP Expectations: 2000- {-}

```{r rgdpexp_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rgdpexp_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_expect_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$rgdp_expect_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$rgdp_expect_all, color="Exp GDP DEF <= 1 yr",linetype="Exp GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$infexpst, color="Exp Inf <= 1 yr",linetype="Exp Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$inf_exp_st_alt_b, color="Exp Inf <= 1 yr (Alternative)",linetype="Exp Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$um_expcpi1yr_mean  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$um_expcpi5yr_mean, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","Exp Inf <= 1 yr" = "black","Exp GDP DEF <= 1 yr" ="green","Exp Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"Exp Inf <= 1 yr"=1,"Exp GDP DEF <= 1 yr"=1,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","Exp Inf <= 1 yr (Alternative)","Exp GDP DEF <= 1 yr","Exp Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"Exp Inf <= 1 yr"=2,"Exp GDP DEF <= 1 yr"=3,"Exp Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Real GDP Expectations: Recent")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston Survey",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 2),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

rgdpexp_recent <- rgdpexp_recent +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(rgdpexp_recent) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#expectations","Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### ISM and Short-term Less Long-term Expected RGDP Growth {-}

```{r rgdpexpism, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_rgdpexpism      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_expect_st - Data$rgdp_expect_lt, color="Expected RGDP(ST - LT)",linetype="Expected RGDP(ST - LT)"))
g2 <- geom_line(aes(y=(Data$ism-50)/4, color="ISM",linetype="ISM"))

color         <- scale_color_manual(" ", breaks=c("ISM","Expected RGDP(ST - LT)"), values=c( "ISM"="blue", "Expected RGDP(ST - LT)"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("ISM","Expected RGDP(ST - LT)"), values=c("ISM"=1,"Expected RGDP(ST - LT)"=1))
size          <- scale_size_manual(" ", breaks=c("ISM","Expected RGDP(ST - LT)"), values=c("ISM"=2,"Expected RGDP(ST - LT)"=2))
title         <- ggtitle("ISM and Short-term Less Long-term Expected RGDP Growth")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1968-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.20), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: (ISM-50)/4; Sources: Philly Fed, ISM",caption = "@capitalmarketz")

# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5, 4, 1),0),limits = c(-5,4))
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-12, 9, 1),0),limits = c(-12,9))

figure_rgdpexpism <- figure_rgdpexpism + g2 +g1+ color +linetype +size + title +text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(figure_rgdpexpism) + yscale
# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Real GDP Inter-Quartile Range {-}

```{r rgdpiqr_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rgdpiqr_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_iqr_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$rgdp_iqr_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$rgdp_iqr_all, color="iqr GDP DEF <= 1 yr",linetype="iqr GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$inf_rpf, color="iqr Inf <= 1 yr",linetype="iqr Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$cpi, color="iqr Inf <= 1 yr (Alternative)",linetype="iqr Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","iqr Inf <= 1 yr" = "black","iqr GDP DEF <= 1 yr" ="green","iqr Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"iqr Inf <= 1 yr"=1,"iqr GDP DEF <= 1 yr"=1,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"iqr Inf <= 1 yr"=2,"iqr GDP DEF <= 1 yr"=3,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Real GDP Inter-Quartile Range")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1968-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

rgdpiqr_hist <- rgdpiqr_hist +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(rgdpiqr_hist) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Real GDP Inter-Quartile Range: 2000- {-}
 
```{r rgdpiqr_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rgdpiqr_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_iqr_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$rgdp_iqr_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$rgdp_iqr_all, color="iqr GDP DEF <= 1 yr",linetype="iqr GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$inf_rpf, color="iqr Inf <= 1 yr",linetype="iqr Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$cpi, color="iqr Inf <= 1 yr (Alternative)",linetype="iqr Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))

color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","iqr Inf <= 1 yr" = "black","iqr GDP DEF <= 1 yr" ="green","iqr Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"iqr Inf <= 1 yr"=1,"iqr GDP DEF <= 1 yr"=1,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"iqr Inf <= 1 yr"=2,"iqr GDP DEF <= 1 yr"=3,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Real GDP Inter-Quartile Range: Recent")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston Survey",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

rgdpiqr_recent <- rgdpiqr_recent +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(rgdpiqr_recent) + yscale + hline

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Nominal GDP Inter-Quartile Range {-}

```{r ngdpiqr_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ngdpiqr_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ngdp_iqr_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$ngdp_iqr_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$ngdp_iqr_all, color="iqr GDP DEF <= 1 yr",linetype="iqr GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$inf_rpf, color="iqr Inf <= 1 yr",linetype="iqr Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$cpi, color="iqr Inf <= 1 yr (Alternative)",linetype="iqr Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","iqr Inf <= 1 yr" = "black","iqr GDP DEF <= 1 yr" ="green","iqr Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"iqr Inf <= 1 yr"=1,"iqr GDP DEF <= 1 yr"=1,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"iqr Inf <= 1 yr"=2,"iqr GDP DEF <= 1 yr"=3,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Nominal GDP Inter-Quartile Range")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1951-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

ngdpiqr_hist <- ngdpiqr_hist +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ngdpiqr_hist) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Nominal GDP Inter-Quartile Range: 2000- {-}

```{r ngdpiqr_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ngdpiqr_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ngdp_iqr_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$ngdp_iqr_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$ngdp_iqr_all, color="iqr GDP DEF <= 1 yr",linetype="iqr GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$inf_rpf, color="iqr Inf <= 1 yr",linetype="iqr Inf <= 1 yr"))
g3 <- geom_line(aes(y=Data$cpi, color="iqr Inf <= 1 yr (Alternative)",linetype="iqr Inf <= 1 yr (Alternative)"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))

color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="red","iqr Inf <= 1 yr" = "black","iqr GDP DEF <= 1 yr" ="green","iqr Inf <= 1 yr (Alternative)"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"iqr Inf <= 1 yr"=1,"iqr GDP DEF <= 1 yr"=1,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","iqr Inf <= 1 yr (Alternative)","iqr GDP DEF <= 1 yr","iqr Inf <= 1 yr","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"iqr Inf <= 1 yr"=2,"iqr GDP DEF <= 1 yr"=3,"iqr Inf <= 1 yr (Alternative)"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Nominal GDP Inter-Quartile Range: Recent")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston Survey",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, 1),0))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

ngdpiqr_recent <- ngdpiqr_recent +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ngdpiqr_recent) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Nominal GDP Inter-Quartile Range and Credit Spreads {-}

```{r ngdpiqr_baatensp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ngdpiqr_baatensp  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ngdp_iqr_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$ngdp_iqr_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$ngdp_iqr_all, color="Mean IQR - All Horizons",linetype="Mean IQR - All Horizons"))
g5 <- geom_line(aes(y=Data$baa- Data$ten, color="BAA - 10 yr spread",linetype="BAA - 10 yr spread"))
g3 <- geom_line(aes(y=Data$baa- Data$aaa, color="BAA - AAA Spread",linetype="BAA - AAA Spread"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","BAA - AAA Spread","Mean IQR - All Horizons","BAA - 10 yr spread","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="blue","BAA - 10 yr spread" = "black","Mean IQR - All Horizons" ="red","BAA - AAA Spread"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","BAA - AAA Spread","Mean IQR - All Horizons","BAA - 10 yr spread","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"BAA - 10 yr spread"=1,"Mean IQR - All Horizons"=1,"BAA - AAA Spread"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","BAA - AAA Spread","Mean IQR - All Horizons","BAA - 10 yr spread","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"BAA - 10 yr spread"=2,"Mean IQR - All Horizons"=3,"BAA - AAA Spread"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Nominal GDP Inter-Quartile Range and Credit Spreads")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1951-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .5),1),limits = c(0,6))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

ngdpiqr_baatensp <- ngdpiqr_baatensp +g2+g5+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ngdpiqr_baatensp) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Inflation Inter-Quartile Range{-}

```{r cpiinfiqr_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

cpiinfiqr_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$cpiinf_iqr_st, color="CPI <= 1 yr",linetype="CPI <= 1 yr"))
g2 <- geom_line(aes(y=Data$cpiinf_iqr_lt, color="CPI > 1 yr",linetype="CPI > 1 yr"))
g4 <- geom_line(aes(y=Data$cpiinf_iqr_all, color="iqr GDP DEF <= 1 yr",linetype="iqr GDP DEF <= 1 yr"))
g5 <- geom_line(aes(y=Data$gdpinf_iqr_lt1, color="GDP INF > 1 yr",linetype="GDP INF > 1 yr"))
g3 <- geom_line(aes(y=Data$gdpinf_iqr_st1, color="GDP INF <= 1 yr",linetype="GDP INF <= 1 yr"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("CPI <= 1 yr","CPI > 1 yr","GDP INF <= 1 yr","iqr GDP DEF <= 1 yr","GDP INF > 1 yr","UMICH 1yr - Mean","20Y"), values=c( "CPI > 1 yr"="blue", "CPI <= 1 yr"="red","GDP INF > 1 yr" = "black","iqr GDP DEF <= 1 yr" ="green","GDP INF <= 1 yr"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("CPI <= 1 yr","CPI > 1 yr","GDP INF <= 1 yr","iqr GDP DEF <= 1 yr","GDP INF > 1 yr","UMICH 1yr - Mean","20Y"), values=c("CPI > 1 yr"=1,"CPI <= 1 yr"=1,"GDP INF > 1 yr"=1,"iqr GDP DEF <= 1 yr"=1,"GDP INF <= 1 yr"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("CPI <= 1 yr","CPI > 1 yr","GDP INF <= 1 yr","iqr GDP DEF <= 1 yr","GDP INF > 1 yr","UMICH 1yr - Mean","20Y"), values=c("CPI > 1 yr"=2,"CPI <= 1 yr"=2,"GDP INF > 1 yr"=2,"iqr GDP DEF <= 1 yr"=3,"GDP INF <= 1 yr"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Inflation Inter-Quartile Range")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1948-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .5),1),limits = c(0,6.5))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

cpiinfiqr_hist <- cpiinfiqr_hist +g1+g2+ g5+g3+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(cpiinfiqr_hist) + yscale 

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Inflation Inter-Quartile Range: 2000- {-}

```{r cpiinfiqr_recent, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

cpiinfiqr_recent  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$cpiinf_iqr_st, color="CPI <= 1 yr",linetype="CPI <= 1 yr"))
g2 <- geom_line(aes(y=Data$cpiinf_iqr_lt, color="CPI > 1 yr",linetype="CPI > 1 yr"))
g4 <- geom_line(aes(y=Data$cpiinf_iqr_all, color="iqr GDP DEF <= 1 yr",linetype="iqr GDP DEF <= 1 yr"))
g3 <- geom_line(aes(y=Data$gdpinf_iqr_st1, color="GDP INF <= 1 yr",linetype="GDP INF <= 1 yr"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))

color         <- scale_color_manual(" ", breaks=c("CPI <= 1 yr","CPI > 1 yr","GDP INF <= 1 yr","iqr GDP DEF <= 1 yr","GDP INF > 1 yr","UMICH 1yr - Mean","20Y"), values=c( "CPI > 1 yr"="blue", "CPI <= 1 yr"="red","GDP INF > 1 yr" = "black","iqr GDP DEF <= 1 yr" ="green","GDP INF <= 1 yr"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("CPI <= 1 yr","CPI > 1 yr","GDP INF <= 1 yr","iqr GDP DEF <= 1 yr","GDP INF > 1 yr","UMICH 1yr - Mean","20Y"), values=c("CPI > 1 yr"=1,"CPI <= 1 yr"=1,"GDP INF > 1 yr"=1,"iqr GDP DEF <= 1 yr"=1,"GDP INF <= 1 yr"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("CPI <= 1 yr","CPI > 1 yr","GDP INF <= 1 yr","iqr GDP DEF <= 1 yr","GDP INF > 1 yr","UMICH 1yr - Mean","20Y"), values=c("CPI > 1 yr"=2,"CPI <= 1 yr"=2,"GDP INF > 1 yr"=2,"iqr GDP DEF <= 1 yr"=3,"GDP INF <= 1 yr"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("Inflation Inter-Quartile Range: Recent")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston Survey",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .25),2),limits = c(0,3.25))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

cpiinfiqr_recent <- cpiinfiqr_recent +g1+g2+ g5+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(cpiinfiqr_recent) + yscale 

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### CPI Inter-Quartile Range and BAA-AAA Spread {-}

```{r cpiinfiqr_baatensp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

cpiinfiqr_baatensp  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$cpiinf_iqr_st, color="<= 1 yr",linetype="<= 1 yr"))
g2 <- geom_line(aes(y=Data$cpiinf_iqr_lt, color="> 1 yr",linetype="> 1 yr"))
g4 <- geom_line(aes(y=Data$cpiinf_iqr_all, color="Mean IQR - All Horizons",linetype="Mean IQR - All Horizons"))
g5 <- geom_line(aes(y=Data$baa- Data$ten, color="BAA - 10 yr spread",linetype="BAA - 10 yr spread"))
g3 <- geom_line(aes(y=Data$baa- Data$aaa, color="BAA - AAA Spread",linetype="BAA - AAA Spread"))
g6 <- geom_line(aes(y=Data$cpi  , color="UMICH 1yr - Mean",linetype="UMICH 1yr - Mean"))
g7 <- geom_line(aes(y=Data$cpi, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("<= 1 yr","> 1 yr","BAA - AAA Spread","Mean IQR - All Horizons","BAA - 10 yr spread","UMICH 1yr - Mean","20Y"), values=c( "> 1 yr"="blue", "<= 1 yr"="blue","BAA - 10 yr spread" = "black","Mean IQR - All Horizons" ="red","BAA - AAA Spread"="red","UMICH 1yr - Mean" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("<= 1 yr","> 1 yr","BAA - AAA Spread","Mean IQR - All Horizons","BAA - 10 yr spread","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=1,"<= 1 yr"=1,"BAA - 10 yr spread"=1,"Mean IQR - All Horizons"=1,"BAA - AAA Spread"=2,"UMICH 1yr - Mean"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("<= 1 yr","> 1 yr","BAA - AAA Spread","Mean IQR - All Horizons","BAA - 10 yr spread","UMICH 1yr - Mean","20Y"), values=c("> 1 yr"=2,"<= 1 yr"=2,"BAA - 10 yr spread"=2,"Mean IQR - All Horizons"=3,"BAA - AAA Spread"=2,"UMICH 1yr - Mean"=2,"20Y"=3))
title         <- ggtitle("CPI Inter-Quartile Range and BAA-AAA Spread")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1951-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: SPF, Greenbook, and Livingston",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20,20, .5),1),limits = c(0,6.5))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

cpiinfiqr_baatensp <- cpiinfiqr_baatensp +g1+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(cpiinfiqr_baatensp) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at:","https://rb.gy/fakqog",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

## U.S. Expected Returns {-}

### Treasury Price Index {-}

```{r tsypiplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsypiplot_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$tsypi*100, color="Treasury Price Index",linetype="Treasury Price Index"))
g2 <- geom_line(aes(y=Data$ret_avg, color="Actual Return",linetype="Actual Return"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Actual Return","Treasury Price Index"), values=c( "Actual Return"="blue", "Treasury Price Index"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Actual Return","Treasury Price Index"), values=c("Actual Return"=1,"Treasury Price Index"=1))
size          <- scale_size_manual(" ", breaks=c("Actual Return","Treasury Price Index"), values=c("Actual Return"=2,"Treasury Price Index"=2))
title         <- ggtitle("Treasury Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Dallas Fed")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-12,10, 1),0))
tsypiplot_fig <- tsypiplot_fig + g1  + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs + hline

nberShade(tsypiplot_fig) + yscale

```

### Annual Treasury Returns {-}

```{r tsyrret_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyrret_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ret7, color="7Y",linetype="7Y"))
g2 <- geom_line(aes(y=Data$ret2, color="2Y",linetype="2Y"))
g4 <- geom_line(aes(y=Data$ret5, color="5Y",linetype="5Y"))
g5 <- geom_line(aes(y=Data$ret10, color="10Y",linetype="10Y"))
g3 <- geom_line(aes(y=Data$ret3, color="3Y",linetype="3Y"))
g6 <- geom_line(aes(y=Data$ret25, color="25Y",linetype="25Y"))
g7 <- geom_line(aes(y=Data$ret20, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("7Y","2Y","3Y","5Y","10Y","25Y","20Y"), values=c( "2Y"="blue", "7Y"="red","10Y" = "black","5Y" ="green","3Y"="red","25Y" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("7Y","2Y","3Y","5Y","10Y","25Y","20Y"), values=c("2Y"=1,"7Y"=1,"10Y"=1,"5Y"=1,"3Y"=2,"25Y"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("7Y","2Y","3Y","5Y","10Y","25Y","20Y"), values=c("2Y"=2,"7Y"=2,"10Y"=2,"5Y"=3,"3Y"=2,"25Y"=2,"20Y"=3))
title         <- ggtitle("One-yr Treasury Returns")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1929-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,300, 10),0))

tsyrret_hist <- tsyrret_hist +g1+g2+g3+g4+g5+g6+g7 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tsyrret_hist) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/ocbulk",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### One-yr Treasury Excess Returns {-}

```{r tsyrxrx_hist, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tsyrxrx_hist  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rx7, color="7Y",linetype="7Y"))
g2 <- geom_line(aes(y=Data$rx2, color="2Y",linetype="2Y"))
g4 <- geom_line(aes(y=Data$rx5, color="5Y",linetype="5Y"))
g5 <- geom_line(aes(y=Data$rx10, color="10Y",linetype="10Y"))
g3 <- geom_line(aes(y=Data$rx3, color="3Y",linetype="3Y"))
g6 <- geom_line(aes(y=Data$rx25, color="25Y",linetype="25Y"))
g7 <- geom_line(aes(y=Data$rx20, color="20Y",linetype="20Y"))


color         <- scale_color_manual(" ", breaks=c("7Y","2Y","3Y","5Y","10Y","25Y","20Y"), values=c( "2Y"="blue", "7Y"="red","10Y" = "black","5Y" ="green","3Y"="red","25Y" = "black","20Y" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("7Y","2Y","3Y","5Y","10Y","25Y","20Y"), values=c("2Y"=1,"7Y"=1,"10Y"=1,"5Y"=1,"3Y"=2,"25Y"=2,"20Y"=2))
size          <- scale_size_manual(" ", breaks=c("7Y","2Y","3Y","5Y","10Y","25Y","20Y"), values=c("2Y"=2,"7Y"=2,"10Y"=2,"5Y"=3,"3Y"=2,"25Y"=2,"20Y"=3))
title         <- ggtitle("One-yr Treasury Excess Returns")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1929-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,300, 10),0))

tsyrxrx_hist <- tsyrxrx_hist +g1+g2+g3+g4+g5+g6+g7 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tsyrxrx_hist) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/ocbulk",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Average Bank Income Gap {-}

```{r netincgapplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_netincgap      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$net_inc_gap, color="Bank Net Income Gap",linetype="Bank Net Income Gap"))
g2 <- geom_line(aes(y=Data$rx2to5avg/50, color="Average of rx(2)..rx(5) (t+1)",linetype="Average of rx(2)..rx(5) (t+1)"))

color         <- scale_color_manual(" ", breaks=c("Average of rx(2)..rx(5) (t+1)","Bank Net Income Gap"), values=c( "Average of rx(2)..rx(5) (t+1)"="blue", "Bank Net Income Gap"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Average of rx(2)..rx(5) (t+1)","Bank Net Income Gap"), values=c("Average of rx(2)..rx(5) (t+1)"=1,"Bank Net Income Gap"=1))
size          <- scale_size_manual(" ", breaks=c("Average of rx(2)..rx(5) (t+1)","Bank Net Income Gap"), values=c("Average of rx(2)..rx(5) (t+1)"=2,"Bank Net Income Gap"=2))
title         <- ggtitle("Average Bank Income Gap and one-yr ahead average Excess Return on 2-to-5-yr Treasuries")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1986-06-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Average Excess Return/50; Source: Haddad and Sraer (2018)")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-.3,.3,.025),3),limits = c(-.1,.25))
figure_netincgap <- figure_netincgap + g1+g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(figure_netincgap) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/banknetincgap.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Level of Treasury Yields and Fundamental De-trenders (Part 1) {-}

```{r expret1A, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

expretA1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$yield_avg, color="Average Treasury yield",linetype="Average Treasury yield"))
g2 <- geom_line(aes(y=Data$taungdppercapita, color="Trend NGDP per capita",linetype="Trend NGDP per capita"))
g3 <- geom_line(aes(y=Data$taucorecpi, color="Trend Core CPI",linetype="Trend Core CPI"))
g4 <- geom_line(aes(y=Data$infexplt, color="Expected Inflation (>1yr)",linetype="Expected Inflation (>1yr)"))

color         <- scale_color_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Expected Inflation (>1yr)","Trend Core CPI"), values=c( "Trend NGDP per capita"="blue", "Average Treasury yield"="red","Expected Inflation (>1yr)" = "black","Trend Core CPI" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Expected Inflation (>1yr)","Trend Core CPI"), values=c("Trend NGDP per capita"=1,"Average Treasury yield"=1,"Expected Inflation (>1yr)"=1,"Trend Core CPI"=1))
size          <- scale_size_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Expected Inflation (>1yr)","Trend Core CPI"), values=c("Trend NGDP per capita"=2,"Average Treasury yield"=2,"Expected Inflation (>1yr)"=2,"Trend Core CPI"=3))
title         <- ggtitle("Level of Treasury Yields and Fundamental De-trenders (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1954-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1, max(Data$yield_avg,na.rm = TRUE), 1),0),limits = c(-1,14))
expretA1 <- expretA1 +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(expretA1) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/yieldlevel.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Level of Treasury Yields and Fundamental De-trenders: 1990- {-}

```{r expret1B, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

expret1B  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$yield_avg, color="Average Treasury yield",linetype="Average Treasury yield"))
g2 <- geom_line(aes(y=Data$taungdppercapita, color="Trend NGDP per capita",linetype="Trend NGDP per capita"))
g3 <- geom_line(aes(y=Data$taucorecpi, color="Trend Core CPI",linetype="Trend Core CPI"))
g4 <- geom_line(aes(y=Data$infexplt, color="Expected Inflation (>1yr)",linetype="Expected Inflation (>1yr)"))

color         <- scale_color_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Expected Inflation (>1yr)","Trend Core CPI"), values=c( "Trend NGDP per capita"="blue", "Average Treasury yield"="red","Expected Inflation (>1yr)" = "black","Trend Core CPI" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Expected Inflation (>1yr)","Trend Core CPI"), values=c("Trend NGDP per capita"=1,"Average Treasury yield"=1,"Expected Inflation (>1yr)"=1,"Trend Core CPI"=1))
size          <- scale_size_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Expected Inflation (>1yr)","Trend Core CPI"), values=c("Trend NGDP per capita"=2,"Average Treasury yield"=2,"Expected Inflation (>1yr)"=2,"Trend Core CPI"=3))
title         <- ggtitle("Level of Treasury Yields and Fundamental De-trenders (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 8.5, .5),1),limits = c(0,8.5))
expret1B <- expret1B +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(expret1B) + yscale
```

### Average Expected and Realized Treasury Return (Part 1) {-}

```{r exprret2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

exprret2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$exp_ret_ngdpcapita, color="Expected Return",linetype="Expected Return"))
g2 <- geom_line(aes(y=Data$ret_avg, color="Actual Return",linetype="Actual Return"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Actual Return","Expected Return"), values=c( "Actual Return"="blue", "Expected Return"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Actual Return","Expected Return"), values=c("Actual Return"=1,"Expected Return"=1))
size          <- scale_size_manual(" ", breaks=c("Actual Return","Expected Return"), values=c("Actual Return"=2,"Expected Return"=2))
title         <- ggtitle("Average Expected and Realized Treasury Return (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1954-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$ret_avg,na.rm = TRUE), max(Data$ret_avg,na.rm = TRUE), 5),0))
exprret2_fig <- exprret2_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs + hline

nberShade(exprret2_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/expretavg.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Average Expected and Realized Treasury Return (Part 2) {-}

```{r exprret2b2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

exprret2b2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$exp_ret_ngdpcapita, color="Expected Return",linetype="Expected Return"))
g2 <- geom_line(aes(y=Data$ret_avg, color="Actual Return",linetype="Actual Return"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Actual Return","Expected Return"), values=c( "Actual Return"="blue", "Expected Return"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Actual Return","Expected Return"), values=c("Actual Return"=1,"Expected Return"=1))
size          <- scale_size_manual(" ", breaks=c("Actual Return","Expected Return"), values=c("Actual Return"=2,"Expected Return"=2))
title         <- ggtitle("Average Expected and Realized Treasury Return (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.70, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$ret_avg,na.rm = TRUE), max(Data$ret_avg,na.rm = TRUE), 2),1),limits = c(-18,28))
exprret2b2_fig <- exprret2b2_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs + hline

nberShade(exprret2b2_fig) + yscale

```

```{r expretpredlevel, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exppredlevel  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$yield_avg, color="Average Treasury yield",linetype="Average Treasury yield"))
# g2 <- geom_line(aes(y=Data$taungdppercapita, color="Trend NGDP per capita",linetype="Trend NGDP per capita"))
# g3 <- geom_line(aes(y=Data$ybar_pred, color="Trend Core CPI Predicted Level",linetype="Trend Core CPI Predicted Level"))
# g4 <- geom_line(aes(y=Data$ybar_pred_gdp, color="Trend NGDP per capita Predicted Level",linetype="Trend NGDP per capita Predicted Level"))
# 
# color         <- scale_color_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Trend NGDP per capita Predicted Level","Trend Core CPI Predicted Level"), values=c( "Trend NGDP per capita"="blue", "Average Treasury yield"="red","Trend NGDP per capita Predicted Level" = "black","Trend Core CPI Predicted Level" ="green"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Trend NGDP per capita Predicted Level","Trend Core CPI Predicted Level"), values=c("Trend NGDP per capita"=1,"Average Treasury yield"=1,"Trend NGDP per capita Predicted Level"=1,"Trend Core CPI Predicted Level"=1))
# size          <- scale_size_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Trend NGDP per capita Predicted Level","Trend Core CPI Predicted Level"), values=c("Trend NGDP per capita"=2,"Average Treasury yield"=2,"Trend NGDP per capita Predicted Level"=2,"Trend Core CPI Predicted Level"=3))
# title         <- ggtitle("Level of Treasury Yields and Regression Based Fundamental De-trenders (Part 1)")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1954-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data")
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, max(Data$yield_avg,na.rm = TRUE), 1),0),limits = c(0,14))
# exppredlevel <- exppredlevel +g1+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs
# 
# nberShade(exppredlevel) + yscale
```

```{r expretpredlevel2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exppredlevel2  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$yield_avg, color="Average Treasury yield",linetype="Average Treasury yield"))
# g2 <- geom_line(aes(y=Data$taungdppercapita, color="Trend NGDP per capita",linetype="Trend NGDP per capita"))
# g3 <- geom_line(aes(y=Data$ybar_pred, color="Trend Core CPI Predicted Level",linetype="Trend Core CPI Predicted Level"))
# g4 <- geom_line(aes(y=Data$ybar_pred_gdp, color="Trend NGDP per capita Predicted Level",linetype="Trend NGDP per capita Predicted Level"))
# 
# color         <- scale_color_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Trend NGDP per capita Predicted Level","Trend Core CPI Predicted Level"), values=c( "Trend NGDP per capita"="blue", "Average Treasury yield"="red","Trend NGDP per capita Predicted Level" = "black","Trend Core CPI Predicted Level" ="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Trend NGDP per capita Predicted Level","Trend Core CPI Predicted Level"), values=c("Trend NGDP per capita"=1,"Average Treasury yield"=1,"Trend NGDP per capita Predicted Level"=1,"Trend Core CPI Predicted Level"=1))
# size          <- scale_size_manual(" ", breaks=c("Trend NGDP per capita","Average Treasury yield","Trend NGDP per capita Predicted Level","Trend Core CPI Predicted Level"), values=c("Trend NGDP per capita"=2,"Average Treasury yield"=2,"Trend NGDP per capita Predicted Level"=2,"Trend Core CPI Predicted Level"=3))
# title         <- ggtitle("Level of Treasury Yields and Regression Based Fundamental De-trenders (Part 2)")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data")
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 8.5, .5),1),limits = c(0,8.5))
# exppredlevel2 <- exppredlevel2 +g1+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs
# 
# nberShade(exppredlevel2) + yscale
```

### Regression Based Expected Excess Treasury Returns  (Part 1) {-}

```{r expretpredlevelx, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

expretreg  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rx_avg, color="Average Excess Return",linetype="Average Excess Return"))
g2 <- geom_line(aes(y=Data$rpf_cp_isat2, color="RPF (Trend core CPI)",linetype="RPF (Trend core CPI)"))
g3 <- geom_line(aes(y=Data$rpf_gdp, color="RPF (Trend NGDP per capita)",linetype="RPF (Trend NGDP per capita)"))
g4 <- geom_line(aes(y=Data$rpf_cp_isat, color="RPF (Trend core CPI, ISAT)",linetype="RPF (Trend core CPI, ISAT)"))

color         <- scale_color_manual(" ", breaks=c("RPF (Trend core CPI)","Average Excess Return","RPF (Trend core CPI, ISAT)","RPF (Trend NGDP per capita)"), values=c( "RPF (Trend core CPI)"="blue", "Average Excess Return"="red","RPF (Trend core CPI, ISAT)" = "black","RPF (Trend NGDP per capita)" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("RPF (Trend core CPI)","Average Excess Return","RPF (Trend core CPI, ISAT)","RPF (Trend NGDP per capita)"), values=c("RPF (Trend core CPI)"=1,"Average Excess Return"=1,"RPF (Trend core CPI, ISAT)"=1,"RPF (Trend NGDP per capita)"=1))
size          <- scale_size_manual(" ", breaks=c("RPF (Trend core CPI)","Average Excess Return","RPF (Trend core CPI, ISAT)","RPF (Trend NGDP per capita)"), values=c("RPF (Trend core CPI)"=2,"Average Excess Return"=2,"RPF (Trend core CPI, ISAT)"=2,"RPF (Trend NGDP per capita)"=3))
title         <- ggtitle("Regression Based Expected Excess Treasury Returns  (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1954-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$rx_avg,na.rm = TRUE), max(Data$rx_avg,na.rm = TRUE), 5),0))
expretreg <- expretreg +g1+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(expretreg) + yscale
```

### Regression Based Expected Excess Treasury Returns  (Part 2) {-}

```{r expretpredlevel2x, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

expretreg2  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rx_avg, color="Average Excess Return",linetype="Average Excess Return"))
g2 <- geom_line(aes(y=Data$rpf_cp_isat2, color="RPF (Trend core CPI)",linetype="RPF (Trend core CPI)"))
g3 <- geom_line(aes(y=Data$rpf_gdp, color="RPF (Trend NGDP per capita)",linetype="RPF (Trend NGDP per capita)"))
g4 <- geom_line(aes(y=Data$rpf_cp_isat, color="RPF (Trend core CPI, ISAT)",linetype="RPF (Trend core CPI, ISAT)"))

color         <- scale_color_manual(" ", breaks=c("RPF (Trend core CPI)","Average Excess Return","RPF (Trend core CPI, ISAT)","RPF (Trend NGDP per capita)"), values=c( "RPF (Trend core CPI)"="blue", "Average Excess Return"="red","RPF (Trend core CPI, ISAT)" = "black","RPF (Trend NGDP per capita)" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("RPF (Trend core CPI)","Average Excess Return","RPF (Trend core CPI, ISAT)","RPF (Trend NGDP per capita)"), values=c("RPF (Trend core CPI)"=1,"Average Excess Return"=1,"RPF (Trend core CPI, ISAT)"=1,"RPF (Trend NGDP per capita)"=1))
size          <- scale_size_manual(" ", breaks=c("RPF (Trend core CPI)","Average Excess Return","RPF (Trend core CPI, ISAT)","RPF (Trend NGDP per capita)"), values=c("RPF (Trend core CPI)"=2,"Average Excess Return"=2,"RPF (Trend core CPI, ISAT)"=2,"RPF (Trend NGDP per capita)"=3))
title         <- ggtitle("Regression Based Expected Excess Treasury Returns  (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.25), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-18, 20, 2),0),limits = c(-18,20))
expretreg2 <- expretreg2 +g1+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(expretreg2) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/expretavgregbased.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### 10-yr Treasury Yield Decomposition {-}

```{r termdecomp1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

termdecomp1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$IRP10_adj, color="Inflation Risk Premium",linetype="Inflation Risk Premium"))
g2 <- geom_line(aes(y=Data$Inf10_adj, color="Expected Inflation",linetype="Expected Inflation"))
g4 <- geom_line(aes(y=Data$R10_adj, color="Real Yield",linetype="Real Yield"))
g5 <- geom_line(aes(y=Data$RBRPRXmpB10, color="ITA",linetype="ITA"))
g3 <- geom_line(aes(y=Data$LO10_adj, color="Credit + Oil Yield",linetype="Credit + Oil Yield"))
g6 <- geom_line(aes(y=Data$nzl_by, color="NZL",linetype="NZL"))
g7 <- geom_line(aes(y=Data$prt_by, color="PRT",linetype="PRT"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c( "Expected Inflation"="blue", "Inflation Risk Premium"="blue","ITA" = "black","Real Yield" ="black","Credit + Oil Yield"="red","NZL" = "black","PRT" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c("Expected Inflation"=1,"Inflation Risk Premium"=2,"ITA"=1,"Real Yield"=1,"Credit + Oil Yield"=1,"NZL"=2,"PRT"=2))
size          <- scale_size_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c("Expected Inflation"=2,"Inflation Risk Premium"=11,"ITA"=2,"Real Yield"=3,"Credit + Oil Yield"=2,"NZL"=2,"PRT"=3))
title         <- ggtitle("10-yr Treasury Yield Decomposition")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-2, 23, .5),1),limits = c(-1.75,4.5))

termdecomp1 <- termdecomp1 +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(termdecomp1) + yscale + size
```

### 2-yr Treasury Yield Decomposition {-}

```{r termdecomp2yr, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

termdecomp2yr  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$IRP2_adj, color="Inflation Risk Premium",linetype="Inflation Risk Premium"))
g2 <- geom_line(aes(y=Data$Inf2_adj, color="Expected Inflation",linetype="Expected Inflation"))
g4 <- geom_line(aes(y=Data$R2_adj, color="Real Yield",linetype="Real Yield"))
g5 <- geom_line(aes(y=Data$RBRP10, color="ITA",linetype="ITA"))
g3 <- geom_line(aes(y=Data$LO2_adj, color="Credit + Oil Yield",linetype="Credit + Oil Yield"))
g6 <- geom_line(aes(y=Data$nzl_by, color="NZL",linetype="NZL"))
g7 <- geom_line(aes(y=Data$prt_by, color="PRT",linetype="PRT"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c( "Expected Inflation"="blue", "Inflation Risk Premium"="blue","ITA" = "black","Real Yield" ="black","Credit + Oil Yield"="red","NZL" = "black","PRT" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c("Expected Inflation"=1,"Inflation Risk Premium"=2,"ITA"=1,"Real Yield"=1,"Credit + Oil Yield"=1,"NZL"=2,"PRT"=2))
size          <- scale_size_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c("Expected Inflation"=2,"Inflation Risk Premium"=11,"ITA"=2,"Real Yield"=3,"Credit + Oil Yield"=2,"NZL"=2,"PRT"=3))
title         <- ggtitle("2-yr Treasury Yield Decomposition")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 23, .5),1),limits = c(-4,4.5))

termdecomp2yr <- termdecomp2yr +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(termdecomp2yr) + yscale + size
```

### 5-yr Treasury Yield Decomposition {-}

```{r termdecomp5yr, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

termdecomp5yr  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$IRP5_adj, color="Inflation Risk Premium",linetype="Inflation Risk Premium"))
g2 <- geom_line(aes(y=Data$Inf5_adj, color="Expected Inflation",linetype="Expected Inflation"))
g4 <- geom_line(aes(y=Data$R5_adj, color="Real Yield",linetype="Real Yield"))
g5 <- geom_line(aes(y=Data$ita_by, color="ITA",linetype="ITA"))
g3 <- geom_line(aes(y=Data$LO5_adj, color="Credit + Oil Yield",linetype="Credit + Oil Yield"))
g6 <- geom_line(aes(y=Data$nzl_by, color="NZL",linetype="NZL"))
g7 <- geom_line(aes(y=Data$prt_by, color="PRT",linetype="PRT"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c( "Expected Inflation"="blue", "Inflation Risk Premium"="blue","ITA" = "black","Real Yield" ="black","Credit + Oil Yield"="red","NZL" = "black","PRT" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c("Expected Inflation"=1,"Inflation Risk Premium"=2,"ITA"=1,"Real Yield"=1,"Credit + Oil Yield"=1,"NZL"=2,"PRT"=2))
size          <- scale_size_manual(" ", breaks=c("Inflation Risk Premium","Expected Inflation","Credit + Oil Yield","Real Yield","ITA","NZL","PRT"), values=c("Expected Inflation"=2,"Inflation Risk Premium"=11,"ITA"=2,"Real Yield"=3,"Credit + Oil Yield"=2,"NZL"=2,"PRT"=3))
title         <- ggtitle("5-yr Treasury Yield Decomposition")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 23, .5),1),limits = c(-3,4.5))

termdecomp5yr <- termdecomp5yr +g1+g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(termdecomp5yr) + yscale + size
```

```{r termdecomp2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
# 
# termdecomp2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$rpredL10 , color="Predicted 10-yr real yield ",linetype="Predicted 10-yr real yield ", size="Predicted 10-yr real yield "))
# g2 <- geom_line(aes(y=Data$rpredL2-.5, color="Predicted 2-yr real yield",linetype="Predicted 2-yr real yield",size="Predicted 2-yr real yield"))
# g3 <- geom_line(aes(y=Data$R10_adj, color="Real 10 year adj - yield",linetype="Real 10 year adj - yield", size="Real 10 year adj - yield"))
# g4 <- geom_line(aes(y=Data$R2_adj, color="Real 2 year adj - yield",linetype="Real 2 year adj - yield", size="Real 2 year adj - yield"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("Predicted 2-yr real yield","Predicted 10-yr real yield ", "Real 10 year adj - yield","Real 2 year adj - yield"), values=c( "Predicted 2-yr real yield"="blue", "Predicted 10-yr real yield "="red", "Real 10 year adj - yield"="red","Real 2 year adj - yield"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Predicted 2-yr real yield","Predicted 10-yr real yield ","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Predicted 2-yr real yield"=2,"Predicted 10-yr real yield "=2,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# size          <- scale_size_manual(" ", breaks=c("Predicted 2-yr real yield","Predicted 10-yr real yield ","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Predicted 2-yr real yield"=2,"Predicted 10-yr real yield "=2,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# title         <- ggtitle("Real 10-yr Predicted by Trend Real GDP per capita and ex-ante Real T-Bill")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 23, .5),1),limits = c(-2,4.5))
# 
# termdecomp2    <- termdecomp2 + g1 +g3 +hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(termdecomp2) + yscale + size
```

```{r termdecomp3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# termdecomp3      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$rpredL10-.2, color="Predicted 10-yr real yield ",linetype="Predicted 10-yr real yield ", size="Predicted 10-yr real yield "))
# g2 <- geom_line(aes(y=Data$rpredL2, color="Predicted 2-yr real yield",linetype="Predicted 2-yr real yield",size="Predicted 2-yr real yield"))
# g3 <- geom_line(aes(y=Data$R10_adj, color="Real 10 year adj - yield",linetype="Real 10 year adj - yield", size="Real 10 year adj - yield"))
# g4 <- geom_line(aes(y=Data$R2_adj, color="Real 2 year adj - yield",linetype="Real 2 year adj - yield", size="Real 2 year adj - yield"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("Predicted 2-yr real yield","Predicted 10-yr real yield ", "Real 10 year adj - yield","Real 2 year adj - yield"), values=c( "Predicted 2-yr real yield"="blue", "Predicted 10-yr real yield "="red", "Real 10 year adj - yield"="red","Real 2 year adj - yield"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Predicted 2-yr real yield","Predicted 10-yr real yield ","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Predicted 2-yr real yield"=2,"Predicted 10-yr real yield "=2,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# size          <- scale_size_manual(" ", breaks=c("Predicted 2-yr real yield","Predicted 10-yr real yield ","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Predicted 2-yr real yield"=2,"Predicted 10-yr real yield "=2,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# title         <- ggtitle("Real 2-yr Predicted by Trend Real GDP per capita and ex-ante Real T-Bill")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 23, .5),1),limits = c(-3.5,4.5))
# 
# termdecomp3    <- termdecomp3 + g2 + g4 +hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# nberShade(termdecomp3) + yscale + size
```

### Return on Break-even Inflation: Actual vs. Expected {-}

```{r irpA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

irpA      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$inf_rpf , color="Expected Avg BEI return",linetype="Expected Avg BEI return", size="Expected Avg BEI return"))
g2 <- geom_line(aes(y=Data$inf_ret_bar, color="Avg BEI Return (t+1)",linetype="Avg BEI Return (t+1)",size="Avg BEI Return (t+1)"))
g3 <- geom_line(aes(y=Data$IRP10_adj*9, color="10-yr IRP yield-based",linetype="10-yr IRP yield-based", size="10-yr IRP yield-based"))
g4 <- geom_line(aes(y=Data$IRP10, color="10-yr IRP",linetype="10-yr IRP", size="10-yr IRP"))
hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Avg BEI Return (t+1)","Expected Avg BEI return", "10-yr IRP yield-based","10-yr IRP"), values=c( "Avg BEI Return (t+1)"="blue", "Expected Avg BEI return"="red", "10-yr IRP yield-based"="purple","10-yr IRP"="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Avg BEI Return (t+1)","Expected Avg BEI return","10-yr IRP yield-based","10-yr IRP"), values=c("Avg BEI Return (t+1)"=1,"Expected Avg BEI return"=2,"10-yr IRP yield-based"=1,"10-yr IRP"=1))
size          <- scale_size_manual(" ", breaks=c("Avg BEI Return (t+1)","Expected Avg BEI return","10-yr IRP yield-based","10-yr IRP"), values=c("Avg BEI Return (t+1)"=1,"Expected Avg BEI return"=1,"10-yr IRP yield-based"=1,"10-yr IRP"=1))
title         <- ggtitle("Return on Break-even Inflation: Actual vs. Expected")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.45, 0.25), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-8, 23, .5),1))

irpA    <- irpA + g1 +g2+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(irpA) + yscale + size
```

### Return on Real yields: Actual vs. Expected {-}

```{r rbrpA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rbrpA      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$r_rpf , color="Expected Avg Real return",linetype="Expected Avg Real return", size="Expected Avg Real return"))
g2 <- geom_line(aes(y=Data$r_ret_bar, color="Avg Real Return (t+1)",linetype="Avg Real Return (t+1)",size="Avg Real Return (t+1)"))
g3 <- geom_line(aes(y=Data$RBRPmpB10, color="Real 10 year adj - yield",linetype="Real 10 year adj - yield", size="Real 10 year adj - yield"))
g4 <- geom_line(aes(y=Data$R2_adj, color="Real 2 year adj - yield",linetype="Real 2 year adj - yield", size="Real 2 year adj - yield"))
hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Avg Real Return (t+1)","Expected Avg Real return", "Real 10 year adj - yield","Real 2 year adj - yield"), values=c( "Avg Real Return (t+1)"="blue", "Expected Avg Real return"="red", "Real 10 year adj - yield"="red","Real 2 year adj - yield"="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Avg Real Return (t+1)","Expected Avg Real return","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Avg Real Return (t+1)"=1,"Expected Avg Real return"=2,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
size          <- scale_size_manual(" ", breaks=c("Avg Real Return (t+1)","Expected Avg Real return","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Avg Real Return (t+1)"=1,"Expected Avg Real return"=1,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
title         <- ggtitle("Return on Real yields: Actual vs. Expected")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20, 23, 2),0))

rbrpA    <- rbrpA + g1 +g2+ hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(rbrpA) + yscale + size
```

```{r exp10ret, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exp10ret      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$IRPrx10 , color="10yr Inflation Risk Premium",linetype="10yr Inflation Risk Premium", size="10yr Inflation Risk Premium"))
# g2 <- geom_line(aes(y=Data$RBRPRXmpB10, color="10yr Real Bond Risk Premium",linetype="10yr Real Bond Risk Premium",size="10yr Real Bond Risk Premium"))
# g3 <- geom_line(aes(y=Data$rx10_BEI, color="10yr Breakeven Excess Return (t+1)",linetype="10yr Breakeven Excess Return (t+1)", size="10yr Breakeven Excess Return (t+1)"))
# g4 <- geom_line(aes(y=Data$rx10_R, color="10yr Real Excess Return (t+1)",linetype="10yr Real Excess Return (t+1)", size="10yr Real Excess Return (t+1)"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("10yr Real Bond Risk Premium","10yr Inflation Risk Premium", "10yr Breakeven Excess Return (t+1)","10yr Real Excess Return (t+1)"), values=c( "10yr Real Bond Risk Premium"="blue", "10yr Inflation Risk Premium"="red", "10yr Breakeven Excess Return (t+1)"="red","10yr Real Excess Return (t+1)"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("10yr Real Bond Risk Premium","10yr Inflation Risk Premium","10yr Breakeven Excess Return (t+1)","10yr Real Excess Return (t+1)"), values=c("10yr Real Bond Risk Premium"=1,"10yr Inflation Risk Premium"=1,"10yr Breakeven Excess Return (t+1)"=2,"10yr Real Excess Return (t+1)"=2))
# size          <- scale_size_manual(" ", breaks=c("10yr Real Bond Risk Premium","10yr Inflation Risk Premium","10yr Breakeven Excess Return (t+1)","10yr Real Excess Return (t+1)"), values=c("10yr Real Bond Risk Premium"=1,"10yr Inflation Risk Premium"=1,"10yr Breakeven Excess Return (t+1)"=1,"10yr Real Excess Return (t+1)"=1))
# title         <- ggtitle("Sources of Expected Excess Return on the 10-yr Treasury")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.550, 0.99), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-20, 25, 2),0))
# 
# exp10ret    <- exp10ret + g1 +g2+g3+g4+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(exp10ret) + yscale + size
```

```{r exp10ret2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exp10ret2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$IRPrx10+Data$RBRPRXmpB10 , color="10yr Expected Return",linetype="10yr Expected Return", size="10yr Expected Return"))
# g2 <- geom_line(aes(y=Data$rx10_BEI+Data$rx10_R, color="10yr Excess Return",linetype="10yr Excess Return",size="10yr Excess Return"))
# g3 <- geom_line(aes(y=Data$rx10_BEI, color="10yr Breakeven Excess Return (t+1)",linetype="10yr Breakeven Excess Return (t+1)", size="10yr Breakeven Excess Return (t+1)"))
# g4 <- geom_line(aes(y=Data$rx10_R, color="10yr Real Excess Return (t+1)",linetype="10yr Real Excess Return (t+1)", size="10yr Real Excess Return (t+1)"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("10yr Excess Return","10yr Expected Return", "10yr Breakeven Excess Return (t+1)","10yr Real Excess Return (t+1)"), values=c( "10yr Excess Return"="blue", "10yr Expected Return"="red", "10yr Breakeven Excess Return (t+1)"="red","10yr Real Excess Return (t+1)"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("10yr Excess Return","10yr Expected Return","10yr Breakeven Excess Return (t+1)","10yr Real Excess Return (t+1)"), values=c("10yr Excess Return"=1,"10yr Expected Return"=1,"10yr Breakeven Excess Return (t+1)"=2,"10yr Real Excess Return (t+1)"=2))
# size          <- scale_size_manual(" ", breaks=c("10yr Excess Return","10yr Expected Return","10yr Breakeven Excess Return (t+1)","10yr Real Excess Return (t+1)"), values=c("10yr Excess Return"=1,"10yr Expected Return"=1,"10yr Breakeven Excess Return (t+1)"=1,"10yr Real Excess Return (t+1)"=1))
# title         <- ggtitle("10-yr Treasury Expected Excess Return")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-15, 23, 2),0))
# 
# exp10ret2    <- exp10ret2 + g1 +g2+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(exp10ret2) + yscale + size
```

```{r exp5ret, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exp5ret      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$IRPrx5 , color="5yr Inflation Risk Premium",linetype="5yr Inflation Risk Premium", size="5yr Inflation Risk Premium"))
# g2 <- geom_line(aes(y=Data$RBRPRXmpB5, color="5yr Real Bond Risk Premium",linetype="5yr Real Bond Risk Premium",size="5yr Real Bond Risk Premium"))
# g3 <- geom_line(aes(y=Data$rx5_BEI, color="5yr Breakeven Excess Return (t+1)",linetype="5yr Breakeven Excess Return (t+1)", size="5yr Breakeven Excess Return (t+1)"))
# g4 <- geom_line(aes(y=Data$rx5_R, color="5yr Real Excess Return (t+1)",linetype="5yr Real Excess Return (t+1)", size="5yr Real Excess Return (t+1)"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("5yr Real Bond Risk Premium","5yr Inflation Risk Premium", "5yr Breakeven Excess Return (t+1)","5yr Real Excess Return (t+1)"), values=c( "5yr Real Bond Risk Premium"="blue", "5yr Inflation Risk Premium"="red", "5yr Breakeven Excess Return (t+1)"="red","5yr Real Excess Return (t+1)"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("5yr Real Bond Risk Premium","5yr Inflation Risk Premium","5yr Breakeven Excess Return (t+1)","5yr Real Excess Return (t+1)"), values=c("5yr Real Bond Risk Premium"=1,"5yr Inflation Risk Premium"=1,"5yr Breakeven Excess Return (t+1)"=2,"5yr Real Excess Return (t+1)"=2))
# size          <- scale_size_manual(" ", breaks=c("5yr Real Bond Risk Premium","5yr Inflation Risk Premium","5yr Breakeven Excess Return (t+1)","5yr Real Excess Return (t+1)"), values=c("5yr Real Bond Risk Premium"=1,"5yr Inflation Risk Premium"=1,"5yr Breakeven Excess Return (t+1)"=1,"5yr Real Excess Return (t+1)"=1))
# title         <- ggtitle("Sources of Expected Excess Return on the 5-yr Treasury")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-15, 23, 2),0))
# 
# exp5ret    <- exp5ret + g1 +g2+g3+g4+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(exp5ret) + yscale + size
```

```{r exp5ret2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exp5ret2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$IRPrx5+Data$RBRPRXmpB5 , color="5yr Expected Return",linetype="5yr Expected Return", size="5yr Expected Return"))
# g2 <- geom_line(aes(y=Data$rx5_BEI+Data$rx5_R, color="5yr Excess Return",linetype="5yr Excess Return",size="5yr Excess Return"))
# g3 <- geom_line(aes(y=Data$rx10_BEI, color="5yr Breakeven Excess Return (t+1)",linetype="5yr Breakeven Excess Return (t+1)", size="5yr Breakeven Excess Return (t+1)"))
# g4 <- geom_line(aes(y=Data$rx10_R, color="5yr Real Excess Return (t+1)",linetype="5yr Real Excess Return (t+1)", size="5yr Real Excess Return (t+1)"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("5yr Excess Return","5yr Expected Return", "5yr Breakeven Excess Return (t+1)","5yr Real Excess Return (t+1)"), values=c( "5yr Excess Return"="blue", "5yr Expected Return"="red", "5yr Breakeven Excess Return (t+1)"="red","5yr Real Excess Return (t+1)"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("5yr Excess Return","5yr Expected Return","5yr Breakeven Excess Return (t+1)","5yr Real Excess Return (t+1)"), values=c("5yr Excess Return"=1,"5yr Expected Return"=1,"5yr Breakeven Excess Return (t+1)"=2,"5yr Real Excess Return (t+1)"=2))
# size          <- scale_size_manual(" ", breaks=c("5yr Excess Return","5yr Expected Return","5yr Breakeven Excess Return (t+1)","5yr Real Excess Return (t+1)"), values=c("5yr Excess Return"=1,"5yr Expected Return"=1,"5yr Breakeven Excess Return (t+1)"=1,"5yr Real Excess Return (t+1)"=1))
# title         <- ggtitle("5-yr Treasury Expected Excess Return")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-15, 23, 1),0))
# 
# exp5ret2    <- exp5ret2 + g1 +g2+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(exp5ret2) + yscale + size
```

```{r exp3ret, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exp3ret      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$IRPrx3 , color="3yr Inflation Risk Premium",linetype="3yr Inflation Risk Premium", size="3yr Inflation Risk Premium"))
# g2 <- geom_line(aes(y=Data$RBRPRXmpB3, color="3yr Real Bond Risk Premium",linetype="3yr Real Bond Risk Premium",size="3yr Real Bond Risk Premium"))
# g3 <- geom_line(aes(y=Data$rx3_BEI, color="3yr Breakeven Excess Return (t+1)",linetype="3yr Breakeven Excess Return (t+1)", size="3yr Breakeven Excess Return (t+1)"))
# g4 <- geom_line(aes(y=Data$rx3_R, color="3yr Real Excess Return (t+1)",linetype="3yr Real Excess Return (t+1)", size="3yr Real Excess Return (t+1)"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("3yr Real Bond Risk Premium","3yr Inflation Risk Premium", "3yr Breakeven Excess Return (t+1)","3yr Real Excess Return (t+1)"), values=c( "3yr Real Bond Risk Premium"="blue", "3yr Inflation Risk Premium"="red", "3yr Breakeven Excess Return (t+1)"="red","3yr Real Excess Return (t+1)"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("3yr Real Bond Risk Premium","3yr Inflation Risk Premium","3yr Breakeven Excess Return (t+1)","3yr Real Excess Return (t+1)"), values=c("3yr Real Bond Risk Premium"=1,"3yr Inflation Risk Premium"=1,"3yr Breakeven Excess Return (t+1)"=2,"3yr Real Excess Return (t+1)"=2))
# size          <- scale_size_manual(" ", breaks=c("3yr Real Bond Risk Premium","3yr Inflation Risk Premium","3yr Breakeven Excess Return (t+1)","3yr Real Excess Return (t+1)"), values=c("3yr Real Bond Risk Premium"=1,"3yr Inflation Risk Premium"=1,"3yr Breakeven Excess Return (t+1)"=1,"3yr Real Excess Return (t+1)"=1))
# title         <- ggtitle("Sources of Expected Excess Return on the 3-yr Treasury")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1999-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.55, 0.99), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-15, 23, 1),0))
# 
# exp3ret    <- exp3ret + g1 +g2+g3+g4+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(exp3ret) + yscale + size
```

```{r exp3ret2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# exp3ret2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$IRPrx3+Data$RBRPRXmpB3 , color="3yr Expected Return",linetype="3yr Expected Return", size="3yr Expected Return"))
# g2 <- geom_line(aes(y=Data$rx3_BEI+Data$rx3_R, color="3yr Excess Return",linetype="3yr Excess Return",size="3yr Excess Return"))
# g3 <- geom_line(aes(y=Data$rx10_BEI, color="3yr Breakeven Excess Return (t+1)",linetype="3yr Breakeven Excess Return (t+1)", size="3yr Breakeven Excess Return (t+1)"))
# g4 <- geom_line(aes(y=Data$rx10_R, color="3yr Real Excess Return (t+1)",linetype="3yr Real Excess Return (t+1)", size="3yr Real Excess Return (t+1)"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("3yr Excess Return","3yr Expected Return", "3yr Breakeven Excess Return (t+1)","3yr Real Excess Return (t+1)"), values=c( "3yr Excess Return"="blue", "3yr Expected Return"="red", "3yr Breakeven Excess Return (t+1)"="red","3yr Real Excess Return (t+1)"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("3yr Excess Return","3yr Expected Return","3yr Breakeven Excess Return (t+1)","3yr Real Excess Return (t+1)"), values=c("3yr Excess Return"=1,"3yr Expected Return"=1,"3yr Breakeven Excess Return (t+1)"=2,"3yr Real Excess Return (t+1)"=2))
# size          <- scale_size_manual(" ", breaks=c("3yr Excess Return","3yr Expected Return","3yr Breakeven Excess Return (t+1)","3yr Real Excess Return (t+1)"), values=c("3yr Excess Return"=1,"3yr Expected Return"=1,"3yr Breakeven Excess Return (t+1)"=1,"3yr Real Excess Return (t+1)"=1))
# title         <- ggtitle("3-yr Treasury Expected Excess Return")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1998-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-15, 23, 1),0))
# 
# exp3ret2    <- exp3ret2 + g1 +g2+hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(exp3ret2) + yscale + size
```

```{r rsurvevrfire, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# rsurvevrfire      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$r_firetb_ksvm , color="Econometrician Predicted Real T-Bill yield",linetype="Econometrician Predicted Real T-Bill yield", size="Econometrician Predicted Real T-Bill yield"))
# g2 <- geom_line(aes(y=Data$r_survspf, color="Survey Expected Real T-Bill yield",linetype="Survey Expected Real T-Bill yield",size="Survey Expected Real T-Bill yield"))
# g3 <- geom_line(aes(y=Data$R10_adj, color="Real 10 year adj - yield",linetype="Real 10 year adj - yield", size="Real 10 year adj - yield"))
# g4 <- geom_line(aes(y=Data$R2_adj, color="Real 2 year adj - yield",linetype="Real 2 year adj - yield", size="Real 2 year adj - yield"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("Survey Expected Real T-Bill yield","Econometrician Predicted Real T-Bill yield", "Real 10 year adj - yield","Real 2 year adj - yield"), values=c( "Survey Expected Real T-Bill yield"="blue", "Econometrician Predicted Real T-Bill yield"="red", "Real 10 year adj - yield"="red","Real 2 year adj - yield"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Survey Expected Real T-Bill yield","Econometrician Predicted Real T-Bill yield","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Survey Expected Real T-Bill yield"=1,"Econometrician Predicted Real T-Bill yield"=1,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# size          <- scale_size_manual(" ", breaks=c("Survey Expected Real T-Bill yield","Econometrician Predicted Real T-Bill yield","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("Survey Expected Real T-Bill yield"=1,"Econometrician Predicted Real T-Bill yield"=1,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# title         <- ggtitle("Ex-ante Real T-Bill")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1980-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Survey of Professional Forecasters, Cieslak and Povala (2014), Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 23, .5),1),limits = c(-3.5,5.5))
# 
# rsurvevrfire    <- rsurvevrfire + g1 +g2 +hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(rsurvevrfire) + yscale + size
# 
# #ggsave("C:/Users/sabol/Google Drive/blogposts/rsurvrfire.jpg" ,height = 6.5,width = 11.5,units = "in")

```

```{r mp_rp, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

# mp_rp      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$r_survspf - Data$r_firetb_ksvm , color="Expected Forecasting Error about Monetary Policy",linetype="Expected Forecasting Error about Monetary Policy", size="Expected Forecasting Error about Monetary Policy"))
# g2 <- geom_line(aes(y=Data$annbps_ed4, color="ED4 return (t+1)",linetype="ED4 return (t+1)",size="ED4 return (t+1)"))
# g3 <- geom_line(aes(y=Data$R10_adj, color="Real 10 year adj - yield",linetype="Real 10 year adj - yield", size="Real 10 year adj - yield"))
# g4 <- geom_line(aes(y=Data$R2_adj, color="Real 2 year adj - yield",linetype="Real 2 year adj - yield", size="Real 2 year adj - yield"))
# hline         <- geom_hline(yintercept = 0 ,linetype="dashed")
# color         <- scale_color_manual(" ", breaks=c("ED4 return (t+1)","Expected Forecasting Error about Monetary Policy", "Real 10 year adj - yield","Real 2 year adj - yield"), values=c( "ED4 return (t+1)"="blue", "Expected Forecasting Error about Monetary Policy"="red", "Real 10 year adj - yield"="red","Real 2 year adj - yield"="blue"))
# linetype      <- scale_linetype_manual(" ", breaks=c("ED4 return (t+1)","Expected Forecasting Error about Monetary Policy","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("ED4 return (t+1)"=1,"Expected Forecasting Error about Monetary Policy"=1,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# size          <- scale_size_manual(" ", breaks=c("ED4 return (t+1)","Expected Forecasting Error about Monetary Policy","Real 10 year adj - yield","Real 2 year adj - yield"), values=c("ED4 return (t+1)"=1,"Expected Forecasting Error about Monetary Policy"=1,"Real 10 year adj - yield"=1,"Real 2 year adj - yield"=1))
# title         <- ggtitle("Expected Forecasting Error about Monetary Policy and Return on 1-yr Eurodollar Futures Contract")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1980-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.55, 0.99), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: Survey of Professional Forecasters, Cieslak and Povala (2014), Sabol (2015)")
# 
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-6, 23, .5),1))
# 
# mp_rp    <- mp_rp + g1 +g2 +hline + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs
# 
# nberShade(mp_rp) + yscale + size
```

### ISM and Treasury 10-yr Risk Premium: 1992- {-}

```{r ismtsy_PLOT, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ismtsy      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=(Data$ism-50)/8, color="ISM Man",linetype="ISM Man"))
g2 <- geom_line(aes(y=Data$tenyr_rpf+1, color="10-yr Risk Premium",linetype="10-yr Risk Premium"))
g3 <- geom_line(aes(y=Data$RBRP10/10, color="ISM Man",linetype="ISM Man"))
g4 <- geom_line(aes(y=durdivmbstogdp*3.57, color="ISM Man",linetype="ISM Man"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("10-yr Risk Premium","ISM Man","ISM Man","ISM Man"), values=c( "10-yr Risk Premium"="blue", "ISM Man"="red","ISM Man" = "red","ISM Man" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("10-yr Risk Premium","ISM Man","ISM Man","ISM Man"), values=c("10-yr Risk Premium"=1,"ISM Man"=1,"ISM Man"=2,"ISM Man"=1))
size          <- scale_size_manual(" ", breaks=c("10-yr Risk Premium","ISM Man","ISM Man","ISM Man"), values=c("10-yr Risk Premium"=2,"ISM Man"=2,"ISM Man"=2,"ISM Man"=2))
title         <- ggtitle("ISM and Treasury 10-yr Risk Premium")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, 10-yr Risk Premium is 10-yr less Trend NGDP + 1")

ismtsy <- ismtsy + g1 +g2+ color + linetype + size + title +text_options + Date_opts +leg_pos + sub_labs+ hline

nberShade(ismtsy)+ scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4, 4, .25),2),limits = c(-2.5,2.5)) 

```

### New Issue - Seasoned Spreads {-}

```{r otrspreads, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

otrspreads  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$h0, color="Corporates (Homer and Sylla, 1996)",linetype="Corporates (Homer and Sylla, 1996)"))
g2 <- geom_line(aes(y=Data$h1, color="Aa Public Utilities 1 (Conard and Frankena 1967)",linetype="Aa Public Utilities 1 (Conard and Frankena 1967)"))
g4 <- geom_line(aes(y=Data$h2, color="Aa Public Utilities 2 (Conard and Frankena 1967)",linetype="Aa Public Utilities 2 (Conard and Frankena 1967)"))
g5 <- geom_line(aes(y=Data$k1, color="Aa Corporates 1 (Conard and Frankena 1967)",linetype="Aa Corporates 1 (Conard and Frankena 1967)"))
g3 <- geom_line(aes(y=Data$m1, color="Aa Corporates 2 (Conard and Frankena 1967)",linetype="Aa Corporates 2 (Conard and Frankena 1967)"))
g6 <- geom_line(aes(y=Data$tenotrsp, color="10Y Treasuries",linetype="10Y Treasuries"))
g7 <- geom_line(aes(y=Data$fiveotrsp, color="5Y Treasuries",linetype="5Y Treasuries"))


color         <- scale_color_manual(" ", breaks=c("Corporates (Homer and Sylla, 1996)","Aa Public Utilities 1 (Conard and Frankena 1967)","Aa Corporates 2 (Conard and Frankena 1967)","Aa Public Utilities 2 (Conard and Frankena 1967)","Aa Corporates 1 (Conard and Frankena 1967)","10Y Treasuries","5Y Treasuries"), values=c( "Aa Public Utilities 1 (Conard and Frankena 1967)"="blue", "Corporates (Homer and Sylla, 1996)"="dark green","Aa Corporates 1 (Conard and Frankena 1967)" = "black","Aa Public Utilities 2 (Conard and Frankena 1967)" ="green","Aa Corporates 2 (Conard and Frankena 1967)"="red","10Y Treasuries" = "black","5Y Treasuries" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Corporates (Homer and Sylla, 1996)","Aa Public Utilities 1 (Conard and Frankena 1967)","Aa Corporates 2 (Conard and Frankena 1967)","Aa Public Utilities 2 (Conard and Frankena 1967)","Aa Corporates 1 (Conard and Frankena 1967)","10Y Treasuries","5Y Treasuries"), values=c("Aa Public Utilities 1 (Conard and Frankena 1967)"=1,"Corporates (Homer and Sylla, 1996)"=1,"Aa Corporates 1 (Conard and Frankena 1967)"=1,"Aa Public Utilities 2 (Conard and Frankena 1967)"=1,"Aa Corporates 2 (Conard and Frankena 1967)"=1,"10Y Treasuries"=1,"5Y Treasuries"=1))
size          <- scale_size_manual(" ", breaks=c("Corporates (Homer and Sylla, 1996)","Aa Public Utilities 1 (Conard and Frankena 1967)","Aa Corporates 2 (Conard and Frankena 1967)","Aa Public Utilities 2 (Conard and Frankena 1967)","Aa Corporates 1 (Conard and Frankena 1967)","10Y Treasuries","5Y Treasuries"), values=c("Aa Public Utilities 1 (Conard and Frankena 1967)"=2,"Corporates (Homer and Sylla, 1996)"=2,"Aa Corporates 1 (Conard and Frankena 1967)"=2,"Aa Public Utilities 2 (Conard and Frankena 1967)"=3,"Aa Corporates 2 (Conard and Frankena 1967)"=2,"10Y Treasuries"=2,"5Y Treasuries"=3))
title         <- ggtitle("New Issue - Seasoned Spreads")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1901-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.25), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Conard and Frankena (1967), Homer and Sylla (1996), Treasury, Federal Reserve")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-2, 2, .1),1),limits = c(-.8,1.3))

otrspreads <- otrspreads +g1+g3+g6+g7 + color +linetype +size + title + text_options + Date_opts +hline+leg_pos +sub_labs

nberShade(otrspreads) + yscale
```

### New Issue - Seasoned Spreads and De-trended Short-term Inflation Expectations {-}

```{r otrspreaddetrend, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

otrspreaddetrend  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$h0, color="Corporates (Homer and Sylla, 1996)",linetype="Corporates (Homer and Sylla, 1996)"))
g2 <- geom_line(aes(y=Data$infexpst_detrend/10, color="Short-term Inflation Expectations (de-trended)",linetype="Short-term Inflation Expectations (de-trended)"))
g4 <- geom_line(aes(y=Data$h2, color="Aa Public Utilities 2 (Conard and Frankena 1967)",linetype="Aa Public Utilities 2 (Conard and Frankena 1967)"))
g5 <- geom_line(aes(y=Data$k1, color="Aa Corporates 1 (Conard and Frankena 1967)",linetype="Aa Corporates 1 (Conard and Frankena 1967)"))
g3 <- geom_line(aes(y=Data$m1, color="Aa Corporates 2 (Conard and Frankena 1967)",linetype="Aa Corporates 2 (Conard and Frankena 1967)"))
g6 <- geom_line(aes(y=Data$tenotrsp, color="10Y Treasuries",linetype="10Y Treasuries"))
g7 <- geom_line(aes(y=Data$fiveotrsp, color="5Y Treasuries",linetype="5Y Treasuries"))


color         <- scale_color_manual(" ", breaks=c("Corporates (Homer and Sylla, 1996)","Short-term Inflation Expectations (de-trended)","Aa Corporates 2 (Conard and Frankena 1967)","Aa Public Utilities 2 (Conard and Frankena 1967)","Aa Corporates 1 (Conard and Frankena 1967)","10Y Treasuries","5Y Treasuries"), values=c( "Short-term Inflation Expectations (de-trended)"="red", "Corporates (Homer and Sylla, 1996)"="dark green","Aa Corporates 1 (Conard and Frankena 1967)" = "dark green","Aa Public Utilities 2 (Conard and Frankena 1967)" ="green","Aa Corporates 2 (Conard and Frankena 1967)"="dark green","10Y Treasuries" = "black","5Y Treasuries" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Corporates (Homer and Sylla, 1996)","Short-term Inflation Expectations (de-trended)","Aa Corporates 2 (Conard and Frankena 1967)","Aa Public Utilities 2 (Conard and Frankena 1967)","Aa Corporates 1 (Conard and Frankena 1967)","10Y Treasuries","5Y Treasuries"), values=c("Short-term Inflation Expectations (de-trended)"=1,"Corporates (Homer and Sylla, 1996)"=1,"Aa Corporates 1 (Conard and Frankena 1967)"=1,"Aa Public Utilities 2 (Conard and Frankena 1967)"=1,"Aa Corporates 2 (Conard and Frankena 1967)"=1,"10Y Treasuries"=1,"5Y Treasuries"=1))
size          <- scale_size_manual(" ", breaks=c("Corporates (Homer and Sylla, 1996)","Short-term Inflation Expectations (de-trended)","Aa Corporates 2 (Conard and Frankena 1967)","Aa Public Utilities 2 (Conard and Frankena 1967)","Aa Corporates 1 (Conard and Frankena 1967)","10Y Treasuries","5Y Treasuries"), values=c("Short-term Inflation Expectations (de-trended)"=2,"Corporates (Homer and Sylla, 1996)"=2,"Aa Corporates 1 (Conard and Frankena 1967)"=2,"Aa Public Utilities 2 (Conard and Frankena 1967)"=3,"Aa Corporates 2 (Conard and Frankena 1967)"=2,"10Y Treasuries"=2,"5Y Treasuries"=3))
title         <- ggtitle("New Issue - Seasoned Spreads and De-trended Short-term Inflation Expectations")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Conard and Frankena (1967), Homer and Sylla (1996), Treasury, Federal Reserve")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-.4, .8, .1),1),limits = c(-.4,.8))

otrspreaddetrend <- otrspreaddetrend +g3+g2+g7 + color +linetype +size + title + text_options + Date_opts +hline+leg_pos +sub_labs

nberShade(otrspreaddetrend) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/otrspreads.jpg" ,height = 6.5,width = 11.5,units = "in")

```

## Economic Data {-}

### Real GDP per capita {-}

```{r ngdpcapplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ngdpcap      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=log(Data$ngdpm*1000/Data$pop/Data$wpi*100), color="Real GDP per capita",linetype="Real GDP per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real GDP per capita"), values=c( "Total Construction-to-GDP"="blue", "Real GDP per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real GDP per capita"), values=c("Total Construction-to-GDP"=1,"Real GDP per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real GDP per capita"), values=c("Total Construction-to-GDP"=2,"Real GDP per capita"=2))
title         <- ggtitle("Real GDP per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1800-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: in logs, Nominal GDP per capita deflated by WPI",caption = "@capitalmarketz")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(log(Data$ngdpm*1000/Data$pop/Data$wpi*100),na.rm = TRUE), max(log(Data$ngdpm*1000/Data$pop/Data$wpi*100),na.rm = TRUE), .25),2))
figure_ngdpcap <- figure_ngdpcap + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ngdpcap) + yscale
```

### Decomposition of 10-yr Annualized Real GDP per capita{-}

```{r rgdp_decomp_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rgdp_decomp_plot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_empl_10_ann_hh, color="Productivity",linetype="Productivity"))
g2 <- geom_line(aes(y=Data$rgdp_pop_10_ann_hh, color="RGDP per capita",linetype="RGDP per capita"))
g4 <- geom_line(aes(y=Data$lf_pop_10_ann_hh, color="Labor Force growth",linetype="Labor Force growth"))
g5 <- geom_line(aes(y=Data$empl_pop_10_ann_hh, color="Employment-Pop ratio growth",linetype="Employment-Pop ratio growth"))
g3 <- geom_line(aes(y=Data$empl_lf_10_ann_hh, color="Employment rate growth",linetype="Employment rate growth"))
g6 <- geom_line(aes(y=Data$lfpr, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Productivity","RGDP per capita","Employment rate growth","Labor Force growth","Employment-Pop ratio growth","ZAF","AUS"), values=c( "RGDP per capita"="blue", "Productivity"="red","Employment-Pop ratio growth" = "purple","Labor Force growth" ="black","Employment rate growth"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Productivity","RGDP per capita","Employment rate growth","Labor Force growth","Employment-Pop ratio growth","ZAF","AUS"), values=c("RGDP per capita"=1,"Productivity"=1,"Employment-Pop ratio growth"=1,"Labor Force growth"=1,"Employment rate growth"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Productivity","RGDP per capita","Employment rate growth","Labor Force growth","Employment-Pop ratio growth","ZAF","AUS"), values=c("RGDP per capita"=2,"Productivity"=2,"Employment-Pop ratio growth"=2,"Labor Force growth"=3,"Employment rate growth"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Decomposition of 10-yr Annualized Real GDP per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1962-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5, 240, .5),2))

rgdp_decomp_plot <- rgdp_decomp_plot +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(rgdp_decomp_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/rgdp_decomp.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Decomposition of 10-yr Annualized Real GDP per capita: 1990- {-}

```{r rgdp_decomp2_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

rgdp_decomp2_plot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$rgdp_empl_10_ann_hh, color="Productivity",linetype="Productivity"))
g2 <- geom_line(aes(y=Data$rgdp_pop_10_ann_hh, color="RGDP per capita",linetype="RGDP per capita"))
g4 <- geom_line(aes(y=Data$lf_pop_10_ann_hh, color="Labor Force growth",linetype="Labor Force growth"))
g5 <- geom_line(aes(y=Data$empl_pop_10_ann_hh, color="Employment-Pop ratio growth",linetype="Employment-Pop ratio growth"))
g3 <- geom_line(aes(y=Data$empl_lf_10_ann_hh, color="Employment rate growth",linetype="Employment rate growth"))
g6 <- geom_line(aes(y=Data$lfpr, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)


color         <- scale_color_manual(" ", breaks=c("Productivity","RGDP per capita","Employment rate growth","Labor Force growth","Employment-Pop ratio growth","ZAF","AUS"), values=c( "RGDP per capita"="blue", "Productivity"="red","Employment-Pop ratio growth" = "purple","Labor Force growth" ="black","Employment rate growth"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Productivity","RGDP per capita","Employment rate growth","Labor Force growth","Employment-Pop ratio growth","ZAF","AUS"), values=c("RGDP per capita"=1,"Productivity"=1,"Employment-Pop ratio growth"=1,"Labor Force growth"=1,"Employment rate growth"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Productivity","RGDP per capita","Employment rate growth","Labor Force growth","Employment-Pop ratio growth","ZAF","AUS"), values=c("RGDP per capita"=2,"Productivity"=2,"Employment-Pop ratio growth"=2,"Labor Force growth"=3,"Employment rate growth"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Decomposition of 10-yr Annualized Real GDP per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.35), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Black vertical line is January 2016")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5, 240, .25),2),limits = c(-1.5,2.5))

rgdp_decomp2_plot <- rgdp_decomp2_plot +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline + vline

nberShade(rgdp_decomp2_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/rgdp_decomp2.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Real Personal Income per capita{-}

```{r personalincplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_personalinc      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$pi*1000/Data$pop/Data$cpi*100, color="Real Personal Income per capita",linetype="Real Personal Income per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real Personal Income per capita"), values=c( "Total Construction-to-GDP"="blue", "Real Personal Income per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real Personal Income per capita"), values=c("Total Construction-to-GDP"=1,"Real Personal Income per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real Personal Income per capita"), values=c("Total Construction-to-GDP"=2,"Real Personal Income per capita"=2))
title         <- ggtitle("Real Personal Income per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, Nominal Personal Income per capita deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$pi*1000/Data$pop/Data$cpi*100,na.rm = TRUE), max(Data$pi*1000/Data$pop/Data$cpi*100,na.rm = TRUE), 100),0))
figure_personalinc <- figure_personalinc + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_personalinc) + yscale
```

### Real Personal Income Ex Transfer Receipts per capita {-}

```{r personalincplot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_personalinc_x_transfers      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$pi_x_tp*1000/Data$pop/Data$cpi*100, color="Real Personal Income Ex Transfer Receipts per capita",linetype="Real Personal Income Ex Transfer Receipts per capita"))
g2 <- geom_line(aes(y=Data$dpi_x_tp*1000/Data$pop/Data$cpi*100, color="Real Disposable Personal Income Ex Transfer Receipts per capita",linetype="Real Disposable Personal Income Ex Transfer Receipts per capita"))

color         <- scale_color_manual(" ", breaks=c("Real Disposable Personal Income Ex Transfer Receipts per capita","Real Personal Income Ex Transfer Receipts per capita"), values=c( "Real Disposable Personal Income Ex Transfer Receipts per capita"="blue", "Real Personal Income Ex Transfer Receipts per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Disposable Personal Income Ex Transfer Receipts per capita","Real Personal Income Ex Transfer Receipts per capita"), values=c("Real Disposable Personal Income Ex Transfer Receipts per capita"=1,"Real Personal Income Ex Transfer Receipts per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Real Disposable Personal Income Ex Transfer Receipts per capita","Real Personal Income Ex Transfer Receipts per capita"), values=c("Real Disposable Personal Income Ex Transfer Receipts per capita"=2,"Real Personal Income Ex Transfer Receipts per capita"=2))
title         <- ggtitle("Real Personal Income Ex Transfer Receipts per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1929-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Nominal Personal Income per capita deflated by CPI")
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$pi*1000/Data$pop/Data$cpi*100,na.rm = TRUE), max(Data$pi*1000/Data$pop/Data$cpi*100,na.rm = TRUE), 100),0))
figure_personalinc_x_transfers <- figure_personalinc_x_transfers + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_personalinc_x_transfers) + yscale 
#ggsave("C:/Users/sabol/Google Drive/blogposts/personalincome1.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Real Personal Income Ex Transfer Receipts per capita: 1990 to the present{-}

```{r personalincplot2s, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_personalinc_x_transfers2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$pi_x_tp*1000/Data$pop/Data$cpi*100, color="Real Personal Income Ex Transfer Receipts per capita",linetype="Real Personal Income Ex Transfer Receipts per capita"))
g2 <- geom_line(aes(y=Data$dpi_x_tp*1000/Data$pop/Data$cpi*100, color="Real Disposable Personal Income Ex Transfer Receipts per capita",linetype="Real Disposable Personal Income Ex Transfer Receipts per capita"))

color         <- scale_color_manual(" ", breaks=c("Real Disposable Personal Income Ex Transfer Receipts per capita","Real Personal Income Ex Transfer Receipts per capita"), values=c( "Real Disposable Personal Income Ex Transfer Receipts per capita"="blue", "Real Personal Income Ex Transfer Receipts per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Disposable Personal Income Ex Transfer Receipts per capita","Real Personal Income Ex Transfer Receipts per capita"), values=c("Real Disposable Personal Income Ex Transfer Receipts per capita"=1,"Real Personal Income Ex Transfer Receipts per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Real Disposable Personal Income Ex Transfer Receipts per capita","Real Personal Income Ex Transfer Receipts per capita"), values=c("Real Disposable Personal Income Ex Transfer Receipts per capita"=2,"Real Personal Income Ex Transfer Receipts per capita"=2))
title         <- ggtitle("Real Personal Income Ex Transfer Receipts per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Nominal Personal Income per capita deflated by CPI; Black line denotes Jan/2016")
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$pi*1000/Data$pop/Data$cpi*100,na.rm = TRUE), max(Data$pi*1000/Data$pop/Data$cpi*100,na.rm = TRUE), 100),0),limits = c(820,1620))
figure_personalinc_x_transfers2 <- figure_personalinc_x_transfers2 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + vline

nberShade(figure_personalinc_x_transfers2) + yscale 
#ggsave("C:/Users/sabol/Google Drive/blogposts/figure_personalinc_x_transfers2.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Real Personal Income per capita {-}

```{r personalincplot3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

personalincplot3  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$pi_interestincome/Data$cpi*100/Data$pop*1000, color="Interest Income",linetype="Interest Income"))
g2 <- geom_line(aes(y=Data$pi_dividends/Data$cpi*100/Data$pop*1000, color="Dividend Income",linetype="Dividend Income"))
g4 <- geom_line(aes(y=Data$pi_proprietorsinc/Data$cpi*100/Data$pop*1000, color="Proprietors' income",linetype="Proprietors' income"))
g5 <- geom_line(aes(y=Data$pi_transferreceipts/Data$cpi*100/Data$pop*1000, color="Transfer Receipts",linetype="Transfer Receipts"))
g3 <- geom_line(aes(y=Data$pi_rentinc/Data$cpi*100/Data$pop*1000, color="Rental Income",linetype="Rental Income"))
g6 <- geom_line(aes(y=Data$zaf_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Interest Income","Dividend Income","Rental Income","Proprietors' income","Transfer Receipts","ZAF","AUS"), values=c( "Dividend Income"="blue", "Interest Income"="red","Transfer Receipts" = "purple","Proprietors' income" ="black","Rental Income"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Interest Income","Dividend Income","Rental Income","Proprietors' income","Transfer Receipts","ZAF","AUS"), values=c("Dividend Income"=1,"Interest Income"=1,"Transfer Receipts"=1,"Proprietors' income"=1,"Rental Income"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Interest Income","Dividend Income","Rental Income","Proprietors' income","Transfer Receipts","ZAF","AUS"), values=c("Dividend Income"=2,"Interest Income"=2,"Transfer Receipts"=2,"Proprietors' income"=3,"Rental Income"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Real Personal Income per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 240, 20),0))

personalincplot3 <- personalincplot3 +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(personalincplot3) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/personalincomedecomp.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Sources of Real Personal Income per capita {-}

```{r personalincplot3s, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

personalincplot3s  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$pi_interestincome/Data$cpi*100/Data$pop*1000, color="Interest Income",linetype="Interest Income"))
g2 <- geom_line(aes(y=Data$pi_dividends/Data$cpi*100/Data$pop*1000, color="Dividend Income",linetype="Dividend Income"))
g4 <- geom_line(aes(y=Data$pi_proprietorsinc/Data$cpi*100/Data$pop*1000, color="Proprietors' income",linetype="Proprietors' income"))
g5 <- geom_line(aes(y=Data$pi_transferreceipts/Data$cpi*100/Data$pop*1000, color="Transfer Receipts",linetype="Transfer Receipts"))
g3 <- geom_line(aes(y=Data$pi_rentinc/Data$cpi*100/Data$pop*1000, color="Rental Income",linetype="Rental Income"))
g6 <- geom_line(aes(y=Data$zaf_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Interest Income","Dividend Income","Rental Income","Proprietors' income","Transfer Receipts","ZAF","AUS"), values=c( "Dividend Income"="blue", "Interest Income"="red","Transfer Receipts" = "purple","Proprietors' income" ="black","Rental Income"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Interest Income","Dividend Income","Rental Income","Proprietors' income","Transfer Receipts","ZAF","AUS"), values=c("Dividend Income"=1,"Interest Income"=1,"Transfer Receipts"=1,"Proprietors' income"=1,"Rental Income"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Interest Income","Dividend Income","Rental Income","Proprietors' income","Transfer Receipts","ZAF","AUS"), values=c("Dividend Income"=2,"Interest Income"=2,"Transfer Receipts"=2,"Proprietors' income"=3,"Rental Income"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Sources of Real Personal Income per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Black vertical line denotes Jan/2016")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 240, 20),0))

personalincplot3s <- personalincplot3s +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(personalincplot3s) + yscale + vline

#ggsave("C:/Users/sabol/Google Drive/blogposts/personalincomedecomps.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Real Business Sales per capita {-}

```{r bsalesplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figurebsales      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$bsales*1000/Data$pop/Data$cpi*100, color="Real Business Sales per capita",linetype="Real Business Sales per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real Business Sales per capita"), values=c( "Total Construction-to-GDP"="blue", "Real Business Sales per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real Business Sales per capita"), values=c("Total Construction-to-GDP"=1,"Real Business Sales per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real Business Sales per capita"), values=c("Total Construction-to-GDP"=2,"Real Business Sales per capita"=2))
title         <- ggtitle("Real Business Sales per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1937-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none") 
sub_labs <- labs(subtitle="Capital Markets Data, Business Sales deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$bsales*1000/Data$pop/Data$cpi*100,na.rm = TRUE), max(Data$bsales*1000/Data$pop/Data$cpi*100,na.rm = TRUE), 100),0))
figurebsales <- figurebsales + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figurebsales) + yscale
```

### Business Inventories-to-Sales Ratio {-}

```{r bus_inv_to_salesplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figurebus_inv_to_sales      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$bus_inv_to_sales, color="Real Business Sales per capita",linetype="Real Business Sales per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real Business Sales per capita"), values=c( "Total Construction-to-GDP"="blue", "Real Business Sales per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real Business Sales per capita"), values=c("Total Construction-to-GDP"=1,"Real Business Sales per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real Business Sales per capita"), values=c("Total Construction-to-GDP"=2,"Real Business Sales per capita"=2))
title         <- ggtitle("Business Inventories-to-Sales Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1958-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none") 
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$bus_inv_to_sales,na.rm = TRUE), max(Data$bus_inv_to_sales,na.rm = TRUE), .05),2))
figurebus_inv_to_sales <- figurebus_inv_to_sales + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figurebus_inv_to_sales) + yscale
```

### Real Retail Sales per capita {-}

```{r rsalesplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figurersales      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$rsales*1000/Data$pop/Data$cpi*100, color="Real Retail Sales per capita",linetype="Real Retail Sales per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real Retail Sales per capita"), values=c( "Total Construction-to-GDP"="blue", "Real Retail Sales per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real Retail Sales per capita"), values=c("Total Construction-to-GDP"=1,"Real Retail Sales per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real Retail Sales per capita"), values=c("Total Construction-to-GDP"=2,"Real Retail Sales per capita"=2))
title         <- ggtitle("Real Retail Sales per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1914-12-01"), as.Date("2021-12-01")), date_breaks = "7 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position= "none") 
sub_labs <- labs(subtitle="Capital Markets Data, Business Sales deflated by CPI")
vline <- geom_vline(xintercept = as.Date("1918-01-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1968-01-01"),show.legend = TRUE)
vline3 <- geom_vline(xintercept = as.Date("1958-01-01"),show.legend = TRUE)
vline4 <- geom_vline(xintercept = as.Date("2009-01-01"),show.legend = TRUE)

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$rsales*1000/Data$pop/Data$cpi*100,na.rm = TRUE), max(Data$rsales*1000/Data$pop/Data$cpi*100,na.rm = TRUE), 50),0))
figurersales <- figurersales + g1 +vline+vline2+vline3+vline4+ color +linetype +size + title +text_options + Date_opts +leg_pos

figurersales2 <- nberShade(figurersales) + bbc_style() + yscale + leg_pos

finalise_plot(plot_name = figurersales2,
              source = "Solid lines denote global pandemics; Retail Sales deflated by CPI",
              save_filepath = "C:/Users/sabol/Google Drive/blogposts/figurersales_bbc.pdf",
              logo_image_path = "C:/Users/sabol/Google Drive/blogposts/CMDMDlogowatermark.png",
              width_pixels = 640,
              height_pixels = 550)

```

### Real Retail Sales per capita: 1990 to the present{-}

```{r rsalesplot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figurersales_recent      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$rsales*1000/Data$pop/Data$cpi*100, color="Real Retail Sales per capita",linetype="Real Retail Sales per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real Retail Sales per capita"), values=c( "Total Construction-to-GDP"="blue", "Real Retail Sales per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real Retail Sales per capita"), values=c("Total Construction-to-GDP"=1,"Real Retail Sales per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real Retail Sales per capita"), values=c("Total Construction-to-GDP"=2,"Real Retail Sales per capita"=2))
title         <- ggtitle("Real Retail Sales per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position= "none") 
sub_labs <- labs(subtitle="Capital Markets Data, Business Sales deflated by CPI")
# vline <- geom_vline(xintercept = as.Date("1918-01-01"),show.legend = TRUE)
# vline2 <- geom_vline(xintercept = as.Date("1968-01-01"),show.legend = TRUE)
# vline3 <- geom_vline(xintercept = as.Date("1958-01-01"),show.legend = TRUE)
# vline4 <- geom_vline(xintercept = as.Date("2009-01-01"),show.legend = TRUE)

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(420, max(Data$rsales*1000/Data$pop/Data$cpi*100,na.rm = TRUE), 20),0),limits = c(420,640))
figurersales_recent <- figurersales_recent + g1 +vline+ color +linetype +size + title +text_options + Date_opts +leg_pos

figurersales_recent2 <- nberShade(figurersales_recent) + bbc_style() + yscale + leg_pos

finalise_plot(plot_name = figurersales_recent2,
              source = "Solid lines denote global pandemics; Retail Sales deflated by CPI",
              save_filepath = "C:/Users/sabol/Google Drive/blogposts/figurersales_recent_bbc.pdf",
              logo_image_path = "C:/Users/sabol/Google Drive/blogposts/CMDMDlogowatermark.png",
              width_pixels = 640,
              height_pixels = 550)

```

### Real New Orders for Durable Goods per capita {-}

```{r figurenodur, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figurenodur      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$no_dur*1000/Data$pop/Data$cpi*100, color="Real New Orders for Durable Goods per capita",linetype="Real New Orders for Durable Goods per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real New Orders for Durable Goods per capita"), values=c( "Total Construction-to-GDP"="blue", "Real New Orders for Durable Goods per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real New Orders for Durable Goods per capita"), values=c("Total Construction-to-GDP"=1,"Real New Orders for Durable Goods per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real New Orders for Durable Goods per capita"), values=c("Total Construction-to-GDP"=2,"Real New Orders for Durable Goods per capita"=2))
title         <- ggtitle("Real New Orders for Durable Goods per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none") 
sub_labs <- labs(subtitle="Capital Markets Data, New Orders deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000, 50),0))
figurenodur <- figurenodur + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs 

nberShade(figurenodur) +yscale
```

### Real New Orders for Durable Goods per capita: 1990 to the present {-}

```{r figurenodur2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figurenodur2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$no_dur*1000/Data$pop/Data$cpi*100, color="Real New Orders for Durable Goods per capita",linetype="Real New Orders for Durable Goods per capita"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Real New Orders for Durable Goods per capita"), values=c( "Total Construction-to-GDP"="blue", "Real New Orders for Durable Goods per capita"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Real New Orders for Durable Goods per capita"), values=c("Total Construction-to-GDP"=1,"Real New Orders for Durable Goods per capita"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Real New Orders for Durable Goods per capita"), values=c("Total Construction-to-GDP"=2,"Real New Orders for Durable Goods per capita"=2))
title         <- ggtitle("Real New Orders for Durable Goods per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none") 
sub_labs <- labs(subtitle="Capital Markets Data, New Orders deflated by CPI; black line denotes Jan/2016")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000, 25),0),limits = c(175,450))
figurenodur2 <- figurenodur2 + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + vline

nberShade(figurenodur2) +yscale


```

### Consumer Credit-to-GDP {-}

```{r ed2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$auto_credit/Data$ngdpm, color="Auto Credit-to-GDP",linetype="Auto Credit-to-GDP"))
g2 <- geom_line(aes(y=Data$cons_credit/Data$ngdpm, color="Consumer Credit-to-GDP",linetype="Consumer Credit-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Consumer Credit-to-GDP","Auto Credit-to-GDP"), values=c( "Consumer Credit-to-GDP"="blue", "Auto Credit-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Consumer Credit-to-GDP","Auto Credit-to-GDP"), values=c("Consumer Credit-to-GDP"=1,"Auto Credit-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Consumer Credit-to-GDP","Auto Credit-to-GDP"), values=c("Consumer Credit-to-GDP"=2,"Auto Credit-to-GDP"=2))
title         <- ggtitle("Consumer Credit-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1928-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.10, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$cons_credit/Data$ngdpm,na.rm = TRUE), max(Data$cons_credit/Data$ngdpm,na.rm = TRUE), .2),2))
figure_ed2 <- figure_ed2 + g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed2) + yscale
```

### Inflation and Federal Funds Rate {-}

```{r fin_rep, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_fin_rep      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$cpi_d12 , color="Inflation",linetype="Inflation"))
# g2 <- geom_line(aes(y=Data$ten_yr_long, color="Federal Funds Rate",linetype="Federal Funds Rate"))
g2 <- geom_line(aes(y=Data$fedfunds, color="Federal Funds Rate",linetype="Federal Funds Rate"))

color         <- scale_color_manual(" ", breaks=c("Federal Funds Rate","Inflation"), values=c( "Federal Funds Rate"="blue", "Inflation"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Federal Funds Rate","Inflation"), values=c("Federal Funds Rate"=1,"Inflation"=1))
size          <- scale_size_manual(" ", breaks=c("Federal Funds Rate","Inflation"), values=c("Federal Funds Rate"=2,"Inflation"=2))
title         <- ggtitle("Inflation and Federal Funds Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1926-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-16,28,by = 2),0),limits = c(-14,22))
figure_fin_rep <- figure_fin_rep + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs+hline

nberShade(figure_fin_rep) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/fin_rep.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Inflation and Federal Funds Rate: 1990 to the present {-}

```{r fin_repshort, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_fin_repshort      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$cpi_d12 , color="Inflation",linetype="Inflation"))
# g2 <- geom_line(aes(y=Data$ten_yr_long, color="Federal Funds Rate",linetype="Federal Funds Rate"))
g2 <- geom_line(aes(y=Data$fedfunds, color="Federal Funds Rate",linetype="Federal Funds Rate"))
vline <- geom_vline(xintercept = as.Date("2016-01-01"),show.legend = TRUE)

color         <- scale_color_manual(" ", breaks=c("Federal Funds Rate","Inflation"), values=c( "Federal Funds Rate"="blue", "Inflation"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Federal Funds Rate","Inflation"), values=c("Federal Funds Rate"=1,"Inflation"=1))
size          <- scale_size_manual(" ", breaks=c("Federal Funds Rate","Inflation"), values=c("Federal Funds Rate"=2,"Inflation"=2))
title         <- ggtitle("Inflation and Federal Funds Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; black line denotes Jan/2016")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-16,28,by = .5),1),limits = c(-2.5,7.5))
figure_fin_repshort <- figure_fin_repshort + g1 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs+hline

nberShade(figure_fin_repshort) + yscale 

#ggsave("C:/Users/sabol/Google Drive/blogposts/fin_repshort.jpg" ,height = 6.5,width = 11.5,units = "in")

```

## Labor Markets {-}

### Unemployment Rate {-}

```{r urates, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_urates      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$urate, color="Unemployment Rate",linetype="Unemployment Rate"))
g2 <- geom_line(aes(y=Data$quit_rate, color="Quits Rate",linetype="Quits Rate"))

color         <- scale_color_manual(" ", breaks=c("Quits Rate","Unemployment Rate"), values=c( "Quits Rate"="blue", "Unemployment Rate"="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Quits Rate","Unemployment Rate"), values=c("Quits Rate"=1,"Unemployment Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Quits Rate","Unemployment Rate"), values=c("Quits Rate"=2,"Unemployment Rate"=2))
title         <- ggtitle("Unemployment Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1928-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$urate,na.rm = TRUE), max(Data$urate,na.rm = TRUE), 1),0))
figure_urates <- figure_urates +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_urates) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/unemploymentrates.jpg" ,height = 6.5,width = 11.5,units = "in")

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")


```

### Job-finding and Quits Rate {-}

```{r ed9, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed9      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("rate")
g1 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g2 <- geom_line(aes(y=Data$quit_rate, color="Quits Rate",linetype="Quits Rate"))

color         <- scale_color_manual(" ", breaks=c("Quits Rate","Job-finding Rate"), values=c( "Quits Rate"="blue", "Job-finding Rate"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Quits Rate","Job-finding Rate"), values=c("Quits Rate"=1,"Job-finding Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Quits Rate","Job-finding Rate"), values=c("Quits Rate"=2,"Job-finding Rate"=2))
title         <- ggtitle("Job-finding and Quits Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1911-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank())
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER, JOLTS")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$finding_rate,na.rm = TRUE), max(Data$finding_rate,na.rm = TRUE), 1),0))
figure_ed9 <- figure_ed9 + g2 +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed9) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

# for_total_net_share <- Data$finding_rate
# corp_eq_gdp <- Data$quit_rate
# 
# tail_dates <- index(tail(na.omit(xts(Data$finding_rate,order.by = as.Date(Data$Date))),1))
# 
# figure_LM_A1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
# g1 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
# g2 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
# 
# color         <- scale_color_manual(" ", breaks=c("Quit Rate","Job-finding Rate"), values=c( "Quit Rate"="blue", "Job-finding Rate"="red"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Quit Rate","Job-finding Rate"), values=c("Quit Rate"=1,"Job-finding Rate"=1))
# size          <- scale_size_manual(" ", breaks=c("Quit Rate","Job-finding Rate"), values=c("Quit Rate"=2,"Job-finding Rate"=2))
# title         <- ggtitle("Job-finding and Quits Rate")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1911-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data; Sources: BLS, NBER, JOLTS",caption = "@capitalmarketz")
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(for_total_net_share,na.rm = TRUE), max(for_total_net_share,na.rm = TRUE), 1),0))
# 
# tail_1 <- for_total_net_share %>% na.omit() %>% tail(1)
# 
# gpoints_1 <- geom_point(data = Data,aes(x=tail_dates,y = round(for_total_net_share %>% na.omit() %>% tail(1),2)) , size=2,color="red",shape=21,fill="red")
# 
# gtext_1 <- geom_text(y =for_total_net_share %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(for_total_net_share %>% na.omit() %>% tail(1),1)),color="red",hjust=0,size=4,nudge_x = 75,nudge_y = -14)
# 
# gpoints_2 <- geom_point(data = D,aes(x=tail_dates,y= round(corp_eq_gdp %>% na.omit() %>% tail(1),2)) , size=2,color="blue",shape=21,fill="blue")
# 
# gtext_2 <- geom_text(y =corp_eq_gdp %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(corp_eq_gdp %>% na.omit() %>% tail(1),1)),color="blue",hjust=0,size=4,nudge_x = 75,nudge_y = -14)
# 
# hline         <- geom_hline(yintercept = 0, linetype="dashed")
# 
# figure_LM_A1 <- figure_LM_A1 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +gpoints_1 + gtext_2 +gpoints_2 + gtext_1 +hline
# 
# nberShade(figure_LM_A1) +yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/jfandquits1.jpg" ,height = 6.5,width = 11.5,units = "in")



```

###  Quits Rate {-}

```{r ed10, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed10      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("rate")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$quit_rate, color="Quits Rate",linetype="Quits Rate"))

color         <- scale_color_manual(" ", breaks=c("Quits Rate","Auto Sales"), values=c( "Quits Rate"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Quits Rate","Auto Sales"), values=c("Quits Rate"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Quits Rate","Auto Sales"), values=c("Quits Rate"=2,"Auto Sales"=2))
title         <- ggtitle("Quits Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1911-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER, JOLTS")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$quit_rate,na.rm = TRUE), max(Data$quit_rate,na.rm = TRUE), 1),0))
figure_ed10 <- figure_ed10 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed10) + yscale

```

###  Labor Demand and Wage Growth: 1909 - 1949 {-}

```{r ed11, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ed12      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=corpbtogdp, color="Corporate Bond Issuance-to-GDP",linetype="Corporate Bond Issuance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Corporate Bond Issuance-to-GDP" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Corporate Bond Issuance-to-GDP"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Corporate Bond Issuance-to-GDP"=2,"Wage Growth"=3))
title         <- ggtitle("Labor Demand and Wage Growth (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1909-12-01"), as.Date("1949-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.25), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER, JOLTS, Wage Growth has been divided by 2")

ed12 <- ed12 +g1+ g2 +g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(ed12) + ylim(range(-6.5,12.5))
```

### Labor Demand and Wage Growth: 1950 - 1986  {-}

```{r ed12, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ed12      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=corpbtogdp, color="Corporate Bond Issuance-to-GDP",linetype="Corporate Bond Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Corporate Bond Issuance-to-GDP" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Corporate Bond Issuance-to-GDP"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Corporate Bond Issuance-to-GDP"=2,"Wage Growth"=3))
title         <- ggtitle("Labor Demand and Wage Growth (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1949-12-01"), as.Date("1986-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER, JOLTS, Wage Growth has been divided by 2")

ed12 <- ed12 +g1+ g2 +g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ed12) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 6, .5),1),limits = c(0,6)) 
```

###  Labor Demand and Wage Growth: 1984- {-}

```{r labordemandpt3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
labordemandpt3      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=corpbtogdp, color="Corporate Bond Issuance-to-GDP",linetype="Corporate Bond Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Corporate Bond Issuance-to-GDP" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Corporate Bond Issuance-to-GDP"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Corporate Bond Issuance-to-GDP","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Corporate Bond Issuance-to-GDP"=2,"Wage Growth"=3))
title         <- ggtitle("Labor Demand and Wage Growth (part 3)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1983-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: BLS, NBER, JOLTS",caption = "@capitalmarketz")


tail_1 <- Data$quit_rate %>% na.omit() %>% tail(1)

tail_dates_1 <- index(tail(na.omit(xts(Data$quit_rate,order.by = as.Date(Data$Date))),1))
tail_dates_2 <- index(tail(na.omit(xts(Data$finding_rate,order.by = as.Date(Data$Date))),1))
tail_dates_3 <- index(tail(na.omit(xts(Data$wages_d12,order.by = as.Date(Data$Date))),1))


gpoints_1 <- geom_point(data = Data,aes(x=tail_dates_1,y = round(Data$quit_rate %>% na.omit() %>% tail(1),2)) , size=2,color="red",shape=21,fill="red")

gtext_1 <- geom_text(y =Data$quit_rate %>% na.omit() %>% tail(1),aes(x=tail_dates_1,label = round(Data$quit_rate %>% na.omit() %>% tail(1),2)),color="red",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_2 <- geom_point(data = D,aes(x=tail_dates_2,y= round(Data$finding_rate %>% na.omit() %>% tail(1),2)) , size=2,color="blue",shape=21,fill="blue")

gtext_2 <- geom_text(y =Data$finding_rate %>% na.omit() %>% tail(1),aes(x=tail_dates_2,label = round(Data$finding_rate %>% na.omit() %>% tail(1),2)),color="blue",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_3 <- geom_point(data = D,aes(x=tail_dates_3,y= round(Data$wages_d12 %>% na.omit() %>% tail(1),2)) , size=2,color="black",shape=21,fill="black")

gtext_3 <- geom_text(y =Data$wages_d12 %>% na.omit() %>% tail(1),aes(x=tail_dates_3,label = round(Data$wages_d12 %>% na.omit() %>% tail(1),2)),color="black",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

labordemandpt3 <- labordemandpt3 +g1+ g2 +g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + gtext_1 + gtext_2 + gtext_3 + gpoints_1 + gpoints_2 + gpoints_3

nberShade(labordemandpt3) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 8, .25),2),limits = c(1,8.5))

#ggsave("C:/Users/sabol/Google Drive/blogposts/labordemandpt3.jpg" ,height = 6.5,width = 11.5,units = "in")


# #ggsave("C:/Users/sabol/Google Drive/blogposts/LDpt3.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/LDpt3.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  Labor Flow Rates {-}

```{r laborflowrates, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
laborflowrates      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$separation_rate*1000, color="Unemployment Entry Rate",linetype="Unemployment Entry Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$laborforce_exit_rate*100, color="Labor-force Exit Rate",linetype="Labor-force Exit Rate"))
g4 <- geom_line(aes(y=corpbtogdp, color="Corporate Bond Issuance-to-GDP",linetype="Corporate Bond Issuance-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Unemployment Entry Rate","Corporate Bond Issuance-to-GDP","Labor-force Exit Rate"), values=c( "Job-finding Rate"="blue", "Unemployment Entry Rate"="red","Corporate Bond Issuance-to-GDP" = "black","Labor-force Exit Rate" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Unemployment Entry Rate","Corporate Bond Issuance-to-GDP","Labor-force Exit Rate"), values=c("Job-finding Rate"=1,"Unemployment Entry Rate"=1,"Corporate Bond Issuance-to-GDP"=1,"Labor-force Exit Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Unemployment Entry Rate","Corporate Bond Issuance-to-GDP","Labor-force Exit Rate"), values=c("Job-finding Rate"=2,"Unemployment Entry Rate"=2,"Corporate Bond Issuance-to-GDP"=2,"Labor-force Exit Rate"=3))
title         <- ggtitle("Labor Flow Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1983-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.25, 0.75), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Separation rate (*10); Sources: BLS, NBER",caption = "@capitalmarketz")


tail_1 <- (Data$separation_rate*1000) %>% na.omit() %>% tail(1)

tail_dates_1 <- index(tail(na.omit(xts(Data$separation_rate*1000,order.by = as.Date(Data$Date))),1))
tail_dates_2 <- index(tail(na.omit(xts(Data$finding_rate,order.by = as.Date(Data$Date))),1))
tail_dates_3 <- index(tail(na.omit(xts(Data$laborforce_exit_rate*100,order.by = as.Date(Data$Date))),1))


gpoints_1 <- geom_point(data = Data,aes(x=tail_dates_1,y = round((Data$separation_rate*1000) %>% na.omit() %>% tail(1),2)) , size=2,color="red",shape=21,fill="red")

gtext_1 <- geom_text(y =(Data$separation_rate*1000) %>% na.omit() %>% tail(1),aes(x=tail_dates_1,label = round((Data$separation_rate*1000) %>% na.omit() %>% tail(1),2)),color="red",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_2 <- geom_point(data = D,aes(x=tail_dates_2,y= round(Data$finding_rate %>% na.omit() %>% tail(1),2)) , size=2,color="blue",shape=21,fill="blue")

gtext_2 <- geom_text(y =Data$finding_rate %>% na.omit() %>% tail(1),aes(x=tail_dates_2,label = round(Data$finding_rate %>% na.omit() %>% tail(1),2)),color="blue",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_3 <- geom_point(data = D,aes(x=tail_dates_3,y= round((Data$laborforce_exit_rate*100) %>% na.omit() %>% tail(1),2)) , size=2,color="black",shape=21,fill="black")

gtext_3 <- geom_text(y =(Data$laborforce_exit_rate*100) %>% na.omit() %>% tail(1),aes(x=tail_dates_3,label = round((Data$laborforce_exit_rate*100) %>% na.omit() %>% tail(1),2)),color="black",hjust=0,size=4,nudge_x = 75,nudge_y = -14)


laborflowrates <- laborflowrates  + g1+ g2 +g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(laborflowrates) + scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 8, .5),2),limits = c(0.75,8.0))+ gtext_1 +gtext_2 + gtext_3 + gpoints_1 + gpoints_2 + gpoints_3

#ggsave("C:/Users/sabol/Google Drive/blogposts/laborflowrates.jpg" ,height = 6.5,width = 11.5,units = "in")


# #ggsave("C:/Users/sabol/Google Drive/blogposts/LDpt3.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/LDpt3.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Job Openings{-}

```{r ed15, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ed15      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=Data$v, color="Job Openings",linetype="Job Openings"))

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Job Openings","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Job Openings" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Job Openings","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Job Openings"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Job Openings","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Job Openings"=2,"Wage Growth"=3))
title         <- ggtitle("Job Openings")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: BLS, NBER, JOLTS; Notes: Thousands",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(250,8000,500),0))

ed15 <- ed15 +g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(ed15) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/jobopenings_lvl.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Log Job Openings-to-Unemployment Ratio {-}

```{r ed13, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ed13      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Job Openings-to-Unemployment Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1929-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: BLS, NBER, JOLTS; Notes: V/U ratio is in logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,2,.25),2))

ed13 <- ed13 +g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs+hline

nberShade(ed13) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/logvu.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Job Openings-to-Unemployment Ratio {-}

```{r vu2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

vu2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$quit_rate, color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=Data$vu, color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Job Openings-to-Unemployment Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1929-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: BLS, NBER, JOLTS",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,3,.25),2),limits = c(0,2))

vu2 <- vu2 +g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(vu2) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/vuratio2.jpg" ,height = 6.5,width = 11.5,units = "in")

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")
```

###  Labor Demand: Quit Rate and Vacancy-Unemployment Ratio {-}

```{r ed14, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ed14      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("logs")
g1 <- geom_line(aes(y=log(Data$quit_rate), color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$finding_rate, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$wages_d12/2, color="Wage Growth",linetype="Wage Growth"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Vacancy-Unemployment Ratio" = "black","Wage Growth" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Vacancy-Unemployment Ratio"=1,"Wage Growth"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","Wage Growth"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Vacancy-Unemployment Ratio"=2,"Wage Growth"=3))
title         <- ggtitle("Labor Demand: Quit Rate and Vacancy-Unemployment Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1929-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER, JOLTS, in logs")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(log(Data$vu),na.rm = TRUE), max(log(Data$quit_rate),na.rm = TRUE), 1),0))

ed14 <- ed14 +g1+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ed14) + yscale
```

### ISM New Orders and The Job-finding Rate {-}

```{r jfandno, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

jfandno      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$quit_rate), color="Quit Rate",linetype="Quit Rate"))
g2 <- geom_line(aes(y=Data$findingrate_d12_3mma*10, color="Job-finding Rate",linetype="Job-finding Rate"))
g3 <- geom_line(aes(y=Data$ismneworders_12mma , color="ISM New Orders Index",linetype="ISM New Orders Index"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","ISM New Orders Index"), values=c( "Job-finding Rate"="blue", "Quit Rate"="red","Vacancy-Unemployment Ratio" = "black","ISM New Orders Index" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","ISM New Orders Index"), values=c("Job-finding Rate"=1,"Quit Rate"=1,"Vacancy-Unemployment Ratio"=1,"ISM New Orders Index"=1))
size          <- scale_size_manual(" ", breaks=c("Job-finding Rate","Quit Rate","Vacancy-Unemployment Ratio","ISM New Orders Index"), values=c("Job-finding Rate"=2,"Quit Rate"=2,"Vacancy-Unemployment Ratio"=2,"ISM New Orders Index"=3))
title         <- ggtitle("Labor and Capital Demand: ISM New Orders and The Job-finding Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Job-Finding Rate is roll_mean(diff(log(x),12),3)*10, ISM NO is roll_mean((x-55)/5,12); Sources: BLS, ISM")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-9,7,1),0),limits = c(-4,4))

jfandno <- jfandno +g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(jfandno) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/jfandism.jpg" ,height = 6.5,width = 11.5,units = "in")

```

###  The Unemployment Rate Gap {-}

```{r urgap, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

urgap      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ur_gap*6, color="unrate_ss - unrate",linetype="unrate_ss - unrate"))
g2 <- geom_line(aes(y=Data$urate, color="Unemployment Rate (Stocks)",linetype="Unemployment Rate (Stocks)"))
g3 <- geom_line(aes(y=Data$u_ss , color="Unemployment Rate (Flows)",linetype="Unemployment Rate (Flows)"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Unemployment Rate (Stocks)","unrate_ss - unrate","Vacancy-Unemployment Ratio","Unemployment Rate (Flows)"), values=c( "Unemployment Rate (Stocks)"="blue", "unrate_ss - unrate"="black","Vacancy-Unemployment Ratio" = "black","Unemployment Rate (Flows)" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Unemployment Rate (Stocks)","unrate_ss - unrate","Vacancy-Unemployment Ratio","Unemployment Rate (Flows)"), values=c("Unemployment Rate (Stocks)"=1,"unrate_ss - unrate"=1,"Vacancy-Unemployment Ratio"=1,"Unemployment Rate (Flows)"=1))
size          <- scale_size_manual(" ", breaks=c("Unemployment Rate (Stocks)","unrate_ss - unrate","Vacancy-Unemployment Ratio","Unemployment Rate (Flows)"), values=c("Unemployment Rate (Stocks)"=2,"unrate_ss - unrate"=2,"Vacancy-Unemployment Ratio"=2,"Unemployment Rate (Flows)"=3))
title         <- ggtitle("The Unemployment Rate Gap: Flows Less Stock Based Unemployment Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.45, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Notes: unrate_ss is the unemployment rate based on labor market flows; roll_mean(urate gap,6)*6")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,16,1),0),limits = c(-4,16))

urgap <- urgap +g1+g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(urgap) + yscale
```

### The Unemployment Rate Gap: 1993- {-}

```{r urgap2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

urgap2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ur_gap*6, color="unrate_ss - unrate",linetype="unrate_ss - unrate"))
g2 <- geom_line(aes(y=Data$urate, color="Unemployment Rate (Stocks)",linetype="Unemployment Rate (Stocks)"))
g3 <- geom_line(aes(y=Data$u_ss , color="Unemployment Rate (Flows)",linetype="Unemployment Rate (Flows)"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("Unemployment Rate (Stocks)","unrate_ss - unrate","Vacancy-Unemployment Ratio","Unemployment Rate (Flows)"), values=c( "Unemployment Rate (Stocks)"="blue", "unrate_ss - unrate"="black","Vacancy-Unemployment Ratio" = "black","Unemployment Rate (Flows)" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Unemployment Rate (Stocks)","unrate_ss - unrate","Vacancy-Unemployment Ratio","Unemployment Rate (Flows)"), values=c("Unemployment Rate (Stocks)"=1,"unrate_ss - unrate"=1,"Vacancy-Unemployment Ratio"=1,"Unemployment Rate (Flows)"=1))
size          <- scale_size_manual(" ", breaks=c("Unemployment Rate (Stocks)","unrate_ss - unrate","Vacancy-Unemployment Ratio","Unemployment Rate (Flows)"), values=c("Unemployment Rate (Stocks)"=2,"unrate_ss - unrate"=2,"Vacancy-Unemployment Ratio"=2,"Unemployment Rate (Flows)"=3))
title         <- ggtitle("The Unemployment Rate Gap: Flows Less Stock Based Unemployment Rate (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1992-12-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Notes: unrate_ss is the unemployment rate based on labor market flows; roll_mean(urate gap,6)*6")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,16,1),0),limits = c(-2,16))

urgap2 <- urgap2 +g1+g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(urgap2) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/urgap2.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### Employment-to-Population Ratio {-}

```{r epopgap, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

epopgap      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$epop_gap*10, color="epop_ss - epop",linetype="epop_ss - epop"))
g2 <- geom_line(aes(y=log(Data$epop), color="log epop (stocks)",linetype="log epop (stocks)"))
g3 <- geom_line(aes(y=log(Data$epop_ss*100) , color="log epop (flows)",linetype="log epop (flows)"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("log epop (stocks)","epop_ss - epop","Vacancy-Unemployment Ratio","log epop (flows)"), values=c( "log epop (stocks)"="blue", "epop_ss - epop"="red","Vacancy-Unemployment Ratio" = "black","log epop (flows)" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("log epop (stocks)","epop_ss - epop","Vacancy-Unemployment Ratio","log epop (flows)"), values=c("log epop (stocks)"=1,"epop_ss - epop"=1,"Vacancy-Unemployment Ratio"=1,"log epop (flows)"=1))
size          <- scale_size_manual(" ", breaks=c("log epop (stocks)","epop_ss - epop","Vacancy-Unemployment Ratio","log epop (flows)"), values=c("log epop (stocks)"=2,"epop_ss - epop"=2,"Vacancy-Unemployment Ratio"=2,"log epop (flows)"=3))
title         <- ggtitle("Employment-to-Population Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1968-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: BLS")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-9,7,.025),3),limits = c(3.88,4.2))

epopgap <- epopgap +g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(epopgap) + yscale
```

###  Employment-to-Population Ratio Gap {-}

```{r epopgap2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

epopgap2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$epop_gap*10, color="epop_ss - epop",linetype="epop_ss - epop"))
g2 <- geom_line(aes(y=log(Data$epop) - 4, color="log epop (stocks)",linetype="log epop (stocks)"))
g3 <- geom_line(aes(y=Data$epop_ss -.5 , color="ISM New Orders Index",linetype="ISM New Orders Index"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("log epop (stocks)","epop_ss - epop","Vacancy-Unemployment Ratio","ISM New Orders Index"), values=c( "log epop (stocks)"="blue", "epop_ss - epop"="red","Vacancy-Unemployment Ratio" = "black","ISM New Orders Index" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("log epop (stocks)","epop_ss - epop","Vacancy-Unemployment Ratio","ISM New Orders Index"), values=c("log epop (stocks)"=1,"epop_ss - epop"=1,"Vacancy-Unemployment Ratio"=1,"ISM New Orders Index"=1))
size          <- scale_size_manual(" ", breaks=c("log epop (stocks)","epop_ss - epop","Vacancy-Unemployment Ratio","ISM New Orders Index"), values=c("log epop (stocks)"=2,"epop_ss - epop"=2,"Vacancy-Unemployment Ratio"=2,"ISM New Orders Index"=3))
title         <- ggtitle("Employment-to-Population Ratio Gap")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1968-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 9MMA; Sources: BLS")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-9,7,.025),3))
# ,limits = c(-.265,.10)
epopgap2 <- epopgap2 + g1 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(epopgap2) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/epopgap2.jpg" ,height = 6.5,width = 11.5,units = "in")

```

###  Labor-Force Participation Rate Gap {-}

```{r lfprgap, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

lfprgap      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$lfpr_gap*10, color="lfpr_ss - lfpr",linetype="lfpr_ss - lfpr"))
g2 <- geom_line(aes(y=log(Data$lfpr) - 4, color="log lfpr (stocks)",linetype="log lfpr (stocks)"))
g3 <- geom_line(aes(y=log(Data$lfpr_ss) - 4 , color="log lfpr (flows)",linetype="log lfpr (flows)"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("log lfpr (stocks)","lfpr_ss - lfpr","Vacancy-Unemployment Ratio","log lfpr (flows)"), values=c( "log lfpr (stocks)"="blue", "lfpr_ss - lfpr"="red","Vacancy-Unemployment Ratio" = "black","log lfpr (flows)" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("log lfpr (stocks)","lfpr_ss - lfpr","Vacancy-Unemployment Ratio","log lfpr (flows)"), values=c("log lfpr (stocks)"=1,"lfpr_ss - lfpr"=1,"Vacancy-Unemployment Ratio"=1,"log lfpr (flows)"=1))
size          <- scale_size_manual(" ", breaks=c("log lfpr (stocks)","lfpr_ss - lfpr","Vacancy-Unemployment Ratio","log lfpr (flows)"), values=c("log lfpr (stocks)"=2,"lfpr_ss - lfpr"=2,"Vacancy-Unemployment Ratio"=2,"log lfpr (flows)"=3))
title         <- ggtitle("Labor-Force Participation Rate Gap")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1972-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 9MMA; Sources: BLS")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-9,7,.025),3))

lfprgap <- lfprgap +g1 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(lfprgap) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/lfprgap2.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Labor-Force Participation Rate: Flows vs. Stocks {-}

```{r lfprgap2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

lfprgap2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$lfpr_gap*10, color="lfpr_ss - lfpr",linetype="lfpr_ss - lfpr"))
g2 <- geom_line(aes(y=log(Data$lfpr), color="log lfpr (stocks)",linetype="log lfpr (stocks)"))
g3 <- geom_line(aes(y=log(Data$lfpr_ss*100) , color="log lfpr (flows)",linetype="log lfpr (flows)"))
g4 <- geom_line(aes(y=log(Data$vu), color="Vacancy-Unemployment Ratio",linetype="Vacancy-Unemployment Ratio"))

color         <- scale_color_manual(" ", breaks=c("log lfpr (stocks)","lfpr_ss - lfpr","Vacancy-Unemployment Ratio","log lfpr (flows)"), values=c( "log lfpr (stocks)"="blue", "lfpr_ss - lfpr"="red","Vacancy-Unemployment Ratio" = "black","log lfpr (flows)" ="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("log lfpr (stocks)","lfpr_ss - lfpr","Vacancy-Unemployment Ratio","log lfpr (flows)"), values=c("log lfpr (stocks)"=1,"lfpr_ss - lfpr"=1,"Vacancy-Unemployment Ratio"=1,"log lfpr (flows)"=1))
size          <- scale_size_manual(" ", breaks=c("log lfpr (stocks)","lfpr_ss - lfpr","Vacancy-Unemployment Ratio","log lfpr (flows)"), values=c("log lfpr (stocks)"=2,"lfpr_ss - lfpr"=2,"Vacancy-Unemployment Ratio"=2,"log lfpr (flows)"=3))
title         <- ggtitle("Labor-Force Participation Rate: Flows vs. Stocks")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1968-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Sources: BLS",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-9,7,.05),3),limits = c(3.3,4.3))

lfprgap2 <- lfprgap2 +g3+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(lfprgap2) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/lfprbathtub.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Initial Claims for Unemployment Insurance {-}

```{r iclaims, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_iclaims      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$ic/(Data$pop*1000), color="Initial Claims",linetype="Initial Claims"))
g2 <- geom_line(aes(y=Data$quit_rate, color="Quits Rate",linetype="Quits Rate"))

color         <- scale_color_manual(" ", breaks=c("Quits Rate","Initial Claims"), values=c( "Quits Rate"="blue", "Initial Claims"="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Quits Rate","Initial Claims"), values=c("Quits Rate"=1,"Initial Claims"=1))
size          <- scale_size_manual(" ", breaks=c("Quits Rate","Initial Claims"), values=c("Quits Rate"=2,"Initial Claims"=2))
title         <- ggtitle("Initial Claims for Unemployment Insurance")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1944-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER. Note: as fraction of U.S. Population")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$ic/(Data$pop*1000),na.rm = TRUE), max(Data$ic/(Data$pop*1000),na.rm = TRUE), .001),5))
figure_iclaims <- figure_iclaims +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + yscale

nberShade(figure_iclaims) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")


```

### Real Labor Income {-}

```{r aggwageincome, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_aggwageincome      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=((Data$empl*1000*Data$wages)/1000000/Data$cpi*100), color="Labor Income",linetype="Labor Income"))
g2 <- geom_line(aes(y=Data$quit_rate, color="Quits Rate",linetype="Quits Rate"))

color         <- scale_color_manual(" ", breaks=c("Quits Rate","Labor Income"), values=c( "Quits Rate"="blue", "Labor Income"="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Quits Rate","Labor Income"), values=c("Quits Rate"=1,"Labor Income"=1))
size          <- scale_size_manual(" ", breaks=c("Quits Rate","Labor Income"), values=c("Quits Rate"=2,"Labor Income"=2))
title         <- ggtitle("Real Labor Income")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1910-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER. Note: (Total Nonfarm Employment*1000*Private Nonfarm Hourly Wages)/1000000*CPI*100")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(((Data$empl*1000*Data$wages)/1000000/Data$cpi*100),na.rm = TRUE), max(((Data$empl*1000*Data$wages)/1000000/Data$cpi*100),na.rm = TRUE), 100),0))
figure_aggwageincome <- figure_aggwageincome +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + yscale

nberShade(figure_aggwageincome) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/aggwageincome.jpg" ,height = 6.5,width = 11.5,units = "in")

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")


```

### Real Labor Income (Yoy) {-}

```{r aggwageincomed12, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_aggwageincomed12      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$real_aggwageincome_d12, color="Labor Income",linetype="Labor Income"))
g2 <- geom_line(aes(y=Data$quit_rate, color="Quits Rate",linetype="Quits Rate"))

color         <- scale_color_manual(" ", breaks=c("Quits Rate","Labor Income"), values=c( "Quits Rate"="blue", "Labor Income"="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Quits Rate","Labor Income"), values=c("Quits Rate"=1,"Labor Income"=1))
size          <- scale_size_manual(" ", breaks=c("Quits Rate","Labor Income"), values=c("Quits Rate"=2,"Labor Income"=2))
title         <- ggtitle("Real Labor Income (Yoy)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, BLS, NBER. Note: (Total Nonfarm Employment*1000*Private Nonfarm Hourly Wages)/1000000*CPI*100")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-30, 40, 5),0))
figure_aggwageincomed12 <- figure_aggwageincomed12 +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs + yscale +hline

nberShade(figure_aggwageincomed12) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

## Real Estate {-}

###  Real Home Price and Commercial Real Estate Price Index {-}

```{r hpiplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Figure_rhpi      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$hpi/Data$cpi, color="Real Home Prices",linetype="Real Home Prices"))
g2 <- geom_line(aes(y=Data$usa_cre_pi_q/Data$cpi, color="Real CRE Price Index",linetype="Real CRE Price Index"))

color         <- scale_color_manual(" ", breaks=c("Real CRE Price Index","Real Home Prices"), values=c( "Real CRE Price Index"="blue", "Real Home Prices"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real CRE Price Index","Real Home Prices"), values=c("Real CRE Price Index"=1,"Real Home Prices"=1))
size          <- scale_size_manual(" ", breaks=c("Real CRE Price Index","Real Home Prices"), values=c("Real CRE Price Index"=2,"Real Home Prices"=2))
title         <- ggtitle("Real Home Price and Commercial Real Estate Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Deflated by CPI; Sources: Bob Shiller and FRB")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(.2, 1, .1),2),limits = c(.2,1))
Figure_rhpi <- Figure_rhpi + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(Figure_rhpi) + yscale
```

###  Real Multifamily Price Indexes {-}

```{r mf_plot_pi, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_mf_pi_plot      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$mf_apt_pi/Data$cpi, color="FRB",linetype="FRB"))
g2 <- geom_line(aes(y=Data$mf_apt_pi_fhlmc/Data$cpi*1000, color="FHLMC",linetype="FHLMC"))

color         <- scale_color_manual(" ", breaks=c("FHLMC","FRB"), values=c( "FHLMC"="blue", "FRB"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("FHLMC","FRB"), values=c("FHLMC"=1,"FRB"=1))
size          <- scale_size_manual(" ", breaks=c("FHLMC","FRB"), values=c("FHLMC"=2,"FRB"=2))
title         <- ggtitle("Real Multifamily Price Indexes")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1984-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Deflated by CPI, FHLMC Index * 1000; Sources: FRB and FHLMC")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1200, 100),2),limits = c(350,1200))
figure_mf_pi_plot <- figure_mf_pi_plot + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_mf_pi_plot) + yscale
```

### Construction-to-GDP {-}

```{r resplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$res_construct/Data$ngdpm, color="Residential Construction-to-GDP",linetype="Residential Construction-to-GDP"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Residential Construction-to-GDP"), values=c( "Total Construction-to-GDP"="blue", "Residential Construction-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Residential Construction-to-GDP"), values=c("Total Construction-to-GDP"=1,"Residential Construction-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Residential Construction-to-GDP"), values=c("Total Construction-to-GDP"=2,"Residential Construction-to-GDP"=2))
title         <- ggtitle("Construction-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.55, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Census")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$res_construct/Data$ngdpm,na.rm = TRUE), max(Data$construction/Data$ngdpm,na.rm = TRUE), .01),2))
figure_res <- figure_res + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res) + yscale
```

### Real Per Capita Construction {-}

```{r resplot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$res_construct/(Data$pop/1000)/Data$cpi*100, color="Residential Construction",linetype="Residential Construction"))
g2 <- geom_line(aes(y=Data$construction/(Data$pop/1000)/Data$cpi*100, color="Total Construction",linetype="Total Construction"))

color         <- scale_color_manual(" ", breaks=c("Total Construction","Residential Construction"), values=c( "Total Construction"="blue", "Residential Construction"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction","Residential Construction"), values=c("Total Construction"=1,"Residential Construction"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction","Residential Construction"), values=c("Total Construction"=2,"Residential Construction"=2))
title         <- ggtitle("Real Per Capita Construction")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,180,20),0),limits = c(0,180))
figure_res2 <- figure_res2 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res2) + yscale
```

### Real Private and Public Construction Per Capita {-}

```{r resplot3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$priv_construct/(Data$pop/1000)/Data$cpi*100, color="Private Construction",linetype="Private Construction"))
g2 <- geom_line(aes(y=Data$public_construct/(Data$pop/1000)/Data$cpi*100, color="Public Construction",linetype="Public Construction"))

color         <- scale_color_manual(" ", breaks=c("Public Construction","Private Construction"), values=c( "Public Construction"="blue", "Private Construction"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Public Construction","Private Construction"), values=c("Public Construction"=1,"Private Construction"=1))
size          <- scale_size_manual(" ", breaks=c("Public Construction","Private Construction"), values=c("Public Construction"=2,"Private Construction"=2))
title         <- ggtitle("Real Private and Public Construction Per Capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1938-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,180,10),0),limits = c(0,140))
figure_res3 <- figure_res3 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res3) + yscale
```

### Real Construction Per Capita {-}

```{r resplot4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$res_construct/(Data$pop/1000)/Data$cpi*100, color="Residential Construction",linetype="Residential Construction"))
g2 <- geom_line(aes(y=Data$nonres_construct/(Data$pop/1000)/Data$cpi*100, color="Nonresidential Construction",linetype="Nonresidential Construction"))

color         <- scale_color_manual(" ", breaks=c("Nonresidential Construction","Residential Construction"), values=c( "Nonresidential Construction"="blue", "Residential Construction"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Nonresidential Construction","Residential Construction"), values=c("Nonresidential Construction"=1,"Residential Construction"=1))
size          <- scale_size_manual(" ", breaks=c("Nonresidential Construction","Residential Construction"), values=c("Nonresidential Construction"=2,"Residential Construction"=2))
title         <- ggtitle("Real Construction Per Capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,180,5),0),limits = c(0,95))
figure_res4 <- figure_res4 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res4) + yscale
```

###  Real Residential Construction Per Capita and Real Home Prices {-}

```{r resplot6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res6      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$res_construct/(Data$pop/1000)/Data$cpi*100, color="Residential Construction",linetype="Residential Construction"))
g2 <- geom_line(aes(y=Data$hpi/Data$cpi*100, color="Real Home Prices",linetype="Real Home Prices"))

color         <- scale_color_manual(" ", breaks=c("Real Home Prices","Residential Construction"), values=c( "Real Home Prices"="blue", "Residential Construction"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Home Prices","Residential Construction"), values=c("Real Home Prices"=1,"Residential Construction"=1))
size          <- scale_size_manual(" ", breaks=c("Real Home Prices","Residential Construction"), values=c("Real Home Prices"=2,"Residential Construction"=2))
title         <- ggtitle("Real Residential Construction Per Capita and Real Home Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: deflated by CPI; Sources: Bob Shiller and Census")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,180,5),0),limits = c(0,95))
figure_res6 <- figure_res6 + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res6) + yscale
```

### Real Highway and Street Construction Per Capita {-}

```{r resplot5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_res5      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$highway_construct/(Data$pop/1000)/Data$cpi*100, color="Highway and Street Construction",linetype="Highway and Street Construction"))
g2 <- geom_line(aes(y=Data$nonres_construct/(Data$pop/1000)/Data$cpi*100, color="NonHighway and Street Construction",linetype="NonHighway and Street Construction"))

color         <- scale_color_manual(" ", breaks=c("NonHighway and Street Construction","Highway and Street Construction"), values=c( "NonHighway and Street Construction"="blue", "Highway and Street Construction"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("NonHighway and Street Construction","Highway and Street Construction"), values=c("NonHighway and Street Construction"=1,"Highway and Street Construction"=1))
size          <- scale_size_manual(" ", breaks=c("NonHighway and Street Construction","Highway and Street Construction"), values=c("NonHighway and Street Construction"=2,"Highway and Street Construction"=2))
title         <- ggtitle("Real Highway and Street Construction Per Capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1938-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,180,.5),0),limits = c(0,15))
figure_res5 <- figure_res5 + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_res5) + yscale
```

###  Real Office Construction Per Capita {-}

```{r resplotoffice, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_officecons      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$office_construct/(Data$pop/1000)/Data$cpi*100, color="Office Construction",linetype="Office Construction"))
g2 <- geom_line(aes(y=Data$nonres_construct/(Data$pop/1000)/Data$cpi*100, color="NonOffice Construction",linetype="NonOffice Construction"))

color         <- scale_color_manual(" ", breaks=c("NonOffice Construction","Office Construction"), values=c( "NonOffice Construction"="blue", "Office Construction"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("NonOffice Construction","Office Construction"), values=c("NonOffice Construction"=1,"Office Construction"=1))
size          <- scale_size_manual(" ", breaks=c("NonOffice Construction","Office Construction"), values=c("NonOffice Construction"=2,"Office Construction"=2))
title         <- ggtitle("Real Office Construction Per Capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1971-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,180,.5),0),limits = c(3,15))
figure_officecons <- figure_officecons + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_officecons) + yscale
```

### U.S. New Privately-Owned Housing Units: Summary {-}

```{r resconstructA1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

resconstructA1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$home_permit_total ,color="Permits",linetype="Permits"))
g2 <- geom_line(aes(y=Data$home_auth_total, color="Authorized But Not Started",linetype="Authorized But Not Started"))
g3 <- geom_line(aes(y=Data$home_starts_total, color="Starts",linetype="Starts"))
g4 <- geom_line(aes(y=Data$home_undconst_total, color="Under Construction",linetype="Under Construction"))
g5 <- geom_line(aes(y=Data$home_comp_total, color="Completions",linetype="Completions"))

color         <- scale_color_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c( "Authorized But Not Started"="blue", "Permits"="red","Under Construction" = "black","Starts" ="purple","Completions" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=1,"Permits"=1,"Under Construction"=1,"Starts"=2,"Completions"=1))
size          <- scale_size_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=2,"Permits"=2,"Under Construction"=2,"Starts"=3,"Completions"=3))
title         <- ggtitle("U.S. New Privately-Owned Housing Units: Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1963-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Thousands of Units")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000,50),0))
vline <- geom_vline(xintercept = as.Date("2015-01-01"),show.legend = TRUE)

resconstructA1 <- resconstructA1 +g1+g2+g3+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(resconstructA1) + yscale
```

### New Privately-Owned Housing Single Family Units: Summary {-}

```{r resconstructoneunit, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

resconstructoneunit      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$home_permit_oneunit ,color="Permits",linetype="Permits"))
g2 <- geom_line(aes(y=Data$home_auth_oneunit, color="Authorized But Not Started",linetype="Authorized But Not Started"))
g3 <- geom_line(aes(y=Data$home_starts_oneunit, color="Starts",linetype="Starts"))
g4 <- geom_line(aes(y=Data$home_undconst_oneunit, color="Under Construction",linetype="Under Construction"))
g5 <- geom_line(aes(y=Data$home_comp_oneunit, color="Completions",linetype="Completions"))

color         <- scale_color_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c( "Authorized But Not Started"="blue", "Permits"="red","Under Construction" = "black","Starts" ="purple","Completions" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=1,"Permits"=1,"Under Construction"=1,"Starts"=2,"Completions"=1))
size          <- scale_size_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=2,"Permits"=2,"Under Construction"=2,"Starts"=3,"Completions"=3))
title         <- ggtitle("U.S. New Privately-Owned Housing Single Family Units: Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1963-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Thousands of Units")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000,20),0))
vline <- geom_vline(xintercept = as.Date("2015-01-01"),show.legend = TRUE)

resconstructoneunit <- resconstructoneunit +g1+g2+g3+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(resconstructoneunit) + yscale
```

###  New Privately-Owned Housing Multifamily Units: Summary {-}

```{r resconstructmf, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

resconstructmf      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$home_permit_mf ,color="Permits",linetype="Permits"))
g2 <- geom_line(aes(y=Data$home_auth_mf, color="Authorized But Not Started",linetype="Authorized But Not Started"))
g3 <- geom_line(aes(y=Data$home_starts_mf, color="Starts",linetype="Starts"))
g4 <- geom_line(aes(y=Data$home_undconst_mf, color="Under Construction",linetype="Under Construction"))
g5 <- geom_line(aes(y=Data$home_comp_mf, color="Completions",linetype="Completions"))

color         <- scale_color_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c( "Authorized But Not Started"="blue", "Permits"="red","Under Construction" = "black","Starts" ="purple","Completions" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=1,"Permits"=1,"Under Construction"=1,"Starts"=2,"Completions"=1))
size          <- scale_size_manual(" ", breaks=c("Authorized But Not Started","Permits","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=2,"Permits"=2,"Under Construction"=2,"Starts"=3,"Completions"=3))
title         <- ggtitle("U.S. New Privately-Owned Housing Multifamily Units: Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1963-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Thousands of Units")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000,25),0))
vline <- geom_vline(xintercept = as.Date("2015-01-01"),show.legend = TRUE)

resconstructmf <- resconstructmf +g1+g2+g3+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(resconstructmf) + yscale
```

### New Privately-Owned Housing Units Under Construction {-}

```{r underconstruct, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

underconstructionfig  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$home_undconst_mf, color="Multifamily (5+ Units)",linetype="Multifamily (5+ Units)"))
g2 <- geom_line(aes(y=Data$home_undconst_oneunit, color="Single-family",linetype="Single-family"))
g3 <- geom_line(aes(y=Data$home_undconst_total, color="Total",linetype="Total"))
g4 <- geom_line(aes(y=Data$home_comp_total, color="Completions",linetype="Completions"))

color         <- scale_color_manual(" ", breaks=c("Single-family","Multifamily (5+ Units)","Completions","Total"), values=c( "Single-family"="blue", "Multifamily (5+ Units)"="red","Completions" = "black","Total" ="green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Single-family","Multifamily (5+ Units)","Completions","Total"), values=c("Single-family"=1,"Multifamily (5+ Units)"=1,"Completions"=1,"Total"=1))
size          <- scale_size_manual(" ", breaks=c("Single-family","Multifamily (5+ Units)","Completions","Total"), values=c("Single-family"=2,"Multifamily (5+ Units)"=2,"Completions"=2,"Total"=3))
title         <- ggtitle("New Privately-Owned Housing Units Under Construction")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1969-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Thousands of Units")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 10000,100),0))
underconstructionfig <- underconstructionfig +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(underconstructionfig) + yscale
```

### Monthly Supply of Houses in the United States {-}

```{r monthssupplynew, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

monthssupplynew      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("Months' Supply")
g1 <- geom_line(aes(y=Data$home_new_months_supply ,color="Months' Supply",linetype="Months' Supply"))
g2 <- geom_line(aes(y=Data$home_auth_mf, color="Authorized But Not Started",linetype="Authorized But Not Started"))
g3 <- geom_line(aes(y=Data$home_starts_mf, color="Starts",linetype="Starts"))
g4 <- geom_line(aes(y=Data$home_undconst_mf, color="Under Construction",linetype="Under Construction"))
g5 <- geom_line(aes(y=Data$home_comp_mf, color="Completions",linetype="Completions"))

color         <- scale_color_manual(" ", breaks=c("Authorized But Not Started","Months' Supply","Under Construction","Starts","Completions"), values=c( "Authorized But Not Started"="blue", "Months' Supply"="red","Under Construction" = "black","Starts" ="purple","Completions" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Authorized But Not Started","Months' Supply","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=1,"Months' Supply"=1,"Under Construction"=1,"Starts"=2,"Completions"=1))
size          <- scale_size_manual(" ", breaks=c("Authorized But Not Started","Months' Supply","Under Construction","Starts","Completions"), values=c("Authorized But Not Started"=2,"Months' Supply"=2,"Under Construction"=2,"Starts"=3,"Completions"=3))
title         <- ggtitle("Monthly Supply of Houses in the United States")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1962-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: The ratio of new houses for sale to new houses sold")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 20,.5),1))
vline <- geom_vline(xintercept = as.Date("2015-01-01"),show.legend = TRUE)

monthssupplynew <- monthssupplynew +g1+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(monthssupplynew) + yscale
```

###  The Expected Return on New Single-family Housing and Real Home Prices {-}

```{r expretnewhousing, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

expretnewhousing      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$exp_hpi_ret ,color="Expected Return",linetype="Expected Return"))
g2 <- geom_line(aes(y=Data$hpi/Data$cpi*20-10, color="Real Home Prices",linetype="Real Home Prices"))
g3 <- geom_line(aes(y=(Data$home_new_sales_median_price)*5-20, color="Median Sales Price-to-Median Income",linetype="Median Sales Price-to-Median Income"))
g4 <- geom_line(aes(y=Data$home_undconst_mf, color="Under Construction",linetype="Under Construction"))
g5 <- geom_line(aes(y=Data$home_comp_mf, color="Completions",linetype="Completions"))

color         <- scale_color_manual(" ", breaks=c("Real Home Prices","Expected Return","Under Construction","Median Sales Price-to-Median Income","Completions"), values=c( "Real Home Prices"="blue", "Expected Return"="red","Under Construction" = "black","Median Sales Price-to-Median Income" ="black","Completions" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Home Prices","Expected Return","Under Construction","Median Sales Price-to-Median Income","Completions"), values=c("Real Home Prices"=1,"Expected Return"=1,"Under Construction"=1,"Median Sales Price-to-Median Income"=1,"Completions"=1))
size          <- scale_size_manual(" ", breaks=c("Real Home Prices","Expected Return","Under Construction","Median Sales Price-to-Median Income","Completions"), values=c("Real Home Prices"=2,"Expected Return"=2,"Under Construction"=2,"Median Sales Price-to-Median Income"=3,"Completions"=3))
title         <- ggtitle("The Expected Return on New Single-family Housing and Real Home Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1975-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Notes: Everything scaled; Expected Return = -1*[Avg Sales Price of New Homes/Construction Cost Index/ Number of Households]")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5, 20,1),0),limits = c(-5,9))
vline <- geom_vline(xintercept = as.Date("2015-01-01"),show.legend = TRUE)
hline         <- geom_hline(yintercept = 0, linetype="dashed")

expretnewhousing <- expretnewhousing + g1 + g2 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(expretnewhousing) + yscale + hline

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

## REITS {-}

### Dividend Yield  {-}

```{r reits_dividend_yield_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

reits_dividend_yield_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$mreits_dividend_yield, color="Mortgage Reits",linetype="Mortgage Reits"))
g2 <- geom_line(aes(y=Data$equityreits_dividend_yield, color="Equity Reits",linetype="Equity Reits"))
g3 <- geom_line(aes(y=Data$all_ereits_dividend_yield, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$all_reits_dividend_yield, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c( "Equity Reits"="blue", "Mortgage Reits"="red","All Reits" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=1,"Mortgage Reits"=1,"All Reits"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=2,"Mortgage Reits"=2,"All Reits"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("REITS: Dividend Yield")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1972-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: reit.com")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,25,2.5),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
reits_dividend_yield_plot <- reits_dividend_yield_plot +g1+g2+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(reits_dividend_yield_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/reits_dividend_yield_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#reits",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/reits_dividend_yield_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("reits_dividend_yield_plot.jpg")
```

### Real Dividend Yields {-}

```{r reits_real_dividend_yield_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

reits_real_dividend_yield_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$mreits_dividend_yield-Data$infexplt, color="Mortgage Reits",linetype="Mortgage Reits"))
g2 <- geom_line(aes(y=Data$equityreits_dividend_yield-Data$infexplt, color="Equity Reits",linetype="Equity Reits"))
g3 <- geom_line(aes(y=Data$all_ereits_dividend_yield-Data$infexplt, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$all_reits_dividend_yield-Data$infexplt, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c( "Equity Reits"="blue", "Mortgage Reits"="red","All Reits" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=1,"Mortgage Reits"=1,"All Reits"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=2,"Mortgage Reits"=2,"All Reits"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("REITS: Real Dividend Yields")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1972-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: reit.com, Notes: Less long-term inflation expectations (CMDMD:infexplt)")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5,25,2.5),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
reits_real_dividend_yield_plot <- reits_real_dividend_yield_plot +g1+g2+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(reits_real_dividend_yield_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/reits_real_dividend_yield_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#reits",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/reits_real_dividend_yield_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("reits_real_dividend_yield_plot.jpg")
```

### Real Return Index {-}

```{r reits_index_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

reits_index_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$mreits_index/Data$cpi*100, color="Mortgage Reits",linetype="Mortgage Reits"))
g2 <- geom_line(aes(y=Data$equityreits_index/Data$cpi*100, color="Equity Reits",linetype="Equity Reits"))
g3 <- geom_line(aes(y=Data$all_ereits_index/Data$cpi*100, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$all_reits_index/Data$cpi*100, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c( "Equity Reits"="blue", "Mortgage Reits"="red","All Reits" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=1,"Mortgage Reits"=1,"All Reits"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=2,"Mortgage Reits"=2,"All Reits"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("REITS: Real Return Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1972-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: reit.com, Notes: deflated by CPI")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000,500),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
reits_index_plot <- reits_index_plot +g1+g2+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(reits_index_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/reits_index_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#reits",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/reits_index_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("reits_index_plot.jpg")
```

### Income Return {-}

```{r reits_income_return_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

reits_income_return_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$mreits_income_return, color="Mortgage Reits",linetype="Mortgage Reits"))
g2 <- geom_line(aes(y=Data$equityreits_income_return, color="Equity Reits",linetype="Equity Reits"))
g3 <- geom_line(aes(y=Data$all_ereits_income_return, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$all_reits_income_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c( "Equity Reits"="blue", "Mortgage Reits"="red","All Reits" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=1,"Mortgage Reits"=1,"All Reits"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=2,"Mortgage Reits"=2,"All Reits"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("REITS: Income Return")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: reit.com")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1.5,25,.5),2),limits = c(-1.5,5))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
reits_income_return_plot <- reits_income_return_plot +g1+g2+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(reits_income_return_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/reits_income_return_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#reits",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/reits_income_return_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("reits_income_return_plot.jpg")
```

### Price Return {-}

```{r reits_price_return_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

reits_price_return_plot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$mreits_price_return, color="Mortgage Reits",linetype="Mortgage Reits"))
g2 <- geom_line(aes(y=Data$equityreits_price_return, color="Equity Reits",linetype="Equity Reits"))
g3 <- geom_line(aes(y=Data$all_ereits_price_return, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c( "Equity Reits"="blue", "Mortgage Reits"="red","All Reits" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=1,"Mortgage Reits"=1,"All Reits"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=2,"Mortgage Reits"=2,"All Reits"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("REITS: Price Return")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2000-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: reit.com")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-55,35,5),1),limits = c(-55,35))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
reits_price_return_plot <- reits_price_return_plot +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(reits_price_return_plot) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/reits_price_return_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#reits",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/reits_price_return_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("reits_price_return_plot.jpg")
```

## Transportation {-}

###  Public Transit Ridership {-}

```{r transport_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$transit_ridership_mil, color="Mortgage Reits",linetype="Mortgage Reits"))
g2 <- geom_line(aes(y=Data$transit_nyc, color="Equity Reits",linetype="Equity Reits"))
g3 <- geom_line(aes(y=Data$all_ereits_price_return, color="Prime",linetype="Prime"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c( "Equity Reits"="blue", "Mortgage Reits"="red","All Reits" = "black","Prime" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=1,"Mortgage Reits"=1,"All Reits"=1,"Prime"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Reits","Mortgage Reits","All Reits","Prime","Philippines"), values=c("Equity Reits"=2,"Mortgage Reits"=2,"All Reits"=2,"Prime"=3,"Philippines"=3))
title         <- ggtitle("Public Transit Ridership")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1927-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Millions of Unlinked Trips")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,2000,100),0),limits = c(0,1800))
vline <- geom_vline(xintercept = as.Date("1907-01-01"),show.legend = TRUE)
transport_plot1 <- transport_plot1 +g1+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot1) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Transportation Summary {-}

```{r transport_plot1a, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot1a      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$transit_ridership_mil, color="Public Transit Unlinked Trips (Mil)",linetype="Public Transit Unlinked Trips (Mil)"))
g2 <- geom_line(aes(y=Data$vmt_sa/100, color="Vehicle Miles Traveled (100M)",linetype="Vehicle Miles Traveled (100M)"))
g3 <- geom_line(aes(y=Data$pullman_rpm, color="Pullman Revenue Passenger Miles (Mil)",linetype="Pullman Revenue Passenger Miles (Mil)"))
g4 <- geom_line(aes(y=Data$rail_rpm, color="Rail Revenue Passenger Miles (Mil)",linetype="Rail Revenue Passenger Miles (Mil)"))
g5 <- geom_line(aes(y=Data$air_pass_rpm_d_sa*100, color="Air Domestic Passenger Miles (10M)",linetype="Air Domestic Passenger Miles (10M)"))

color         <- scale_color_manual(" ", breaks=c("Vehicle Miles Traveled (100M)","Public Transit Unlinked Trips (Mil)","Rail Revenue Passenger Miles (Mil)","Pullman Revenue Passenger Miles (Mil)","Air Domestic Passenger Miles (10M)"), values=c( "Vehicle Miles Traveled (100M)"="blue", "Public Transit Unlinked Trips (Mil)"="red","Rail Revenue Passenger Miles (Mil)" = "black","Pullman Revenue Passenger Miles (Mil)" ="purple","Air Domestic Passenger Miles (10M)" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Vehicle Miles Traveled (100M)","Public Transit Unlinked Trips (Mil)","Rail Revenue Passenger Miles (Mil)","Pullman Revenue Passenger Miles (Mil)","Air Domestic Passenger Miles (10M)"), values=c("Vehicle Miles Traveled (100M)"=1,"Public Transit Unlinked Trips (Mil)"=1,"Rail Revenue Passenger Miles (Mil)"=1,"Pullman Revenue Passenger Miles (Mil)"=2,"Air Domestic Passenger Miles (10M)"=1))
size          <- scale_size_manual(" ", breaks=c("Vehicle Miles Traveled (100M)","Public Transit Unlinked Trips (Mil)","Rail Revenue Passenger Miles (Mil)","Pullman Revenue Passenger Miles (Mil)","Air Domestic Passenger Miles (10M)"), values=c("Vehicle Miles Traveled (100M)"=2,"Public Transit Unlinked Trips (Mil)"=2,"Rail Revenue Passenger Miles (Mil)"=2,"Pullman Revenue Passenger Miles (Mil)"=3,"Air Domestic Passenger Miles (10M)"=3))
title         <- ggtitle("Transportation Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,9000,500),0),limits = c(0,9000))
vline <- geom_vline(xintercept = as.Date("1900-01-01"),show.legend = TRUE)
transport_plot1a <- transport_plot1a +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot1a) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Transportation Quantity Summary {-}

```{r transport_plot1b, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot1b      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$intercity_buses_fisher_quantity_index_lvl_dibura, color="Intercity Buses",linetype="Intercity Buses"))
g2 <- geom_line(aes(y=Data$intracity_mass_transit_fisher_quantity_index_lvl_dimtra, color="Intracity Mass Transit",linetype="Intracity Mass Transit"))
g3 <- geom_line(aes(y=Data$taxicabs_and_ride_sharing_services_fisher_quantity_index_lvl_dtaxra, color="Taxi Cabs and Ride Sharing Services ",linetype="Taxi Cabs and Ride Sharing Services "))
g4 <- geom_line(aes(y=Data$railway_transportation_fisher_quantity_index_lvl_dirrra, color="Railroad Transportation",linetype="Railroad Transportation"))
g5 <- geom_line(aes(y=Data$air_transportation_64_fisher_quantity_index_lvl_daitra, color="Air Transportation",linetype="Air Transportation"))

color         <- scale_color_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c( "Intracity Mass Transit"="blue", "Intercity Buses"="red","Railroad Transportation" = "black","Taxi Cabs and Ride Sharing Services " ="purple","Air Transportation" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=1,"Intercity Buses"=1,"Railroad Transportation"=1,"Taxi Cabs and Ride Sharing Services "=2,"Air Transportation"=1))
size          <- scale_size_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=2,"Intercity Buses"=2,"Railroad Transportation"=2,"Taxi Cabs and Ride Sharing Services "=3,"Air Transportation"=3))
title         <- ggtitle("Transportation Quantity Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.5, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Fisher quantity indexes, level")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,900,40),0),limits = c(0,400))
vline <- geom_vline(xintercept = as.Date("1900-01-01"),show.legend = TRUE)
transport_plot1b <- transport_plot1b +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot1b) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Transportation Summary: Nominal Expenditures {-}

```{r transport_plot1c, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot1c      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$intercity_buses_cur_usd_lvl_diburc, color="Intercity Buses",linetype="Intercity Buses"))
g2 <- geom_line(aes(y=Data$intracity_mass_transit_cur_usd_lvl_dimtrc, color="Intracity Mass Transit",linetype="Intracity Mass Transit"))
g3 <- geom_line(aes(y=Data$taxicabs_and_ride_sharing_services_cur_usd_lvl_dtaxrc, color="Taxi Cabs and Ride Sharing Services ",linetype="Taxi Cabs and Ride Sharing Services "))
g4 <- geom_line(aes(y=Data$railway_transportation_cur_usd_lvl_dirrrc, color="Railroad Transportation",linetype="Railroad Transportation"))
g5 <- geom_line(aes(y=Data$air_transportation_64_cur_usd_lvl_daitrc, color="Air Transportation",linetype="Air Transportation"))

color         <- scale_color_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c( "Intracity Mass Transit"="blue", "Intercity Buses"="red","Railroad Transportation" = "black","Taxi Cabs and Ride Sharing Services " ="purple","Air Transportation" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=1,"Intercity Buses"=1,"Railroad Transportation"=1,"Taxi Cabs and Ride Sharing Services "=2,"Air Transportation"=1))
size          <- scale_size_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=2,"Intercity Buses"=2,"Railroad Transportation"=2,"Taxi Cabs and Ride Sharing Services "=3,"Air Transportation"=3))
title         <- ggtitle("Transportation Summary: Nominal Expenditures")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.2, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Millions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100000,2000),0),limits = c(0,24000))
vline <- geom_vline(xintercept = as.Date("1900-01-01"),show.legend = TRUE)
transport_plot1c <- transport_plot1c +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot1c) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Transportation Summary: Real Personal Expenditures {-}

```{r transport_plot1d, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot1d      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$intercity_buses_chained_usd_lvl_diburx, color="Intercity Buses",linetype="Intercity Buses"))
g2 <- geom_line(aes(y=Data$intracity_mass_transit_chained_usd_lvl_dimtrx, color="Intracity Mass Transit",linetype="Intracity Mass Transit"))
g3 <- geom_line(aes(y=Data$taxicabs_and_ride_sharing_services_chained_usd_lvl_dtaxrx, color="Taxi Cabs and Ride Sharing Services ",linetype="Taxi Cabs and Ride Sharing Services "))
g4 <- geom_line(aes(y=Data$railway_transportation_chained_usd_lvl_dirrrx, color="Railroad Transportation",linetype="Railroad Transportation"))
g5 <- geom_line(aes(y=Data$air_transportation_64_chained_usd_lvl_daitrx, color="Air Transportation",linetype="Air Transportation"))

color         <- scale_color_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c( "Intracity Mass Transit"="blue", "Intercity Buses"="red","Railroad Transportation" = "black","Taxi Cabs and Ride Sharing Services " ="purple","Air Transportation" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=1,"Intercity Buses"=1,"Railroad Transportation"=1,"Taxi Cabs and Ride Sharing Services "=2,"Air Transportation"=1))
size          <- scale_size_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=2,"Intercity Buses"=2,"Railroad Transportation"=2,"Taxi Cabs and Ride Sharing Services "=3,"Air Transportation"=3))
title         <- ggtitle("Transportation Summary: Real Personal Expenditures")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("2002-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.3, 0.6), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Millions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100900,2000),0),limits = c(0,20000))
vline <- geom_vline(xintercept = as.Date("1900-01-01"),show.legend = TRUE)
transport_plot1d <- transport_plot1d +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot1d) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Transportation Summary: Real Price Indexes {-}

```{r transport_plot1e, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot1e      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$intercity_buses_fisher_price_index_lvl_diburg/Data$cpi*100, color="Intercity Buses",linetype="Intercity Buses"))
g2 <- geom_line(aes(y=Data$intracity_mass_transit_fisher_price_index_lvl_dimtrg/Data$cpi*100, color="Intracity Mass Transit",linetype="Intracity Mass Transit"))
g3 <- geom_line(aes(y=Data$taxicabs_and_ride_sharing_services_fisher_price_index_lvl_dtaxrg/Data$cpi*100, color="Taxi Cabs and Ride Sharing Services ",linetype="Taxi Cabs and Ride Sharing Services "))
g4 <- geom_line(aes(y=Data$railway_transportation_fisher_price_index_lvl_dirrrg/Data$cpi*100, color="Railroad Transportation",linetype="Railroad Transportation"))
g5 <- geom_line(aes(y=Data$air_transportation_64_fisher_price_index_lvl_daitrg/Data$cpi*100, color="Air Transportation",linetype="Air Transportation"))

color         <- scale_color_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c( "Intracity Mass Transit"="blue", "Intercity Buses"="red","Railroad Transportation" = "black","Taxi Cabs and Ride Sharing Services " ="purple","Air Transportation" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=1,"Intercity Buses"=1,"Railroad Transportation"=1,"Taxi Cabs and Ride Sharing Services "=2,"Air Transportation"=1))
size          <- scale_size_manual(" ", breaks=c("Intracity Mass Transit","Intercity Buses","Railroad Transportation","Taxi Cabs and Ride Sharing Services ","Air Transportation"), values=c("Intracity Mass Transit"=2,"Intercity Buses"=2,"Railroad Transportation"=2,"Taxi Cabs and Ride Sharing Services "=3,"Air Transportation"=3))
title         <- ggtitle("Transportation Summary: Real Price Indexes")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.6, 0.9), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Deflated by CPI")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,5),0),limits = c(25,80))
vline <- geom_vline(xintercept = as.Date("1900-01-01"),show.legend = TRUE)
transport_plot1e <- transport_plot1e +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot1e) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  Air Passenger Revenue Miles {-}

```{r transport_plot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$air_pass_rpm_d_sa, color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=Data$air_pass_rpm_sa, color="Total",linetype="Total"))
g3 <- geom_line(aes(y=Data$air_pass_rpm_i_sa, color="International",linetype="International"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c( "Total"="blue", "Domestic"="red","All Reits" = "black","International" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=1,"Domestic"=1,"All Reits"=1,"International"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=2,"Domestic"=2,"All Reits"=2,"International"=3,"Philippines"=3))
title         <- ggtitle("Air Passenger Revenue Miles")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1931-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Billions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,10),0),limits = c(0,70))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot2 <- transport_plot2 +g1+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot2) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  Air Freight Ton-Miles {-}

```{r transport_plot3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot3      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$airfreightdomtonmiles_sa, color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=Data$air_pass_rpm_sa, color="Total",linetype="Total"))
g3 <- geom_line(aes(y=Data$airfreight_int_select_tonmiles_sa, color="International",linetype="International"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c( "Total"="blue", "Domestic"="red","All Reits" = "black","International" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=1,"Domestic"=1,"All Reits"=1,"International"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=2,"Domestic"=2,"All Reits"=2,"International"=3,"Philippines"=3))
title         <- ggtitle("Air Freight Ton-Miles")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Millions; For International only select regions are used")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,3000,100),0),limits = c(0,1800))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot3 <- transport_plot3 +g1+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot3) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Air Carrier Revenue Ton-Miles {-}

```{r transport_plot4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot4      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$air_carrier_total_revenue_freight_ton_miles_sa, color="Freight",linetype="Freight"))
g2 <- geom_line(aes(y=Data$air_carrier_total_revenue_mail_ton_miles_sa, color="Mail",linetype="Mail"))
g3 <- geom_line(aes(y=Data$air_carrier_total_revenue_ton_miles_sa, color="Total Revenue Ton-Miles",linetype="Total Revenue Ton-Miles"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Mail","Freight","All Reits","Total Revenue Ton-Miles","Philippines"), values=c( "Mail"="blue", "Freight"="red","All Reits" = "black","Total Revenue Ton-Miles" ="green","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mail","Freight","All Reits","Total Revenue Ton-Miles","Philippines"), values=c("Mail"=1,"Freight"=1,"All Reits"=1,"Total Revenue Ton-Miles"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Mail","Freight","All Reits","Total Revenue Ton-Miles","Philippines"), values=c("Mail"=2,"Freight"=2,"All Reits"=2,"Total Revenue Ton-Miles"=3,"Philippines"=3))
title         <- ggtitle("Air Carrier Revenue Ton-Miles")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Millions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,3000,200),0),limits = c(0,2800))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot4 <- transport_plot4 +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot4) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Total Air Revenue Ton-Miles {-}

```{r transport_plot5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot5      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$air_carrier_total_revenue_ton_miles_sa, color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=Data$air_pass_rpm_sa, color="Total",linetype="Total"))
g3 <- geom_line(aes(y=Data$airfreight_int_select_tonmiles, color="International",linetype="International"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c( "Total"="blue", "Domestic"="red","All Reits" = "black","International" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=1,"Domestic"=1,"All Reits"=1,"International"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=2,"Domestic"=2,"All Reits"=2,"International"=3,"Philippines"=3))
title         <- ggtitle("Total Air Revenue Ton-Miles")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Millions")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,13000,1000),0),limits = c(0,12000))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot5 <- transport_plot5 +g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot5) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### International Travel {-}

```{r transport_plot6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot6      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log((Data$us_citizen_departures_to_foreign_country)), color="U.S. Citizen Departures",linetype="U.S. Citizen Departures"))
g2 <- geom_line(aes(y=log(Data$foreign_arrivals), color="Foreign Arrivals to the U.S.",linetype="Foreign Arrivals to the U.S."))
g3 <- geom_line(aes(y=log(us_citizen_departures_to_foreign_country_ma), color="U.S. Citizen Departures 12MMA",linetype="U.S. Citizen Departures 12MMA"))
g4 <- geom_line(aes(y=log(foreign_arrivals_ma), color="Foreign Arrivals to the U.S. 12MMA",linetype="Foreign Arrivals to the U.S. 12MMA"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Foreign Arrivals to the U.S.","U.S. Citizen Departures","Foreign Arrivals to the U.S. 12MMA","U.S. Citizen Departures 12MMA","Philippines"), values=c( "Foreign Arrivals to the U.S."="blue", "U.S. Citizen Departures"="red","Foreign Arrivals to the U.S. 12MMA" = "blue","U.S. Citizen Departures 12MMA" ="red","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Foreign Arrivals to the U.S.","U.S. Citizen Departures","Foreign Arrivals to the U.S. 12MMA","U.S. Citizen Departures 12MMA","Philippines"), values=c("Foreign Arrivals to the U.S."=2,"U.S. Citizen Departures"=2,"Foreign Arrivals to the U.S. 12MMA"=1,"U.S. Citizen Departures 12MMA"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Foreign Arrivals to the U.S.","U.S. Citizen Departures","Foreign Arrivals to the U.S. 12MMA","U.S. Citizen Departures 12MMA","Philippines"), values=c("Foreign Arrivals to the U.S."=2,"U.S. Citizen Departures"=2,"Foreign Arrivals to the U.S. 12MMA"=2,"U.S. Citizen Departures 12MMA"=3,"Philippines"=3))
title         <- ggtitle("International Travel")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: logs, at some point includes only air travelers")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,30,1),0),limits = c(0,10))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot6 <- transport_plot6 +g1+g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot6) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### International Travel: Quantity Indexes {-}

```{r transport_plot6a, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot6a      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$us_travel_outside_the_united_states_fisher_quantity_index_lvl_dustra), color="U.S. Travel Outside the U.S.",linetype="U.S. Travel Outside the U.S."))
g2 <- geom_line(aes(y=Data$foreign_travel_in_the_united_states_fisher_quantity_index_lvl_dftura, color="Foreign Travel in the U.S.",linetype="Foreign Travel in the U.S."))
g3 <- geom_line(aes(y=Data$foreign_travel_by_us_residents_129_fisher_quantity_index_lvl_dftrra, color="Foreign Travel by U.S. Residents",linetype="Foreign Travel by U.S. Residents"))
g4 <- geom_line(aes(y=log(foreign_arrivals_ma), color="Foreign Travel in the U.S. 12MMA",linetype="Foreign Travel in the U.S. 12MMA"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c( "Foreign Travel in the U.S."="blue", "U.S. Travel Outside the U.S."="red","Foreign Travel in the U.S. 12MMA" = "green","Foreign Travel by U.S. Residents" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c("Foreign Travel in the U.S."=1,"U.S. Travel Outside the U.S."=1,"Foreign Travel in the U.S. 12MMA"=1,"Foreign Travel by U.S. Residents"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c("Foreign Travel in the U.S."=2,"U.S. Travel Outside the U.S."=2,"Foreign Travel in the U.S. 12MMA"=2,"Foreign Travel by U.S. Residents"=3,"Philippines"=3))
title         <- ggtitle("International Travel: Quantity Indexes")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Fisher Quantity Indexes; BEA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,10),0),limits = c(0,170))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot6a <- transport_plot6a +g1+g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot6a) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Passenger Fares for Foreign Travel: Quantity Index {-}

```{r transport_plot6b, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot6b      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$passenger_fares_for_foreign_travel_fisher_quantity_index_lvl_daftra), color="U.S. Travel Outside the U.S.",linetype="U.S. Travel Outside the U.S."))
g2 <- geom_line(aes(y=Data$foreign_travel_in_the_united_states_fisher_quantity_index_lvl_dftura, color="Foreign Travel in the U.S.",linetype="Foreign Travel in the U.S."))
g3 <- geom_line(aes(y=Data$foreign_travel_by_us_residents_129_fisher_quantity_index_lvl_dftrra, color="Foreign Travel by U.S. Residents",linetype="Foreign Travel by U.S. Residents"))
g4 <- geom_line(aes(y=log(foreign_arrivals_ma), color="Foreign Travel in the U.S. 12MMA",linetype="Foreign Travel in the U.S. 12MMA"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c( "Foreign Travel in the U.S."="blue", "U.S. Travel Outside the U.S."="red","Foreign Travel in the U.S. 12MMA" = "green","Foreign Travel by U.S. Residents" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c("Foreign Travel in the U.S."=1,"U.S. Travel Outside the U.S."=1,"Foreign Travel in the U.S. 12MMA"=1,"Foreign Travel by U.S. Residents"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c("Foreign Travel in the U.S."=2,"U.S. Travel Outside the U.S."=2,"Foreign Travel in the U.S. 12MMA"=2,"Foreign Travel by U.S. Residents"=3,"Philippines"=3))
title         <- ggtitle("Passenger Fares for Foreign Travel: Quantity Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Fisher Quantity Index; BEA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,10),0),limits = c(0,180))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot6b <- transport_plot6b +g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot6b) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. Hotel Occupancy {-}

```{r transport_plot7, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot7      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$us_hotel_occupancy, color="Hotel Occupancy",linetype="Hotel Occupancy"))
g2 <- geom_line(aes(y=Data$us_hotel_occupancy_12mma, color="Hotel Occupancy 12mma",linetype="Hotel Occupancy 12mma"))
g3 <- geom_line(aes(y=Data$airfreight_int_select_tonmiles, color="International",linetype="International"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Hotel Occupancy 12mma","Hotel Occupancy","All Reits","International","Philippines"), values=c( "Hotel Occupancy 12mma"="red", "Hotel Occupancy"="blue","All Reits" = "black","International" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Hotel Occupancy 12mma","Hotel Occupancy","All Reits","International","Philippines"), values=c("Hotel Occupancy 12mma"=1,"Hotel Occupancy"=1,"All Reits"=1,"International"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Hotel Occupancy 12mma","Hotel Occupancy","All Reits","International","Philippines"), values=c("Hotel Occupancy 12mma"=3,"Hotel Occupancy"=2,"All Reits"=2,"International"=3,"Philippines"=3))
title         <- ggtitle("U.S. Hotel Occupancy")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1927-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Percent")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100,5),0),limits = c(20,100))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot7 <- transport_plot7 +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot7) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Hotels and Motels: Quantity Indexes {-}

```{r transport_plot7a, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot7a      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$hotels_and_motels_fisher_quantity_index_lvl_dhotra), color="U.S. Travel Outside the U.S.",linetype="U.S. Travel Outside the U.S."))
g2 <- geom_line(aes(y=Data$foreign_travel_in_the_united_states_fisher_quantity_index_lvl_dftura, color="Foreign Travel in the U.S.",linetype="Foreign Travel in the U.S."))
g3 <- geom_line(aes(y=Data$foreign_travel_by_us_residents_129_fisher_quantity_index_lvl_dftrra, color="Foreign Travel by U.S. Residents",linetype="Foreign Travel by U.S. Residents"))
g4 <- geom_line(aes(y=log(foreign_arrivals_ma), color="Foreign Travel in the U.S. 12MMA",linetype="Foreign Travel in the U.S. 12MMA"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c( "Foreign Travel in the U.S."="blue", "U.S. Travel Outside the U.S."="red","Foreign Travel in the U.S. 12MMA" = "green","Foreign Travel by U.S. Residents" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c("Foreign Travel in the U.S."=1,"U.S. Travel Outside the U.S."=1,"Foreign Travel in the U.S. 12MMA"=1,"Foreign Travel by U.S. Residents"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Foreign Travel in the U.S.","U.S. Travel Outside the U.S.","Foreign Travel in the U.S. 12MMA","Foreign Travel by U.S. Residents","Philippines"), values=c("Foreign Travel in the U.S."=2,"U.S. Travel Outside the U.S."=2,"Foreign Travel in the U.S. 12MMA"=2,"Foreign Travel by U.S. Residents"=3,"Philippines"=3))
title         <- ggtitle("Hotels and Motels: Quantity Indexes")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Fisher Quantity Indexes; BEA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,10),0),limits = c(0,140))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot7a <- transport_plot7a +g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot7a) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. Restaurant Sales {-}

```{r transport_plot8, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot8      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$restaurant_sales_mil), color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=log(Data$restaurant_sales_mil_sa), color="Total",linetype="Total"))
g3 <- geom_line(aes(y=Data$airfreight_int_select_tonmiles, color="International",linetype="International"))
g4 <- geom_line(aes(y=Data$all_reits_price_return, color="All Reits",linetype="All Reits"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c( "Total"="blue", "Domestic"="red","All Reits" = "black","International" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=1,"Domestic"=1,"All Reits"=1,"International"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","All Reits","International","Philippines"), values=c("Total"=2,"Domestic"=2,"All Reits"=2,"International"=3,"Philippines"=3))
title         <- ggtitle("U.S. Restaurant Sales")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: logs")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,30,.5),1),limits = c(5,11.5))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot8 <- transport_plot8 +g1+ g2+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot8) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. National Park Visitors {-}

```{r transport_plot9, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot9      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$restaurant_sales_mil), color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=log(Data$restaurant_sales_mil_sa), color="Total",linetype="Total"))
g3 <- geom_line(aes(y=Data$np_rec_visits_sa, color="Recreational Visitors",linetype="Recreational Visitors"))
g4 <- geom_line(aes(y=Data$np_total_visits_sa, color="Total Visitors",linetype="Total Visitors"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c( "Total"="blue", "Domestic"="red","Total Visitors" = "black","Recreational Visitors" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c("Total"=1,"Domestic"=1,"Total Visitors"=1,"Recreational Visitors"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c("Total"=2,"Domestic"=2,"Total Visitors"=2,"Recreational Visitors"=3,"Philippines"=3))
title         <- ggtitle("U.S. National Park Visitors")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 49 National Parks, in Thousands",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000,500),0),limits = c(0,10000))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot9 <- transport_plot9 +g3+ g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot9) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  U.S. National Park Visitors Per Capita - logs {-}

```{r transport_plot9a, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot9a      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$restaurant_sales_mil), color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=log(Data$restaurant_sales_mil_sa), color="Total",linetype="Total"))
g3 <- geom_line(aes(y=log(Data$np_rec_visits_sa/Data$pop*100), color="Recreational Visitors",linetype="Recreational Visitors"))
g4 <- geom_line(aes(y=log(Data$np_total_visits_sa/Data$pop*100), color="Total Visitors",linetype="Total Visitors"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c( "Total"="blue", "Domestic"="red","Total Visitors" = "black","Recreational Visitors" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c("Total"=1,"Domestic"=1,"Total Visitors"=1,"Recreational Visitors"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c("Total"=2,"Domestic"=2,"Total Visitors"=2,"Recreational Visitors"=3,"Philippines"=3))
title         <- ggtitle("U.S. National Park Visitors Per Capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 49 National Parks, in logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5,10,.5),1),limits = c(-3,1.5))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot9a <- transport_plot9a +g3+ g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot9a) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. National Park Visitors Per Capita {-}

```{r transport_plot9b, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot9b      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$restaurant_sales_mil), color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=log(Data$restaurant_sales_mil_sa), color="Total",linetype="Total"))
g3 <- geom_line(aes(y=Data$np_rec_visits_sa/Data$pop*100, color="Recreational Visitors",linetype="Recreational Visitors"))
g4 <- geom_line(aes(y=Data$np_total_visits_sa/Data$pop*100, color="Total Visitors",linetype="Total Visitors"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c( "Total"="blue", "Domestic"="red","Total Visitors" = "black","Recreational Visitors" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c("Total"=1,"Domestic"=1,"Total Visitors"=1,"Recreational Visitors"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Total","Domestic","Total Visitors","Recreational Visitors","Philippines"), values=c("Total"=2,"Domestic"=2,"Total Visitors"=2,"Recreational Visitors"=3,"Philippines"=3))
title         <- ggtitle("U.S. National Park Visitors Per Capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1960-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: 49 National Parks, x 100",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5,10,.25),2),limits = c(0.75,3))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot9b <- transport_plot9b +g3+ g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot9b) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  U.S. Real Hotel Construction, Revenue, and Stock Prices {-}

```{r transport_plot10, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

transport_plot10      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$hospitality_industry_idx/Data$ngdpm*50000)*3, color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=log(Data$hospitality_industry_idx/Data$cpi/Data$pop*5000000)*2.5, color="Hospitality Stock Prices (deflated by pop and cpi)",linetype="Hospitality Stock Prices (deflated by pop and cpi)"))
g3 <- geom_line(aes(y=Data$hotel_construct/Data$cpi, color="Real Hotel Construction",linetype="Real Hotel Construction"))
g4 <- geom_line(aes(y=Data$hotels_and_motels_cur_usd_lvl_dhotrc/Data$pop/Data$cpi*10000, color="Real Hotel and Motel Revenues per capita",linetype="Real Hotel and Motel Revenues per capita"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Hospitality Stock Prices (deflated by pop and cpi)","Domestic","Real Hotel and Motel Revenues per capita","Real Hotel Construction","Philippines"), values=c( "Hospitality Stock Prices (deflated by pop and cpi)"="red", "Domestic"="green","Real Hotel and Motel Revenues per capita" = "black","Real Hotel Construction" ="blue","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Hospitality Stock Prices (deflated by pop and cpi)","Domestic","Real Hotel and Motel Revenues per capita","Real Hotel Construction","Philippines"), values=c("Hospitality Stock Prices (deflated by pop and cpi)"=1,"Domestic"=1,"Real Hotel and Motel Revenues per capita"=1,"Real Hotel Construction"=1,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Hospitality Stock Prices (deflated by pop and cpi)","Domestic","Real Hotel and Motel Revenues per capita","Real Hotel Construction","Philippines"), values=c("Hospitality Stock Prices (deflated by pop and cpi)"=2,"Domestic"=2,"Real Hotel and Motel Revenues per capita"=2,"Real Hotel Construction"=3,"Philippines"=3))
title         <- ggtitle("U.S. Real Hotel Construction, Revenue, and Stock Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Everything deflated by cpi, Real Hotel and Motel Revenue per capita x 10000")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,30,2),0),limits = c(0,18))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
transport_plot10 <- transport_plot10 +g2+g3+ g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(transport_plot10) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

## Autos {-}

### U.S. Passenger Auto Summary {-}

```{r auto_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$auto_prod_bea), color="Domestic Production",linetype="Domestic Production"))
g2 <- geom_line(aes(y=Data$auto_imp_canada_bea, color="Canadian Imports",linetype="Canadian Imports"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c( "Canadian Imports"="blue", "Domestic Production"="red","Auto Sales" = "black","Mexican Imports" ="purple","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=1,"Domestic Production"=1,"Auto Sales"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=2,"Domestic Production"=2,"Auto Sales"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Passenger Auto Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA; Notes: Thousands of Units",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000,50),0),limits = c(0,850))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot1 <- auto_plot1 +g1+ g2+g3+g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot1) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  U.S. Passenger Auto Trade {-}

```{r auto_plot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$auto_prod_bea), color="Domestic Production",linetype="Domestic Production"))
g2 <- geom_line(aes(y=Data$auto_imp_canada_bea, color="Canadian Imports",linetype="Canadian Imports"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c( "Canadian Imports"="blue", "Domestic Production"="red","Auto Sales" = "black","Mexican Imports" ="red","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=1,"Domestic Production"=1,"Auto Sales"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=2,"Domestic Production"=2,"Auto Sales"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Passenger Auto Trade")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA; Notes: Thousands of Units",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,150,10),0),limits = c(0,150))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot2 <- auto_plot2 +g2+g3+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot2) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. Passenger Auto Inventory Change {-}

```{r auto_plot3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot3      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$auto_inv_ch_bea), color="Domestic Production",linetype="Domestic Production"))
g2 <- geom_line(aes(y=Data$auto_imp_canada_bea, color="Canadian Imports",linetype="Canadian Imports"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c( "Canadian Imports"="blue", "Domestic Production"="red","Auto Sales" = "black","Mexican Imports" ="purple","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=1,"Domestic Production"=1,"Auto Sales"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=2,"Domestic Production"=2,"Auto Sales"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Passenger Auto Inventory Change")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA; Notes: Thousands of Units",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-300,300,30),0),limits = c(-300,300))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot3 <- auto_plot3 +g1+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + hline

nberShade(auto_plot3) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. Passenger Auto Inventories {-}

```{r auto_plot4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot4      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$auto_inv_bea), color="BEA",linetype="BEA"))
g2 <- geom_line(aes(y=Data$auto_inv_wards, color="Wards",linetype="Wards"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Wards","BEA","Auto Sales","Mexican Imports","Exports"), values=c( "Wards"="blue", "BEA"="red","Auto Sales" = "black","Mexican Imports" ="purple","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Wards","BEA","Auto Sales","Mexican Imports","Exports"), values=c("Wards"=1,"BEA"=1,"Auto Sales"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Wards","BEA","Auto Sales","Mexican Imports","Exports"), values=c("Wards"=2,"BEA"=2,"Auto Sales"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Passenger Auto Inventories")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA; Notes: Thousands of Units",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,3000,100),0),limits = c(300,2200))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot4 <- auto_plot4 +g1+ g2+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot4) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. Passenger Auto Inventory-to-Sales Ratio {-}

```{r auto_plot5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot5      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$auto_inv_to_sales_bea, color="Domestic Production",linetype="Domestic Production"))
g2 <- geom_line(aes(y=Data$auto_avg_price_dom_bea, color="Canadian Imports",linetype="Canadian Imports"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c( "Canadian Imports"="blue", "Domestic Production"="red","Auto Sales" = "black","Mexican Imports" ="purple","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=1,"Domestic Production"=1,"Auto Sales"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Canadian Imports","Domestic Production","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=2,"Domestic Production"=2,"Auto Sales"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Passenger Auto Inventory-to-Sales Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10,.2),1),limits = c(1.2,4.8))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot5 <- auto_plot5 +g1+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot5) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Passenger Autos: Average Prices {-}

```{r auto_plot6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot6      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$auto_avg_price_dom_bea), color="Domestic",linetype="Domestic"))
g2 <- geom_line(aes(y=Data$auto_avg_price_for_bea, color="Foreign",linetype="Foreign"))
g3 <- geom_line(aes(y=Data$auto_avg_price_total_bea, color="Total",linetype="Total"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Foreign","Domestic","Auto Sales","Total","Exports"), values=c( "Foreign"="blue", "Domestic"="red","Auto Sales" = "black","Total" ="purple","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Foreign","Domestic","Auto Sales","Total","Exports"), values=c("Foreign"=1,"Domestic"=1,"Auto Sales"=1,"Total"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Foreign","Domestic","Auto Sales","Total","Exports"), values=c("Foreign"=2,"Domestic"=2,"Auto Sales"=2,"Total"=2,"Exports"=2))
title         <- ggtitle("Passenger Autos: Average Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,40000,2500),0),limits = c(0,35000))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot6 <- auto_plot6 +g1+ g2+g3+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot6) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  U.S. Trade In Motor Vehicles For The Transport of Persons {-}

```{r auto_plot7, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot7      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$passauto_exports), color="Exports In Motor Vehicles For the Transport of Persons (SITC4)",linetype="Exports In Motor Vehicles For the Transport of Persons (SITC4)"))
g2 <- geom_line(aes(y=Data$passauto_imports, color="Imports",linetype="Imports"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_exports_bea, color="U.S. Passenger Auto Exports (BEA)",linetype="U.S. Passenger Auto Exports (BEA)"))
g5 <- geom_line(aes(y=Data$auto_exports_bea, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Imports","Exports In Motor Vehicles For the Transport of Persons (SITC4)","U.S. Passenger Auto Exports (BEA)","Mexican Imports","Exports"), values=c( "Imports"="blue", "Exports In Motor Vehicles For the Transport of Persons (SITC4)"="red","U.S. Passenger Auto Exports (BEA)" = "black","Mexican Imports" ="purple","Exports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Imports","Exports In Motor Vehicles For the Transport of Persons (SITC4)","U.S. Passenger Auto Exports (BEA)","Mexican Imports","Exports"), values=c("Imports"=1,"Exports In Motor Vehicles For the Transport of Persons (SITC4)"=1,"U.S. Passenger Auto Exports (BEA)"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Imports","Exports In Motor Vehicles For the Transport of Persons (SITC4)","U.S. Passenger Auto Exports (BEA)","Mexican Imports","Exports"), values=c("Imports"=2,"Exports In Motor Vehicles For the Transport of Persons (SITC4)"=2,"U.S. Passenger Auto Exports (BEA)"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Trade In Motor Vehicles For The Transport of Persons")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA, SITC4; Notes: Thousands of Units",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000,25),0),limits = c(0,275))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot7 <- auto_plot7 +g1+g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot7) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### U.S. Trade In Motor Vehicles For The Transport of Goods {-}

```{r auto_plot8, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot8      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$truck_imports), color="Imports",linetype="Imports"))
g2 <- geom_line(aes(y=Data$auto_imp_canada_bea, color="Canadian Imports",linetype="Canadian Imports"))
g3 <- geom_line(aes(y=Data$auto_imp_mexico_bea, color="Mexican Imports",linetype="Mexican Imports"))
g4 <- geom_line(aes(y=Data$auto_sales_bea, color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=Data$truck_exports, color="Exports",linetype="Exports"))

color         <- scale_color_manual(" ", breaks=c("Canadian Imports","Imports","Auto Sales","Mexican Imports","Exports"), values=c( "Canadian Imports"="blue", "Imports"="red","Auto Sales" = "black","Mexican Imports" ="purple","Exports" = "blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Canadian Imports","Imports","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=1,"Imports"=1,"Auto Sales"=1,"Mexican Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Canadian Imports","Imports","Auto Sales","Mexican Imports","Exports"), values=c("Canadian Imports"=2,"Imports"=2,"Auto Sales"=2,"Mexican Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Trade In Motor Vehicles For The Transport of Goods")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: SITC4; Notes: Thousands of Units",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000,10),0),limits = c(0,180))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot8 <- auto_plot8 +g1+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(auto_plot8) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

### Total Vehicle Sales {-}

```{r autosales_fig1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_autosales_fig1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("Thousands of Units - SA")
g1 <- geom_line(aes(y=Data$mv_sales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$construction/Data$ngdpm, color="Total Construction-to-GDP",linetype="Total Construction-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Total Construction-to-GDP","Auto Sales"), values=c( "Total Construction-to-GDP"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Total Construction-to-GDP","Auto Sales"), values=c("Total Construction-to-GDP"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Total Construction-to-GDP","Auto Sales"), values=c("Total Construction-to-GDP"=2,"Auto Sales"=2))
title         <- ggtitle("Total Vehicle Sales")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, Thousands of Units - SA")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$mv_sales,na.rm = TRUE), max(Data$mv_sales,na.rm = TRUE), 100),0))
figure_autosales_fig1 <- figure_autosales_fig1 + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_autosales_fig1) + yscale
```

### Total Vehicle Sales per capita {-}

```{r autosalespercap, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_autosalespercap      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("fraction of Total Population")
g1 <- geom_line(aes(y=Data$mv_sales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$autosales_pop, color="Auto Sales per capita",linetype="Auto Sales per capita"))

color         <- scale_color_manual(" ", breaks=c("Auto Sales per capita","Auto Sales"), values=c( "Auto Sales per capita"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Auto Sales per capita","Auto Sales"), values=c("Auto Sales per capita"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Auto Sales per capita","Auto Sales"), values=c("Auto Sales per capita"=2,"Auto Sales"=2))
title         <- ggtitle("Vehicle Sales per 1000 Residents")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$autosales_pop,na.rm = TRUE), max(Data$autosales_pop,na.rm = TRUE), .5),1))
figure_autosalespercap <- figure_autosalespercap + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_autosalespercap) + yscale
```

###  Passenger and Truck Sales per capita {-}

```{r autosalespercap2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_autosalespercap2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("per 1000 people")
g1 <- geom_line(aes(y=(Data$passcar_sales/Data$pop)*1000, color="Passenger Autos",linetype="Passenger Autos"))
g2 <- geom_line(aes(y=(Data$truck_sales/Data$pop)*1000, color="Trucks",linetype="Trucks"))

color         <- scale_color_manual(" ", breaks=c("Trucks","Passenger Autos"), values=c( "Trucks"="blue", "Passenger Autos"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Trucks","Passenger Autos"), values=c("Trucks"=1,"Passenger Autos"=1))
size          <- scale_size_manual(" ", breaks=c("Trucks","Passenger Autos"), values=c("Trucks"=2,"Passenger Autos"=2))
title         <- ggtitle("Vehicle Sales per 1000 Residents")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05 , 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Notes: SA")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,5, .5),1),limits = c(0,5))
figure_autosalespercap2 <- figure_autosalespercap2 +g1+ g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_autosalespercap2) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/vehiclesalespercapita.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### U.S. Motor Vehicle Production {-}

```{r autoprodfig, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

autoprodfig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$passcar_prod, color="Domestic Passenger Autos",linetype="Domestic Passenger Autos"))
g2 <- geom_line(aes(y=Data$truck_prod, color="Trucks",linetype="Trucks"))
g3 <- geom_line(aes(y=Data$passcar_prod +Data$truck_prod , color="Total Vehicle",linetype="Total Vehicle"))
g4 <- geom_line(aes(y=Data$for_truck_sales/Data$pop*1000, color="Foreign Light Weight Trucks",linetype="Foreign Light Weight Trucks"))

color         <- scale_color_manual(" ", breaks=c("Trucks","Domestic Passenger Autos","Foreign Light Weight Trucks","Total Vehicle"), values=c( "Trucks"="blue", "Domestic Passenger Autos"="red","Foreign Light Weight Trucks" = "blue","Total Vehicle" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Trucks","Domestic Passenger Autos","Foreign Light Weight Trucks","Total Vehicle"), values=c("Trucks"=1,"Domestic Passenger Autos"=1,"Foreign Light Weight Trucks"=2,"Total Vehicle"=1))
size          <- scale_size_manual(" ", breaks=c("Trucks","Domestic Passenger Autos","Foreign Light Weight Trucks","Total Vehicle"), values=c("Trucks"=2,"Domestic Passenger Autos"=2,"Foreign Light Weight Trucks"=4,"Total Vehicle"=4))
title         <- ggtitle("U.S. Motor Vehicle Production")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Thousands of Units - SA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1200,100),0),limits = c(0,1200))

autoprodfig <- autoprodfig +g1+ g2 +g3+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +yscale

nberShade(autoprodfig) +yscale
```

### Motor Vehicle Production per 1000 Residents {-}

```{r autosalesfordom, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

autosalesfordom      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$passcar_prod/Data$pop*1000, color="Domestic Passenger Autos",linetype="Domestic Passenger Autos"))
g2 <- geom_line(aes(y=Data$truck_prod/Data$pop*1000, color="Trucks",linetype="Trucks"))
g3 <- geom_line(aes(y=Data$mv_prod/Data$pop*1000, color="Total Vehicle",linetype="Total Vehicle"))
g4 <- geom_line(aes(y=Data$for_truck_sales/Data$pop*1000, color="Foreign Light Weight Trucks",linetype="Foreign Light Weight Trucks"))

color         <- scale_color_manual(" ", breaks=c("Trucks","Domestic Passenger Autos","Foreign Light Weight Trucks","Total Vehicle"), values=c( "Trucks"="blue", "Domestic Passenger Autos"="red","Foreign Light Weight Trucks" = "blue","Total Vehicle" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Trucks","Domestic Passenger Autos","Foreign Light Weight Trucks","Total Vehicle"), values=c("Trucks"=1,"Domestic Passenger Autos"=1,"Foreign Light Weight Trucks"=2,"Total Vehicle"=1))
size          <- scale_size_manual(" ", breaks=c("Trucks","Domestic Passenger Autos","Foreign Light Weight Trucks","Total Vehicle"), values=c("Trucks"=2,"Domestic Passenger Autos"=2,"Foreign Light Weight Trucks"=4,"Total Vehicle"=4))
title         <- ggtitle("Motor Vehicle Production per 1000 Residents")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")

autosalesfordom <- autosalesfordom +g1+ g2 +g3+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(autosalesfordom)
```

###  Auto Credit-to-GDP {-}

```{r ed3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$auto_credit/Data$ngdpm, color="Auto Credit-to-GDP",linetype="Auto Credit-to-GDP"))

color         <- scale_color_manual(" ", breaks=c("Auto Credit-to-GDP","Auto Sales"), values=c( "Auto Credit-to-GDP"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Auto Credit-to-GDP","Auto Sales"), values=c("Auto Credit-to-GDP"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Auto Credit-to-GDP","Auto Sales"), values=c("Auto Credit-to-GDP"=2,"Auto Sales"=2))
title         <- ggtitle("Auto Credit-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1928-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$auto_credit/Data$ngdpm,na.rm = TRUE), max(Data$auto_credit/Data$ngdpm,na.rm = TRUE), .1),2))
figure_ed3 <- figure_ed3 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed3) + yscale
```

###  U.S. Auto and Truck Equities Valuation Ratios {-}

```{r auto_plot_stocks, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

auto_plot_stocks      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=log(Data$transportation_idx/Data$transportation_cur_usd_lvl_dtrnrc*1000), color="Imports",linetype="Imports"))
g2 <- geom_line(aes(y=log(Data$automobiles_and_trucks_idx/(Data$auto_avg_price_total_bea*Data$mv_sales)*10000), color="MV Expenditures",linetype="MV Expenditures"))
g3 <- geom_line(aes(y=log(Data$automobiles_and_trucks_idx/Data$mv_prod), color="MV Production",linetype="MV Production"))
g4 <- geom_line(aes(y=log(Data$automobiles_and_trucks_idx/Data$passcar_sales/1.5), color="Auto Sales",linetype="Auto Sales"))
g5 <- geom_line(aes(y=log(Data$automobiles_and_trucks_idx/( Data$new_motor_vehicles_cur_usd_lvl_dnmvrc)*100), color="MV Sales (USD)",linetype="MV Sales (USD)"))

color         <- scale_color_manual(" ", breaks=c("MV Expenditures","Imports","Auto Sales","MV Production","MV Sales (USD)"), values=c( "MV Expenditures"="blue", "Imports"="red","Auto Sales" = "black","MV Production" ="purple","MV Sales (USD)" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("MV Expenditures","Imports","Auto Sales","MV Production","MV Sales (USD)"), values=c("MV Expenditures"=1,"Imports"=1,"Auto Sales"=1,"MV Production"=1,"MV Sales (USD)"=1))
size          <- scale_size_manual(" ", breaks=c("MV Expenditures","Imports","Auto Sales","MV Production","MV Sales (USD)"), values=c("MV Expenditures"=2,"Imports"=2,"Auto Sales"=2,"MV Production"=2,"MV Sales (USD)"=2))
title         <- ggtitle("U.S. Auto and Truck Equities Valuation Ratios")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1959-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: BEA; Notes: logs",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10,10,.25),2),limits = c(-2.75,3.5))
vline <- geom_vline(xintercept = as.Date("1923-01-01"),show.legend = TRUE)
auto_plot_stocks <- auto_plot_stocks +g2+g3+g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(auto_plot_stocks) + yscale

# ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

## Commodity Prices

###  BAA-10yr Spread and ISM Prices Index {-}

```{r ismpricesplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ismpricesplot      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
  g1 <- geom_line(aes(y=-((Data$ismprices-55)/15), color="-1*(ISM Prices-55)/15",linetype="-1*(ISM Prices-55)/15"))
g2 <- geom_line(aes(y=(Data$baa - Data$ten)-2, color="BAA-10yr Spread",linetype="BAA-10yr Spread"))

color         <- scale_color_manual(" ", breaks=c("BAA-10yr Spread","-1*(ISM Prices-55)/15"), values=c( "BAA-10yr Spread"="blue", "-1*(ISM Prices-55)/15"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("BAA-10yr Spread","-1*(ISM Prices-55)/15"), values=c("BAA-10yr Spread"=1,"-1*(ISM Prices-55)/15"=1))
size          <- scale_size_manual(" ", breaks=c("BAA-10yr Spread","-1*(ISM Prices-55)/15"), values=c("BAA-10yr Spread"=2,"-1*(ISM Prices-55)/15"=2))
title         <- ggtitle("BAA-10yr Spread and ISM Prices Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1967-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: ISM; Notes: BAA-!0yr Spread - 2")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-30,30, 1),0),limits = c(-3,4))
figure_ismpricesplot <- figure_ismpricesplot + g1 +g2+ color +linetype +size + title +text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(figure_ismpricesplot) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/ismprices.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Real Copper Price {-}

```{r ed4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$copper_price/Data$cpi, color="Real Copper Price",linetype="Real Copper Price"))

color         <- scale_color_manual(" ", breaks=c("Real Copper Price","Auto Sales"), values=c( "Real Copper Price"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Copper Price","Auto Sales"), values=c("Real Copper Price"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Copper Price","Auto Sales"), values=c("Real Copper Price"=2,"Auto Sales"=2))
title         <- ggtitle("Real Copper Price")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1870-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$copper_price/Data$cpi,na.rm = TRUE), max(Data$copper_price/Data$cpi,na.rm = TRUE), .005),3))
figure_ed4 <- figure_ed4 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed4) + yscale
```

###  Real Wheat Price {-}

```{r ed5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed5      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$wheat_price/Data$cpi, color="Real Wheat Price",linetype="Real Wheat Price"))

color         <- scale_color_manual(" ", breaks=c("Real Wheat Price","Auto Sales"), values=c( "Real Wheat Price"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Wheat Price","Auto Sales"), values=c("Real Wheat Price"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Wheat Price","Auto Sales"), values=c("Real Wheat Price"=2,"Auto Sales"=2))
title         <- ggtitle("Real Wheat Price")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$wheat_price/Data$cpi,na.rm = TRUE), max(Data$wheat_price/Data$cpi,na.rm = TRUE), 1),2))
figure_ed5 <- figure_ed5 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed5) + yscale
```

### Real Farm Product Prices {-}

```{r com3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_com3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$real_food, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$real_farmprod, color="Real Farm Product Prices",linetype="Real Farm Product Prices"))

color         <- scale_color_manual(" ", breaks=c("Real Farm Product Prices","Auto Sales"), values=c( "Real Farm Product Prices"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Farm Product Prices","Auto Sales"), values=c("Real Farm Product Prices"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Farm Product Prices","Auto Sales"), values=c("Real Farm Product Prices"=2,"Auto Sales"=2))
title         <- ggtitle("Real Farm Product Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1890-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, NBER, BLS, Farm Product Price Index deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$real_farmprod,na.rm = TRUE), max(Data$real_farmprod,na.rm = TRUE), 10),0))
figure_com3 <- figure_com3 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_com3) + yscale
```

### Real Fuel Prices {-}

```{r com4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_com4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$real_fuel, color="Real Fuel Prices",linetype="Real Fuel Prices"))

color         <- scale_color_manual(" ", breaks=c("Real Fuel Prices","Auto Sales"), values=c( "Real Fuel Prices"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Fuel Prices","Auto Sales"), values=c("Real Fuel Prices"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Fuel Prices","Auto Sales"), values=c("Real Fuel Prices"=2,"Auto Sales"=2))
title         <- ggtitle("Real Fuel Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1890-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$real_fuel,na.rm = TRUE), max(Data$real_fuel,na.rm = TRUE), 10),0))
figure_com4 <- figure_com4 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_com4) + yscale
```

### Real Scrap Steel and Iron Price Index {-}

```{r com5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_com5      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$real_steelironscrap, color="Real Scrap Steel and Iron Price Index",linetype="Real Scrap Steel and Iron Price Index"))

color         <- scale_color_manual(" ", breaks=c("Real Scrap Steel and Iron Price Index","Auto Sales"), values=c( "Real Scrap Steel and Iron Price Index"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Scrap Steel and Iron Price Index","Auto Sales"), values=c("Real Scrap Steel and Iron Price Index"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Scrap Steel and Iron Price Index","Auto Sales"), values=c("Real Scrap Steel and Iron Price Index"=2,"Auto Sales"=2))
title         <- ggtitle("Real Scrap Steel and Iron Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1894-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$real_steelironscrap,na.rm = TRUE), max(Data$real_steelironscrap,na.rm = TRUE), 20),0))
figure_com5 <- figure_com5 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_com5) + yscale
```

### Real Oil Price {-}

```{r ed6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_ed6      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$crude_price/Data$cpi, color="Real Oil Price",linetype="Real Oil Price"))

color         <- scale_color_manual(" ", breaks=c("Real Oil Price","Auto Sales"), values=c( "Real Oil Price"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Oil Price","Auto Sales"), values=c("Real Oil Price"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Oil Price","Auto Sales"), values=c("Real Oil Price"=2,"Auto Sales"=2))
title         <- ggtitle("Real Oil Price")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$crude_price/Data$cpi,na.rm = TRUE), max(Data$crude_price/Data$cpi,na.rm = TRUE), .1),2))
figure_ed6 <- figure_ed6 + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_ed6) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/realoilprice.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Real Textile Price Index  {-}

```{r commtext, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_commtext      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$real_textiles, color="Real Textile Price Index",linetype="Real Textile Price Index"))

color         <- scale_color_manual(" ", breaks=c("Real Textile Price Index","Auto Sales"), values=c( "Real Textile Price Index"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Textile Price Index","Auto Sales"), values=c("Real Textile Price Index"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Textile Price Index","Auto Sales"), values=c("Real Textile Price Index"=2,"Auto Sales"=2))
title         <- ggtitle("Real Textile Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1890-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$real_textiles,na.rm = TRUE), max(Data$real_textiles,na.rm = TRUE), 20),2))
figure_commtext <- figure_commtext + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_commtext) + yscale

```

### Real Lumber Price Index {-}

```{r commlumber, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_commlumber      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$real_lumber, color="Real Lumber Price Index",linetype="Real Lumber Price Index"))

color         <- scale_color_manual(" ", breaks=c("Real Lumber Price Index","Auto Sales"), values=c( "Real Lumber Price Index"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Lumber Price Index","Auto Sales"), values=c("Real Lumber Price Index"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Lumber Price Index","Auto Sales"), values=c("Real Lumber Price Index"=2,"Auto Sales"=2))
title         <- ggtitle("Real Lumber Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$real_lumber,na.rm = TRUE), max(Data$real_lumber,na.rm = TRUE), 20),2))
figure_commlumber <- figure_commlumber + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_commlumber) + yscale


```

### Real Meat Price Index {-}

```{r commMeat, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_commMeat      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$autosales, color="Auto Sales",linetype="Auto Sales"))
g2 <- geom_line(aes(y=Data$meat_price/Data$cpi, color="Real Meat Price Index",linetype="Real Meat Price Index"))

color         <- scale_color_manual(" ", breaks=c("Real Meat Price Index","Auto Sales"), values=c( "Real Meat Price Index"="blue", "Auto Sales"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Meat Price Index","Auto Sales"), values=c("Real Meat Price Index"=1,"Auto Sales"=1))
size          <- scale_size_manual(" ", breaks=c("Real Meat Price Index","Auto Sales"), values=c("Real Meat Price Index"=2,"Auto Sales"=2))
title         <- ggtitle("Real Meat Price Index")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,300, .05),2))
figure_commMeat <- figure_commMeat + g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_commMeat) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/realmeatpi.jpg" ,height = 6.5,width = 11.5,units = "in")

```

## Meat {-}

### U.S. Red-Meat Summary {-}

```{r meatsum, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

meatsum      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$meat_cons/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$meat_prod/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$meat_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$meat_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$meat_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Red-Meat Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,1),1))
vline <- geom_vline(xintercept = as.Date("2015-01-01"),show.legend = TRUE)

meatsum <- meatsum +g1+g2+g3+g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(meatsum) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/meatsummary.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### U.S. Beef & Veal Summary {-}

```{r meatcons, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

meatcons      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$beef_veal_cons/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$beef_veal_prod/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$beef_veal_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$beef_veal_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$beef_veal_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Beef & Veal Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1916-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,1),1))

meatcons <- meatcons +g1+g2+g3+g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(meatcons) + yscale
```

### U.S. Pork Summary {-}

```{r porksumm, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

porksumm      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$pork_cons/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$pork_prod/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$pork_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$pork_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$pork_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Pork Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1916-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita, excludes lard; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,.5),1))

porksumm <- porksumm +g1+g2+g3+g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(porksumm) + yscale
```

### U.S. Beef & Veal and Pork Consumption {-}

```{r meatcons2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

meatcons2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$beef_veal_cons/Data$pop ,color="Beef and Veal",linetype="Beef and Veal"))
g2 <- geom_line(aes(y=Data$pork_cons/Data$pop, color="Pork",linetype="Pork"))
g3 <- geom_line(aes(y=Data$beef_veal_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$beef_veal_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$beef_veal_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Pork","Beef and Veal","Exports","Stocks","Imports"), values=c( "Pork"="blue", "Beef and Veal"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Pork","Beef and Veal","Exports","Stocks","Imports"), values=c("Pork"=1,"Beef and Veal"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Pork","Beef and Veal","Exports","Stocks","Imports"), values=c("Pork"=2,"Beef and Veal"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Beef & Veal and Pork Consumption")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1916-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,1),1))

meatcons2 <- meatcons2 +g1+g2+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(meatcons2) + yscale
```

### U.S. Red Meat Production {-}

```{r meatprod, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

meatprod      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$beef_prod/Data$pop ,color="Beef",linetype="Beef"))
g2 <- geom_line(aes(y=Data$pork_prod/Data$pop, color="Pork",linetype="Pork"))
g3 <- geom_line(aes(y=Data$veal_prod/Data$pop, color="Veal",linetype="Veal"))
g4 <- geom_line(aes(y=(Data$lamb_prod)/Data$pop, color="Lamb",linetype="Lamb"))
g5 <- geom_line(aes(y=Data$beef_veal_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Pork","Beef","Lamb","Veal","Imports"), values=c( "Pork"="blue", "Beef"="red","Lamb" = "black","Veal" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Pork","Beef","Lamb","Veal","Imports"), values=c("Pork"=1,"Beef"=1,"Lamb"=1,"Veal"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Pork","Beef","Lamb","Veal","Imports"), values=c("Pork"=2,"Beef"=2,"Lamb"=2,"Veal"=3,"Imports"=3))
title         <- ggtitle("U.S. Red Meat Production")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1916-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,.5),1))

meatprod <- meatprod +g1+g2+g3+g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(meatprod) + yscale
```

### U.S. Red Meat Stocks {-}

```{r meatstocks, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

meatstocks      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$beef_stocks/Data$pop ,color="Beef",linetype="Beef"))
g2 <- geom_line(aes(y=Data$pork_stocks/Data$pop, color="Pork",linetype="Pork"))
g3 <- geom_line(aes(y=Data$veal_stocks/Data$pop, color="Veal",linetype="Veal"))
g4 <- geom_line(aes(y=(Data$lamb_stocks)/Data$pop, color="Lamb",linetype="Lamb"))
g5 <- geom_line(aes(y=Data$beef_veal_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Pork","Beef","Lamb","Veal","Imports"), values=c( "Pork"="blue", "Beef"="red","Lamb" = "black","Veal" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Pork","Beef","Lamb","Veal","Imports"), values=c("Pork"=1,"Beef"=1,"Lamb"=1,"Veal"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Pork","Beef","Lamb","Veal","Imports"), values=c("Pork"=2,"Beef"=2,"Lamb"=2,"Veal"=3,"Imports"=3))
title         <- ggtitle("U.S. Red Meat Stocks")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1916-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,.5),1),limits = c(0,4))

meatstocks <- meatstocks +g1+g2+g3+g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(meatstocks) + yscale
```

### U.S. Meat Trade {-}

```{r meatrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

meatrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$meat_exp/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$meat_imp/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$coal_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$meat_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$meat_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Meat Trade")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; lbs per capita; Source: USDA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,.25),2))

meatrade <- meatrade +g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(meatrade) + yscale
```

## Copper {-}

### U.S. Refined Copper Summary {-}

```{r Copper_plotsA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Copper_plotsA  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$copper_stocks_refined_metric_tons), color="Stocks",linetype="Stocks"))
g2 <- geom_line(aes(y=Data$copper_exports_refined_metric_tons, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$copper_imports_refined_metric_tons, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$copper_prod_total_refined_metric_tons, color="Production",linetype="Production"))

color         <- scale_color_manual(" ", breaks=c("Exports","Stocks","Production","Imports"), values=c( "Exports"="blue", "Stocks"="red","Production" = "green","Imports" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Stocks","Production","Imports"), values=c("Exports"=1,"Stocks"=1,"Production"=1,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Stocks","Production","Imports"), values=c("Exports"=2,"Stocks"=2,"Production"=2,"Imports"=3))
title         <- ggtitle("U.S. Refined Copper Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1500000, 100000),0))

Copper_plotsA <- Copper_plotsA + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(Copper_plotsA) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/Copper_plotsA.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/Copper_plotsA.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/Copper_plotsA.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "Copper_plotsA.html"))

```

### U.S. Real Copper Price vs. Consumption-to-Stocks Ratio {-}

```{r Copper_plotsB, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Copper_plotsB  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$copper_cons_refined_metric_tons/Data$copper_stocks_refined_metric_tons), color="Consumption-to-Stocks",linetype="Consumption-to-Stocks"))
g2 <- geom_line(aes(y=Data$copper_price/Data$cpi*100, color="Real Copper Price",linetype="Real Copper Price"))
g3 <- geom_line(aes(y=Data$copper_imports_refined_metric_tons, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$copper_prod_total_refined_metric_tons, color="Production",linetype="Production"))

color         <- scale_color_manual(" ", breaks=c("Real Copper Price","Consumption-to-Stocks","Production","Imports"), values=c( "Real Copper Price"="blue", "Consumption-to-Stocks"="red","Production" = "green","Imports" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Copper Price","Consumption-to-Stocks","Production","Imports"), values=c("Real Copper Price"=1,"Consumption-to-Stocks"=1,"Production"=1,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Real Copper Price","Consumption-to-Stocks","Production","Imports"), values=c("Real Copper Price"=2,"Consumption-to-Stocks"=2,"Production"=2,"Imports"=3))
title         <- ggtitle("U.S. Real Copper Price vs. Consumption-to-Stocks Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1953-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons; Refined Copper",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,4, .25),2))

Copper_plotsB <- Copper_plotsB + g1 +g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(Copper_plotsB) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/Copper_plotsB.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/Copper_plotsB.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/Copper_plotsB.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "Copper_plotsB.html"))

```

###  U.S. Copper Production {-}

```{r Copper_plotsC, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Copper_plotsC  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$copper_prod_primary_materials_refined_metric_tons), color="Refined From Primary Materials",linetype="Refined From Primary Materials"))
g2 <- geom_line(aes(y=Data$copper_prod_mine_or_smelter_metric_tons, color="Mine or Smelter",linetype="Mine or Smelter"))
g3 <- geom_line(aes(y=Data$copper_prod_mine_metric_tons, color="Mine Production",linetype="Mine Production"))
g4 <- geom_line(aes(y=Data$copper_prod_scrap_refined_metric_tons, color="Refined Scap Preoduction",linetype="Refined Scap Preoduction"))

color         <- scale_color_manual(" ", breaks=c("Mine or Smelter","Refined From Primary Materials","Refined Scap Preoduction","Mine Production"), values=c( "Mine or Smelter"="blue", "Refined From Primary Materials"="red","Refined Scap Preoduction" = "green","Mine Production" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mine or Smelter","Refined From Primary Materials","Refined Scap Preoduction","Mine Production"), values=c("Mine or Smelter"=1,"Refined From Primary Materials"=1,"Refined Scap Preoduction"=1,"Mine Production"=1))
size          <- scale_size_manual(" ", breaks=c("Mine or Smelter","Refined From Primary Materials","Refined Scap Preoduction","Mine Production"), values=c("Mine or Smelter"=2,"Refined From Primary Materials"=2,"Refined Scap Preoduction"=2,"Mine Production"=3))
title         <- ggtitle("U.S. Copper Production")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1909-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1500000, 25000),0))

Copper_plotsC <- Copper_plotsC + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(Copper_plotsC) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/Copper_plotsC.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/Copper_plotsC.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/Copper_plotsC.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "Copper_plotsC.html"))

```

### U.S. Refined Copper Stocks and Consumption {-}

```{r Copper_plotsD, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

Copper_plotsD  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$copper_stocks_refined_metric_tons), color="Stocks",linetype="Stocks"))
g2 <- geom_line(aes(y=Data$copper_exports_refined_metric_tons, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$copper_imports_refined_metric_tons, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$copper_cons_refined_metric_tons, color="Consumption",linetype="Consumption"))

color         <- scale_color_manual(" ", breaks=c("Exports","Stocks","Consumption","Imports"), values=c( "Exports"="blue", "Stocks"="red","Consumption" = "green","Imports" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Stocks","Consumption","Imports"), values=c("Exports"=1,"Stocks"=1,"Consumption"=1,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Stocks","Consumption","Imports"), values=c("Exports"=2,"Stocks"=2,"Consumption"=2,"Imports"=3))
title         <- ggtitle("U.S. Refined Copper Stocks and Consumption")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1951-12-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1500000, 100000),0))

Copper_plotsD <- Copper_plotsD + g1+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(Copper_plotsD) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/Copper_plotsD.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/Copper_plotsD.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/Copper_plotsD.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "Copper_plotsD.html"))

```

## Iron and Steel {-}

###  U.S. Iron and Steel Scrap Summary {-}

```{r iron_plotsA, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

iron_plotsA  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$iron_and_steel_scrap_stocks, color="Stocks",linetype="Stocks"))
g2 <- geom_line(aes(y=Data$iron_and_steel_scrap_net_receipts, color="Net Receipts",linetype="Net Receipts"))
g3 <- geom_line(aes(y=Data$iron_and_steel_scrap_consumption, color="Consumption",linetype="Consumption"))
g4 <- geom_line(aes(y=Data$iron_and_steel_scrap_prod, color="Production",linetype="Production"))

color         <- scale_color_manual(" ", breaks=c("Net Receipts","Stocks","Production","Consumption"), values=c( "Net Receipts"="blue", "Stocks"="red","Production" = "green","Consumption" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Net Receipts","Stocks","Production","Consumption"), values=c("Net Receipts"=1,"Stocks"=1,"Production"=1,"Consumption"=1))
size          <- scale_size_manual(" ", breaks=c("Net Receipts","Stocks","Production","Consumption"), values=c("Net Receipts"=2,"Stocks"=2,"Production"=2,"Consumption"=3))
title         <- ggtitle("U.S. Iron and Steel Scrap Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons; Source: USGS",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,15000, 1000),0))

iron_plotsA <- iron_plotsA + g1 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(iron_plotsA) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/iron_plotsA.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/iron_plotsA.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/iron_plotsA.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "iron_plotsA.html"))

```

### U.S. Real Iron and Steel Scrap Price vs. Consumption-to-Stocks Ratio {-}

```{r iron_plotsB, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

iron_plotsB  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$iron_and_steel_scrap_consumption/Data$iron_and_steel_scrap_stocks), color="Consumption-to-Stocks",linetype="Consumption-to-Stocks"))
g2 <- geom_line(aes(y=Data$steelironscrap/Data$cpi, color="Real Iron and Steel Scrap Price",linetype="Real Iron and Steel Scrap Price"))
g3 <- geom_line(aes(y=Data$copper_imports_refined_metric_tons, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$copper_prod_total_refined_metric_tons, color="Production",linetype="Production"))

color         <- scale_color_manual(" ", breaks=c("Real Iron and Steel Scrap Price","Consumption-to-Stocks","Production","Imports"), values=c( "Real Iron and Steel Scrap Price"="blue", "Consumption-to-Stocks"="red","Production" = "green","Imports" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Iron and Steel Scrap Price","Consumption-to-Stocks","Production","Imports"), values=c("Real Iron and Steel Scrap Price"=1,"Consumption-to-Stocks"=1,"Production"=1,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Real Iron and Steel Scrap Price","Consumption-to-Stocks","Production","Imports"), values=c("Real Iron and Steel Scrap Price"=2,"Consumption-to-Stocks"=2,"Production"=2,"Imports"=3))
title         <- ggtitle("U.S. Real Iron and Steel Scrap Price vs. Consumption-to-Stocks Ratio")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,6, .25),2))

iron_plotsB <- iron_plotsB + g1 +g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(iron_plotsB) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/iron_plotsB.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/iron_plotsB.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/iron_plotsB.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "iron_plotsB.html"))

```

### U.S. Pig Iron Summary {-}

```{r iron_plotsC, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

iron_plotsC  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$pig_iron_consumption), color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$pig_iron_production, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$pig_iron_stocks, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$copper_prod_scrap_refined_metric_tons, color="Refined Scap Preoduction",linetype="Refined Scap Preoduction"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Refined Scap Preoduction","Stocks"), values=c( "Production"="blue", "Consumption"="red","Refined Scap Preoduction" = "green","Stocks" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Refined Scap Preoduction","Stocks"), values=c("Production"=1,"Consumption"=1,"Refined Scap Preoduction"=1,"Stocks"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Refined Scap Preoduction","Stocks"), values=c("Production"=2,"Consumption"=2,"Refined Scap Preoduction"=2,"Stocks"=3))
title         <- ggtitle("U.S. Pig Iron Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1872-12-01"), as.Date("2021-12-01")), date_breaks = "6 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,15000, 500),0))

iron_plotsC <- iron_plotsC + g1 +g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(iron_plotsC) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/iron_plotsC.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/iron_plotsC.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/iron_plotsC.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "iron_plotsC.html"))

```

### U.S. Raw Steel Production {-}

```{r iron_plotsD, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

iron_plotsD  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$raw_steel_prod, color="Stocks",linetype="Stocks"))
g2 <- geom_line(aes(y=Data$copper_exports_refined_metric_tons, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$copper_imports_refined_metric_tons, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$copper_cons_refined_metric_tons, color="Consumption",linetype="Consumption"))

color         <- scale_color_manual(" ", breaks=c("Exports","Stocks","Consumption","Imports"), values=c( "Exports"="blue", "Stocks"="blue","Consumption" = "green","Imports" ="black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Stocks","Consumption","Imports"), values=c("Exports"=1,"Stocks"=1,"Consumption"=1,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Stocks","Consumption","Imports"), values=c("Exports"=2,"Stocks"=2,"Consumption"=2,"Imports"=3))
title         <- ggtitle("U.S. Raw Steel Production")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Metric Tons",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,15000, 1000),0))

iron_plotsD <- iron_plotsD + g1+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(iron_plotsD) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogpostspdfs/iron_plotsD.pdf" ,height = 6.5,width = 11.5,units = "in")
#ggsave("C:/Users/sabol/Google Drive/blogposts/iron_plotsD.jpg" ,height = 6.5,width = 11.5,units = "in")

# Status <- paste(title$title,"Download the data at","https://rb.gy/veqlb1",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/iron_plotsD.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )

#d <- "C:/Users/sabol/Google Drive/blogpostshtml/"
#withr::with_dir(d, htmlwidgets::saveWidget(partial_bundle(p), "iron_plotsD.html"))

```

## Energy {-}

### U.S. Electricity Revenue-to-GDP {-}

```{r electric1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_electric1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$electric_revenue/Data$ngdpm, color="Electricity Revenue-to-GDP",linetype="Electricity Revenue-to-GDP"))
g2 <- geom_line(aes(y=Data$nx_x_oil_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Electricity Revenue-to-GDP"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "Electricity Revenue-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Electricity Revenue-to-GDP"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"Electricity Revenue-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Electricity Revenue-to-GDP"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"Electricity Revenue-to-GDP"=2))
title         <- ggtitle("U.S. Electricity Revenue-to-GDP ")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, EIA, SA")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1, .002),3))
figure_electric1 <- figure_electric1 +g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_electric1) + yscale

```

### Electricity: $kw hour {-}

```{r electric2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_electric2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$electric_revenue/Data$electric_prod/1000, color="$/kw hour",linetype="$/kw hour"))
g2 <- geom_line(aes(y=Data$nx_x_oil_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","$/kw hour"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "$/kw hour"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","$/kw hour"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"$/kw hour"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","$/kw hour"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"$/kw hour"=2))
title         <- ggtitle("Electricity: $/kw hour ")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, EIA, SA")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1, .01),2))

figure_electric2 <- figure_electric2 +g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_electric2) + yscale

```

### Electricity Net Generation of The Electric Power Sector {-}

```{r electric3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_electric3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$electric_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$nx_x_oil_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Production"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "Production"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Production"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"Production"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Production"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"Production"=2))
title         <- ggtitle("U.S. Electricity: Electricity Net Generation of The Electric Power Sector")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, EIA, SA, Billion Kilowatthours")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000000,25 ),0))

figure_electric3 <- figure_electric3 +g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_electric3) + yscale

```

###  Electricity: Real Revenue per capita {-}

```{r electric4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_electric4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=(Data$electric_revenue*1000)/Data$pop/Data$cpi*100, color="Revenue",linetype="Revenue"))
g2 <- geom_line(aes(y=Data$nx_x_oil_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Revenue"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "Revenue"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Revenue"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"Revenue"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Revenue"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"Revenue"=2))
title         <- ggtitle("Electricity: Real Revenue per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1912-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, EIA, SA, deflated by CPI")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,40000,2),1))

figure_electric4 <- figure_electric4 +g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_electric4) + yscale

```

### U.S. Refinery Operations {-}

```{r oil2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_oil2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("Percent of Capacity")
g1 <- geom_line(aes(y=Data$refining_cu_sa, color="Refinery Operations",linetype="Refinery Operations"))
g2 <- geom_line(aes(y=Data$nx_x_oil_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Refinery Operations"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "Refinery Operations"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Refinery Operations"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"Refinery Operations"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Refinery Operations"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"Refinery Operations"=2))
title         <- ggtitle("U.S. Refinery Operations ")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1925-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, EIA, Percent of Capacity, SA")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$refining_cu_sa,na.rm = TRUE), max(Data$refining_cu_sa,na.rm = TRUE), 5),0))
figure_oil2 <- figure_oil2 +g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_oil2) + yscale

```

###  U.S. Domestic Crude Oil Consumption-to-Domestic Stocks and The Real Oil Price {-}

```{r oil4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_oil4      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$crude_cons_sa/Data$crude_stocks, color="Crude Oil Consumption-to-Stocks",linetype="Crude Oil Consumption-to-Stocks"))
g2 <- geom_line(aes(y=Data$crude_price/Data$cpi*2, color="Real Oil Price / 50",linetype="Real Oil Price / 50"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Real Oil Price / 50","Crude Oil Consumption-to-Stocks"), values=c( "Real Oil Price / 50"="blue", "Crude Oil Consumption-to-Stocks"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Oil Price / 50","Crude Oil Consumption-to-Stocks"), values=c("Real Oil Price / 50"=1,"Crude Oil Consumption-to-Stocks"=1))
size          <- scale_size_manual(" ", breaks=c("Real Oil Price / 50","Crude Oil Consumption-to-Stocks"), values=c("Real Oil Price / 50"=2,"Crude Oil Consumption-to-Stocks"=2))
title         <- ggtitle("U.S. Domestic Crude Oil Consumption-to-Domestic Stocks and The Real Oil Price")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.975), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, EIA, SA")

vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)


yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$crude_price/Data$cpi*2,na.rm = TRUE), max(Data$crude_cons_sa/Data$crude_stocks,na.rm = TRUE), .1),1))
figure_oil4 <- figure_oil4 +g1 + g2+color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs

nberShade(figure_oil4) + yscale

```

### U.S. Retail Gasoline Station Sales-to-Personal Income {-}

```{r oil5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_oil5      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$gas_stations/Data$pi, color="Motor Fuel Consumption-to-Personal Income",linetype="Motor Fuel Consumption-to-Personal Income"))
g2 <- geom_line(aes(y=Data$motorfuel_cons_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Motor Fuel Consumption-to-Personal Income"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "Motor Fuel Consumption-to-Personal Income"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Motor Fuel Consumption-to-Personal Income"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"Motor Fuel Consumption-to-Personal Income"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Motor Fuel Consumption-to-Personal Income"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"Motor Fuel Consumption-to-Personal Income"=2))
title         <- ggtitle("U.S. Retail Gasoline Station Sales-to-Personal Income")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1937-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data, SA")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$gas_stations/Data$pi,na.rm = TRUE), max(Data$gas_stations/Data$pi,na.rm = TRUE), .005),3))
figure_oil5 <- figure_oil5 +g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_oil5) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/motorfuelconsump.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### U.S. Petroleum and Products Summary  {-}

```{r fuelssumm, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fuelssumm      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fuel_cons/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$fuel_prod/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$fuel_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$fuel_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$fuel_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Petroleum and Products Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1930-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Sum of Crude Oil, Distillate, Residual, and Finished Motor Gasoline; Barrels per capita; Source: EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,5.5, .5),1))

fuelssumm <- fuelssumm +g4+g1+g2+g3 +g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fuelssumm) + yscale
```

###  U.S. Real Gasoline, Distillate and Residual Fuel Oil Prices {-}

```{r gasprices, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

gasprices      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gas_refinary/Data$cpi*100, color="Total Gasoline Wholesale/Resale Price by Refiners",linetype="Total Gasoline Wholesale/Resale Price by Refiners"))
g2 <- geom_line(aes(y=Data$gas_ny_spot/Data$cpi*100, color="New York Harbor Conventional Gasoline Regular Spot Price FOB",linetype="New York Harbor Conventional Gasoline Regular Spot Price FOB"))
g3 <- geom_line(aes(y=Data$gas_retail/Data$cpi*100, color="U.S. All Grades All Formulations Retail Gasoline Price",linetype="U.S. All Grades All Formulations Retail Gasoline Price"))
g4 <- geom_line(aes(y=Data$distillate_price/Data$cpi*100, color="New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price",linetype="New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price"))
g5 <- geom_line(aes(y=Data$residual_price/Data$cpi*100, color="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners",linetype="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"))

color         <- scale_color_manual(" ", breaks=c("New York Harbor Conventional Gasoline Regular Spot Price FOB","Total Gasoline Wholesale/Resale Price by Refiners","New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price","U.S. All Grades All Formulations Retail Gasoline Price","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c( "New York Harbor Conventional Gasoline Regular Spot Price FOB"="blue", "Total Gasoline Wholesale/Resale Price by Refiners"="red","New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price" = "black","U.S. All Grades All Formulations Retail Gasoline Price" ="purple","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("New York Harbor Conventional Gasoline Regular Spot Price FOB","Total Gasoline Wholesale/Resale Price by Refiners","New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price","U.S. All Grades All Formulations Retail Gasoline Price","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("New York Harbor Conventional Gasoline Regular Spot Price FOB"=1,"Total Gasoline Wholesale/Resale Price by Refiners"=1,"New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price"=1,"U.S. All Grades All Formulations Retail Gasoline Price"=2,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=1))
size          <- scale_size_manual(" ", breaks=c("New York Harbor Conventional Gasoline Regular Spot Price FOB","Total Gasoline Wholesale/Resale Price by Refiners","New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price","U.S. All Grades All Formulations Retail Gasoline Price","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("New York Harbor Conventional Gasoline Regular Spot Price FOB"=2,"Total Gasoline Wholesale/Resale Price by Refiners"=2,"New York Harbor Ultra-Low Sulfur No 2 Diesel Spot Price"=2,"U.S. All Grades All Formulations Retail Gasoline Price"=3,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=3))
title         <- ggtitle("U.S. Real Gasoline, Distillate and Residual Fuel Oil Prices")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Prices deflated by CPI, EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$gas_ny_spot/Data$cpi*100,na.rm = TRUE), max(Data$gas_ny_spot/Data$cpi*100,na.rm = TRUE), .25),2))

gasprices <- gasprices +g4+g1+g2+g3+g5 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(gasprices) + yscale
```

### U.S. Petroleum and Products Production {-}

```{r fuelprodplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fuelprodplot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gas_prod, color="Finished Motor Gasoline",linetype="Finished Motor Gasoline"))
g2 <- geom_line(aes(y=Data$distillate_prod, color="Distillate Fuel Oil",linetype="Distillate Fuel Oil"))
g3 <- geom_line(aes(y=Data$residual_prod, color="Residual Fuel Oil",linetype="Residual Fuel Oil"))
g4 <- geom_line(aes(y=Data$crude_prod, color="Crude Oil",linetype="Crude Oil"))
g5 <- geom_line(aes(y=Data$residual_price/Data$cpi*100, color="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners",linetype="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"))

color         <- scale_color_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c( "Distillate Fuel Oil"="blue", "Finished Motor Gasoline"="red","Crude Oil" = "black","Residual Fuel Oil" ="purple","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("Distillate Fuel Oil"=1,"Finished Motor Gasoline"=1,"Crude Oil"=1,"Residual Fuel Oil"=2,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=1))
size          <- scale_size_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("Distillate Fuel Oil"=2,"Finished Motor Gasoline"=2,"Crude Oil"=2,"Residual Fuel Oil"=3,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=3))
title         <- ggtitle("U.S. Petroleum and Products Production")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Thousands of Barrels, EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 1000000, 50000),0))

fuelprodplot <- fuelprodplot +g4+g1+g2+g3 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fuelprodplot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/petrolproductsprod1.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### U.S. Petroleum and Product Consumption per capita {-}

```{r fuelconsplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fuelconsplot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gas_cons/Data$pop, color="Finished Motor Gasoline",linetype="Finished Motor Gasoline"))
g2 <- geom_line(aes(y=Data$distillate_cons/Data$pop, color="Distillate Fuel Oil",linetype="Distillate Fuel Oil"))
g3 <- geom_line(aes(y=Data$residual_cons/Data$pop, color="Residual Fuel Oil",linetype="Residual Fuel Oil"))
g4 <- geom_line(aes(y=Data$crude_cons/Data$pop, color="Crude Oil",linetype="Crude Oil"))
g5 <- geom_line(aes(y=Data$residual_price/Data$cpi*100, color="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners",linetype="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"))

color         <- scale_color_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c( "Distillate Fuel Oil"="blue", "Finished Motor Gasoline"="red","Crude Oil" = "black","Residual Fuel Oil" ="purple","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("Distillate Fuel Oil"=1,"Finished Motor Gasoline"=1,"Crude Oil"=1,"Residual Fuel Oil"=2,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=1))
size          <- scale_size_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("Distillate Fuel Oil"=2,"Finished Motor Gasoline"=2,"Crude Oil"=2,"Residual Fuel Oil"=3,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=3))
title         <- ggtitle("U.S. Petroleum and Product Consumption per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Per Capita, EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 2.2, .25),2),limits = c(0,2.2))

fuelconsplot <- fuelconsplot +g4+g1+g2+g3 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fuelconsplot) + yscale
```

### U.S. Petroleum and Product Stocks per capita {-}

```{r fuelstocksplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fuelstocksplot      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gas_stocks/Data$pop, color="Finished Motor Gasoline",linetype="Finished Motor Gasoline"))
g2 <- geom_line(aes(y=Data$distillate_stocks/Data$pop, color="Distillate Fuel Oil",linetype="Distillate Fuel Oil"))
g3 <- geom_line(aes(y=Data$residual_stocks/Data$pop, color="Residual Fuel Oil",linetype="Residual Fuel Oil"))
g4 <- geom_line(aes(y=Data$crude_stocks/Data$pop, color="Crude Oil",linetype="Crude Oil"))
g5 <- geom_line(aes(y=Data$residual_price/Data$cpi*100, color="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners",linetype="U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"))

color         <- scale_color_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c( "Distillate Fuel Oil"="blue", "Finished Motor Gasoline"="red","Crude Oil" = "black","Residual Fuel Oil" ="purple","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("Distillate Fuel Oil"=1,"Finished Motor Gasoline"=1,"Crude Oil"=1,"Residual Fuel Oil"=2,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=1))
size          <- scale_size_manual(" ", breaks=c("Distillate Fuel Oil","Finished Motor Gasoline","Crude Oil","Residual Fuel Oil","U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"), values=c("Distillate Fuel Oil"=2,"Finished Motor Gasoline"=2,"Crude Oil"=2,"Residual Fuel Oil"=3,"U.S. Residual Fuel Oil Wholesale/Resale Price by Refiners"=3))
title         <- ggtitle("U.S. Petroleum and Product Stocks per capita")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.40, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Barrels Per Capita, EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0, 4.5, .5),2),limits = c(0,4.5))

fuelstocksplot <- fuelstocksplot +g4+g1+g2+g3 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fuelstocksplot) + yscale
```

### U.S. Coal Summary {-}

```{r coalsummary, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

coalsummary      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$coal_cons/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$coal_prod/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$coal_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$coal_exp/Data$pop, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$coal_imp/Data$pop, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Coal Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Short-tons per capita; Source: EIA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,5.5, .1),1))

coalsummary <- coalsummary +g4+g1+g2+g3 +g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(coalsummary) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/coalsummary.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### U.S. Coal Trade {-}

```{r coaltrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

coaltrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$coal_cons/Data$pop ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$coal_prod/Data$pop, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$coal_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$coal_exp, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$coal_imp, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Coal Trade")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Short-tons; Source: EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,18000,2000),1))

coaltrade <- coaltrade +g4+g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(coaltrade) + yscale
```

### U.S. Coal Consumption and Production {-}

```{r coalprod, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

coalprod      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$coal_cons/1000 ,color="Consumption",linetype="Consumption"))
g2 <- geom_line(aes(y=Data$coal_prod/1000, color="Production",linetype="Production"))
g3 <- geom_line(aes(y=Data$coal_stocks/Data$pop, color="Stocks",linetype="Stocks"))
g4 <- geom_line(aes(y=Data$coal_exp, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$coal_imp, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c( "Production"="blue", "Consumption"="red","Exports" = "black","Stocks" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=1,"Consumption"=1,"Exports"=1,"Stocks"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Production","Consumption","Exports","Stocks","Imports"), values=c("Production"=2,"Consumption"=2,"Exports"=2,"Stocks"=3,"Imports"=3))
title         <- ggtitle("U.S. Coal Consumption and Production")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1923-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Millions of Short-tons; Source: EIA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,2000,20),1))

coalprod <- coalprod +g2+g1+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(coalprod) + yscale
```

## Tobacco {-}

### U.S. Cigarette Summary {-}

```{r tobac_cigarette_summary_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tobac_cigarette_summary_plot1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$tobac_cigarette_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$tobac_cigarette_exports, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$tobac_cigarette_imports, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$tobac_cigarette_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
g5 <- geom_line(aes(y=Data$tobac_cigarettes_tax_free_withdrawals, color="Tax-Exempt Withdrawals",linetype="Tax-Exempt Withdrawals"))

color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Imports" ="purple","Tax-Exempt Withdrawals" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Imports"=2,"Tax-Exempt Withdrawals"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Imports"=3,"Tax-Exempt Withdrawals"=3))
title         <- ggtitle("U.S. Cigarette Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000000000000,10000000000),0))
vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
tobac_cigarette_summary_plot1 <- tobac_cigarette_summary_plot1 +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tobac_cigarette_summary_plot1) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_cigarette_summary_plot1.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_cigarette_summary_plot1.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("tobac_cigarette_summary_plot1.jpg")
```

### U.S. Cigarette Summary: Imports, Exports, and Tax-Exempt Removals {-}

```{r tobac_cigarette_summary_plot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tobac_cigarette_summary_plot2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$tobac_cigarette_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$tobac_cigarette_exports, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$tobac_cigarette_imports, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$tobac_cigarette_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
g5 <- geom_line(aes(y=Data$tobac_cigarettes_tax_free_withdrawals, color="Tax-Exempt Withdrawals",linetype="Tax-Exempt Withdrawals"))

color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Imports" ="purple","Tax-Exempt Withdrawals" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Imports"=2,"Tax-Exempt Withdrawals"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Imports"=3,"Tax-Exempt Withdrawals"=3))
title         <- ggtitle("U.S. Cigarette Summary: Imports, Exports, and Tax-Exempt Removals")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1920-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000000000000,1000000000),0))
vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
tobac_cigarette_summary_plot2 <- tobac_cigarette_summary_plot2 +g2+g3+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tobac_cigarette_summary_plot2) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_cigarette_summary_plot2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_cigarette_summary_plot2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("tobac_cigarette_summary_plot2.jpg")
```

### U.S. Small Cigars Summary {-}

```{r tobac_small_cigars_summary_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tobac_small_cigars_summary_plot1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$tobac_small_cigars_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$tobac_small_cigar_imports, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$tobac_small_cigar_imports, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$tobac_cigars_small_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
g5 <- geom_line(aes(y=Data$tobac_small_cigar_tax_exempt_withdrawals, color="Tax-Exempt Withdrawals",linetype="Tax-Exempt Withdrawals"))

color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Imports" ="purple","Tax-Exempt Withdrawals" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Imports"=2,"Tax-Exempt Withdrawals"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Imports"=3,"Tax-Exempt Withdrawals"=3))
title         <- ggtitle("U.S. Small Cigars Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000000000,100000000),0))
vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
tobac_small_cigars_summary_plot1 <- tobac_small_cigars_summary_plot1 +g1+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tobac_small_cigars_summary_plot1) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_small_cigars_summary_plot1.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_small_cigars_summary_plot1.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("tobac_small_cigars_summary_plot1.jpg")
```

### U.S. Small Cigars Summary: Imports, Exports, and Tax-Exempt Removals For Consumption {-}

```{r tobac_small_cigars_summary_plot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tobac_small_cigars_summary_plot2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$tobac_small_cigars_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$tobac_tax_exempt_export_small_cigars, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$tobac_small_cigar_imports, color="Imports",linetype="Imports"))
g4 <- geom_line(aes(y=Data$tobac_tax_exempt_export_personal_consumption_experimental_small_cigars, color="Tax-Exempt Personal Consumption",linetype="Tax-Exempt Personal Consumption"))
g5 <- geom_line(aes(y=Data$tobac_small_cigar_tax_exempt_withdrawals, color="Tax-Exempt Withdrawals",linetype="Tax-Exempt Withdrawals"))

color         <- scale_color_manual(" ", breaks=c("Exports","Production","Tax-Exempt Personal Consumption","Imports","Tax-Exempt Withdrawals"), values=c( "Exports"="blue", "Production"="red","Tax-Exempt Personal Consumption" = "black","Imports" ="purple","Tax-Exempt Withdrawals" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Tax-Exempt Personal Consumption","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=1,"Production"=1,"Tax-Exempt Personal Consumption"=1,"Imports"=2,"Tax-Exempt Withdrawals"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Production","Tax-Exempt Personal Consumption","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=2,"Production"=2,"Tax-Exempt Personal Consumption"=2,"Imports"=3,"Tax-Exempt Withdrawals"=3))
title         <- ggtitle("U.S. Small Cigars Summary: Imports, Exports, and Tax-Exempt Removals for Consumption")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1960-01-01"), as.Date("2021-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,100000000,10000000),0))
vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
tobac_small_cigars_summary_plot2 <- tobac_small_cigars_summary_plot2 +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tobac_small_cigars_summary_plot2) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_small_cigars_summary_plot2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_small_cigars_summary_plot2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("tobac_small_cigars_summary_plot2.jpg")
```

### U.S. Large Cigars Summary {-}

```{r tobac_large_cigars_summary_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tobac_large_cigars_summary_plot1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$tobac_large_cigars_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$tobac_tax_exempt_export_large_cigars, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$tobac_large_cigars_premium_imports, color="Premium Cigar Imports",linetype="Premium Cigar Imports"))
g4 <- geom_line(aes(y=Data$tobac_large_cigars_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
g5 <- geom_line(aes(y=Data$tobac_large_cigar_cheap_imports, color="Cheap Cigar Imports",linetype="Cheap Cigar Imports"))

color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Premium Cigar Imports","Cheap Cigar Imports"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Premium Cigar Imports" ="purple","Cheap Cigar Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Premium Cigar Imports","Cheap Cigar Imports"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Premium Cigar Imports"=2,"Cheap Cigar Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Premium Cigar Imports","Cheap Cigar Imports"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Premium Cigar Imports"=3,"Cheap Cigar Imports"=3))
title         <- ggtitle("U.S. Large Cigars Summary")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1915-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000000000,100000000),0))
vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
tobac_large_cigars_summary_plot1 <- tobac_large_cigars_summary_plot1 +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tobac_large_cigars_summary_plot1) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_large_cigars_summary_plot1.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_large_cigars_summary_plot1.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("tobac_large_cigars_summary_plot1.jpg")
```

### Premium Cigar Imports {-}

```{r tobac_large_cigars_summary_plot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tobac_large_cigars_summary_plot2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$tobac_large_cigars_prod, color="Production",linetype="Production"))
g2 <- geom_line(aes(y=Data$tobac_tax_exempt_export_large_cigars, color="Exports",linetype="Exports"))
g3 <- geom_line(aes(y=Data$tobac_large_cigars_premium_imports, color="Premium Cigar Imports",linetype="Premium Cigar Imports"))
g4 <- geom_line(aes(y=Data$tobac_cigars_large_g763_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
g5 <- geom_line(aes(y=Data$tobac_large_cigar_cheap_imports, color="Cheap Cigar Imports",linetype="Cheap Cigar Imports"))

color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Premium Cigar Imports","Cheap Cigar Imports"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Premium Cigar Imports" ="purple","Cheap Cigar Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Premium Cigar Imports","Cheap Cigar Imports"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Premium Cigar Imports"=2,"Cheap Cigar Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Premium Cigar Imports","Cheap Cigar Imports"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Premium Cigar Imports"=3,"Cheap Cigar Imports"=3))
title         <- ggtitle("Premium Cigar Imports")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1984-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,10000000000,10000000),0))
vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
tobac_large_cigars_summary_plot2 <- tobac_large_cigars_summary_plot2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(tobac_large_cigars_summary_plot2) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_large_cigars_summary_plot2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_large_cigars_summary_plot2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("tobac_large_cigars_summary_plot2.jpg")
```

```{r tobac_manufactured_tobac_summary_plot1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
# ### U.S. Manufactured Tobacco Summary {-}
# 
# tobac_manufactured_tobac_summary_plot1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$tobac_snuff_prod, color="Production",linetype="Production"))
# g2 <- geom_line(aes(y=Data$tobac_chewing_tobacco_prod, color="Exports",linetype="Exports"))
# g3 <- geom_line(aes(y=Data$tobac_pipe_tobacco_prod, color="Imports",linetype="Imports"))
# g4 <- geom_line(aes(y=Data$tobac_chewing_tobacco_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
# g5 <- geom_line(aes(y=Data$tobac_cigarettes_tax_free_withdrawals, color="Tax-Exempt Withdrawals",linetype="Tax-Exempt Withdrawals"))
# 
# color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Imports" ="purple","Tax-Exempt Withdrawals" = "green"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Imports"=2,"Tax-Exempt Withdrawals"=1))
# size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Imports"=3,"Tax-Exempt Withdrawals"=3))
# title         <- ggtitle("U.S. Manufactured Tobacco Summary")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1915-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000000000000,10000000000),0))
# vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
# tobac_manufactured_tobac_summary_plot1 <- tobac_manufactured_tobac_summary_plot1 +g1+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs
# 
# nberShade(tobac_manufactured_tobac_summary_plot1) + yscale
# 
# # #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_manufactured_tobac_summary_plot1.jpg" ,height = 6.5,width = 11.5,units = "in")
# # Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# # media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_manufactured_tobac_summary_plot1.jpg"
# # tw <- updateStatus(Status, mediaPath = media_path )
# # unlink("tobac_manufactured_tobac_summary_plot1.jpg")
```

```{r tobac_manufactured_tobac_summary_plot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
# ### U.S. Manufactured Tobacco Summary: Imports, Exports, and Tax-Exempt Removals {-}
# 
# tobac_manufactured_tobac_summary_plot2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
# g1 <- geom_line(aes(y=Data$tobac_manufactured_tobac_prod, color="Production",linetype="Production"))
# g2 <- geom_line(aes(y=Data$tobac_manufactured_tobac_exports, color="Exports",linetype="Exports"))
# g3 <- geom_line(aes(y=Data$tobac_manufactured_tobac_imports, color="Imports",linetype="Imports"))
# g4 <- geom_line(aes(y=Data$tobac_manufactured_tobac_taxable_withdrawals, color="Taxable Withdrawals",linetype="Taxable Withdrawals"))
# g5 <- geom_line(aes(y=Data$tobac_cigarettes_tax_free_withdrawals, color="Tax-Exempt Withdrawals",linetype="Tax-Exempt Withdrawals"))
# 
# color         <- scale_color_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c( "Exports"="blue", "Production"="red","Taxable Withdrawals" = "black","Imports" ="purple","Tax-Exempt Withdrawals" = "green"))
# linetype      <- scale_linetype_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=1,"Production"=1,"Taxable Withdrawals"=1,"Imports"=2,"Tax-Exempt Withdrawals"=1))
# size          <- scale_size_manual(" ", breaks=c("Exports","Production","Taxable Withdrawals","Imports","Tax-Exempt Withdrawals"), values=c("Exports"=2,"Production"=2,"Taxable Withdrawals"=2,"Imports"=3,"Tax-Exempt Withdrawals"=3))
# title         <- ggtitle("U.S. Manufactured Tobacco Summary: Imports, Exports, and Tax-Exempt Removals")
# text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
# Date_opts     <- scale_x_date(limits = c(as.Date("1920-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
# leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
# sub_labs <- labs(subtitle="Capital Markets Data, Sources: number")
# yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,1000000000000,1000000000),0))
# vline <- geom_vline(xintercept = as.Date("1915-01-01"),show.legend = TRUE)
# tobac_manufactured_tobac_summary_plot2 <- tobac_manufactured_tobac_summary_plot2 +g2+g3+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs
# 
# nberShade(tobac_manufactured_tobac_summary_plot2) + yscale
# 
# # #ggsave("C:/Users/sabol/Google Drive/blogposts/tobac_manufactured_tobac_summary_plot2.jpg" ,height = 6.5,width = 11.5,units = "in")
# # Status <- paste(title$title,"#abs_auto","#economics","#macro","#delinquencies",sep = " ")
# # media_path <- "C:/Users/sabol/Google Drive/blogposts/tobac_manufactured_tobac_summary_plot2.jpg"
# # tw <- updateStatus(Status, mediaPath = media_path )
# # unlink("tobac_manufactured_tobac_summary_plot2.jpg")
```

## Vitality {-}

### U.S. Marriages {-}

```{r marriage_fig, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

marriage_fig      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$marriage_nsa ,color="Marriages NSA",linetype="Marriages NSA"))
g2 <- geom_line(aes(y=Data$marriages_ann, color="Marriages Annual",linetype="Marriages Annual"))
g3 <- geom_line(aes(y=Data$home_starts_total_nsa, color="Housing Starts",linetype="Housing Starts"))
g4 <- geom_line(aes(y=Data$coal_exp, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$coal_imp, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Exports","Housing Starts","Imports"), values=c( "Marriages Annual"="blue", "Marriages NSA"="red","Exports" = "black","Housing Starts" ="purple","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Exports","Housing Starts","Imports"), values=c("Marriages Annual"=1,"Marriages NSA"=1,"Exports"=1,"Housing Starts"=2,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Exports","Housing Starts","Imports"), values=c("Marriages Annual"=2,"Marriages NSA"=2,"Exports"=2,"Housing Starts"=3,"Imports"=3))
title         <- ggtitle("U.S. Marriages")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1867-12-01"), as.Date("2021-12-01")), date_breaks = "10 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Number; Source: CDC")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,300000,25000),0))

marriage_fig <- marriage_fig +g2+g1+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(marriage_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/marriage_1867.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### U.S. Marriages and Housing Starts {-}
```{r marriage_fig2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

marriage_fig2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$marriage_nsa ,color="Marriages NSA",linetype="Marriages NSA"))
g2 <- geom_line(aes(y=Data$marriages_ann, color="Marriages Annual",linetype="Marriages Annual"))
g3 <- geom_line(aes(y=Data$home_starts_total_nsa, color="Housing Starts",linetype="Housing Starts"))
g4 <- geom_line(aes(y=Data$coal_exp, color="Exports",linetype="Exports"))
g5 <- geom_line(aes(y=Data$coal_imp, color="Imports",linetype="Imports"))

color         <- scale_color_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Exports","Housing Starts","Imports"), values=c( "Marriages Annual"="blue", "Marriages NSA"="red","Exports" = "black","Housing Starts" ="black","Imports" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Exports","Housing Starts","Imports"), values=c("Marriages Annual"=1,"Marriages NSA"=1,"Exports"=1,"Housing Starts"=1,"Imports"=1))
size          <- scale_size_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Exports","Housing Starts","Imports"), values=c("Marriages Annual"=2,"Marriages NSA"=2,"Exports"=2,"Housing Starts"=3,"Imports"=3))
title         <- ggtitle("U.S. Marriages and Housing Starts")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1952-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Number; Source: CDC and Census")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,300000,25000),0))

marriage_fig2 <- marriage_fig2 +g2+g1+g3+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(marriage_fig2) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/marriage_recent.jpg" ,height = 6.5,width = 11.5,units = "in")

```

###  U.S. Live Birth and Death Rates {-}
```{r deaths_fig1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

deaths_fig1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$deaths_nsa/Data$pop*10 ,color="Marriages NSA",linetype="Marriages NSA"))
g2 <- geom_line(aes(y=Data$marriage_nsa/Data$pop*10, color="Marriages Annual",linetype="Marriages Annual"))
g3 <- geom_line(aes(y=Data$death_rate_nsa, color="Death Rate",linetype="Death Rate"))
g4 <- geom_line(aes(y=Data$live_births_rate_nsa, color="Live Birth Rate",linetype="Live Birth Rate"))
g5 <- geom_line(aes(y=Data$fertility_rate_nsa, color="Fertility Rate",linetype="Fertility Rate"))

color         <- scale_color_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Live Birth Rate","Death Rate","Fertility Rate"), values=c( "Marriages Annual"="blue", "Marriages NSA"="red","Live Birth Rate" = "red","Death Rate" ="black","Fertility Rate" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Live Birth Rate","Death Rate","Fertility Rate"), values=c("Marriages Annual"=1,"Marriages NSA"=1,"Live Birth Rate"=1,"Death Rate"=1,"Fertility Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Live Birth Rate","Death Rate","Fertility Rate"), values=c("Marriages Annual"=2,"Marriages NSA"=2,"Live Birth Rate"=2,"Death Rate"=3,"Fertility Rate"=3))
title         <- ggtitle("U.S. Live Birth and Death Rates")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Per 1000; Source: CDC")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,30,5),0),limits = c(2,30))

deaths_fig1 <- deaths_fig1 + g3+g4+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(deaths_fig1) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/vital_rates.jpg" ,height = 6.5,width = 11.5,units = "in")

```

###  U.S. Fertility Rate {-}
```{r fertility_fig1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fertility_fig1      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$deaths_nsa/Data$pop*10 ,color="Marriages NSA",linetype="Marriages NSA"))
g2 <- geom_line(aes(y=Data$marriage_nsa/Data$pop*10, color="Marriages Annual",linetype="Marriages Annual"))
g3 <- geom_line(aes(y=Data$death_rate_nsa, color="Death Rate",linetype="Death Rate"))
g4 <- geom_line(aes(y=Data$live_births_rate_nsa, color="Live Birth Rate",linetype="Live Birth Rate"))
g5 <- geom_line(aes(y=Data$fertility_rate_nsa, color="Fertility Rate",linetype="Fertility Rate"))

color         <- scale_color_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Live Birth Rate","Death Rate","Fertility Rate"), values=c( "Marriages Annual"="blue", "Marriages NSA"="red","Live Birth Rate" = "red","Death Rate" ="black","Fertility Rate" = "black"))
linetype      <- scale_linetype_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Live Birth Rate","Death Rate","Fertility Rate"), values=c("Marriages Annual"=1,"Marriages NSA"=1,"Live Birth Rate"=1,"Death Rate"=1,"Fertility Rate"=1))
size          <- scale_size_manual(" ", breaks=c("Marriages Annual","Marriages NSA","Live Birth Rate","Death Rate","Fertility Rate"), values=c("Marriages Annual"=2,"Marriages NSA"=2,"Live Birth Rate"=2,"Death Rate"=3,"Fertility Rate"=3))
title         <- ggtitle("U.S. Fertility Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1933-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Per 1000; Source: CDC")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,140,10),0))

fertility_fig1 <- fertility_fig1 + g5+color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(fertility_fig1) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/vital_rates.jpg" ,height = 6.5,width = 11.5,units = "in")

```

## World Bond Yields {-}

```{r wldltratesplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

wldltratesplot  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$swe_by, color="SWE",linetype="SWE"))
g2 <- geom_line(aes(y=Data$usa_by, color="USA",linetype="USA"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("SWE","USA","GBR","Japan","France","ZAF","AUS"), values=c( "USA"="blue", "SWE"="red","France" = "black","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("SWE","USA","GBR","Japan","France","ZAF","AUS"), values=c("USA"=1,"SWE"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=2,"AUS"=2))
size          <- scale_size_manual(" ", breaks=c("SWE","USA","GBR","Japan","France","ZAF","AUS"), values=c("USA"=2,"SWE"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Long-term Bond Yields (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1869-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1, 20, 1),0))

wldltratesplot <- wldltratesplot +g2+g3+g4 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(wldltratesplot) + yscale
```

```{r wldltratesplot2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

wldltratesplot2  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$bel_by, color="BEL",linetype="BEL"))
g2 <- geom_line(aes(y=Data$can_by, color="CAN",linetype="CAN"))
g4 <- geom_line(aes(y=Data$ger_by, color="DEU",linetype="DEU"))
g5 <- geom_line(aes(y=Data$ita_by, color="ITA",linetype="ITA"))
g3 <- geom_line(aes(y=Data$dnk_by, color="DEN",linetype="DEN"))
g6 <- geom_line(aes(y=Data$nzl_by, color="NZL",linetype="NZL"))
g7 <- geom_line(aes(y=Data$prt_by, color="PRT",linetype="PRT"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("BEL","CAN","DEN","DEU","ITA","NZL","PRT"), values=c( "CAN"="blue", "BEL"="red","ITA" = "black","DEU" ="green","DEN"="black","NZL" = "black","PRT" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("BEL","CAN","DEN","DEU","ITA","NZL","PRT"), values=c("CAN"=1,"BEL"=1,"ITA"=1,"DEU"=1,"DEN"=1,"NZL"=2,"PRT"=2))
size          <- scale_size_manual(" ", breaks=c("BEL","CAN","DEN","DEU","ITA","NZL","PRT"), values=c("CAN"=2,"BEL"=2,"ITA"=2,"DEU"=3,"DEN"=2,"NZL"=2,"PRT"=3))
title         <- ggtitle("Long-term Bond Yields (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1869-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1, 23, 1),0))

wldltratesplot2 <- wldltratesplot2 +g1+g2+g3+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(wldltratesplot2) + yscale
```

```{r wldltratesplot3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

wldltratesplot3  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$bel_by, color="BEL",linetype="BEL"))
g2 <- geom_line(aes(y=Data$can_by, color="CAN",linetype="CAN"))
g4 <- geom_line(aes(y=Data$ger_by, color="DEU",linetype="DEU"))
g5 <- geom_line(aes(y=Data$ita_by, color="ITA",linetype="ITA"))
g3 <- geom_line(aes(y=Data$dnk_by, color="DEN",linetype="DEN"))
g6 <- geom_line(aes(y=Data$nzl_by, color="NZL",linetype="NZL"))
g7 <- geom_line(aes(y=Data$prt_by, color="PRT",linetype="PRT"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("BEL","CAN","DEN","DEU","ITA","NZL","PRT"), values=c( "CAN"="blue", "BEL"="red","ITA" = "red","DEU" ="green","DEN"="red","NZL" = "black","PRT" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("BEL","CAN","DEN","DEU","ITA","NZL","PRT"), values=c("CAN"=1,"BEL"=1,"ITA"=1,"DEU"=1,"DEN"=1,"NZL"=1,"PRT"=1))
size          <- scale_size_manual(" ", breaks=c("BEL","CAN","DEN","DEU","ITA","NZL","PRT"), values=c("CAN"=2,"BEL"=2,"ITA"=2,"DEU"=3,"DEN"=2,"NZL"=2,"PRT"=3))
title         <- ggtitle("Long-term Bond Yields (Part 3)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1869-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1, 23, 1),0),limits = c(-1,22))

wldltratesplot3 <- wldltratesplot3 +g4+g5+g6+g7 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(wldltratesplot3) + yscale
```

```{r wldltratesplot4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

wldltratesplot4  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$swe_by, color="SWE",linetype="SWE"))
g2 <- geom_line(aes(y=Data$usa_by, color="USA",linetype="USA"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("SWE","USA","GBR","Japan","France","ZAF","AUS"), values=c( "USA"="blue", "SWE"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("SWE","USA","GBR","Japan","France","ZAF","AUS"), values=c("USA"=1,"SWE"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("SWE","USA","GBR","Japan","France","ZAF","AUS"), values=c("USA"=2,"SWE"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Long-term Bond Yields (Part 4)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1869-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1, 20, 1),0))

wldltratesplot4 <- wldltratesplot4 +g1+g5+g6+g7 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(wldltratesplot4) + yscale
```

## Global Inflation and Rates {-}

### World Inflation  {-}
```{r wldinfplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5, out.width="95%",cache=FALSE}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/wld_inf_plot_bis.jpg")

```

### Europe  {-}
```{r eur_inf_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5, out.width="95%",cache=FALSE}
# 
knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/eur_inf_plot_bis.jpg")

```

###  Asia {-}
```{r asia_inf_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5, out.width="95%",cache=FALSE}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/asia_inf_plot_bis.jpg")

```

###  Global Long-term Bond Yields and Inflation {-}
```{r wld_lt_rates_and_inf, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

wld_lt_rates_and_inf  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$wld_ltrate, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$wld_cpi, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$wld_cpi_exp, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$wld_cpi_avg, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Global Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1869-01-01"), as.Date("2021-12-01")), date_breaks = "7 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

wld_lt_rates_and_inf <- wld_lt_rates_and_inf +g1+g2+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(wld_lt_rates_and_inf) + yscale
```

### Sweden {-}

```{r swe_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

swe_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$swe_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$swe_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Sweden: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

swe_lt_rates_and_inf_pt1 <- swe_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(swe_lt_rates_and_inf_pt1) + yscale
```

###  France {-}
```{r fra_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fra_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fra_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$fra_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("France: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-16, 30, 2),0),limits = c(-16,30))

fra_lt_rates_and_inf_pt1 <- fra_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(fra_lt_rates_and_inf_pt1) + yscale
```

###  Japan {-}
```{r jpn_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

jpn_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$jpn_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$jpn_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Japan: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-16, 30, 2),0),limits = c(-16,30))

jpn_lt_rates_and_inf_pt1 <- jpn_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(jpn_lt_rates_and_inf_pt1) + yscale
```

### Italy {-}
```{r ita_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ita_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ita_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$ita_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Italy: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 26, 2),0),limits = c(-10,36))

ita_lt_rates_and_inf_pt1 <- ita_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ita_lt_rates_and_inf_pt1) + yscale
```

### Germany {-}
```{r ger_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ger_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$ger_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$ger_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Germany: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-14, 20, 2),0),limits = c(-14,20))

ger_lt_rates_and_inf_pt1 <- ger_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ger_lt_rates_and_inf_pt1) + yscale
```

###  Australia {-}
```{r aus_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

aus_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$aus_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$aus_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("AUS: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

aus_lt_rates_and_inf_pt1 <- aus_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(aus_lt_rates_and_inf_pt1) + yscale
```

### United Kingdom {-}
```{r gbr_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

gbr_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gbr_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$gbr_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("UK: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

gbr_lt_rates_and_inf_pt1 <- gbr_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(gbr_lt_rates_and_inf_pt1) + yscale
```

### South Africa  {-}
```{r zarlt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

zarlt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$zar_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$zar_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("South Africa: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

zarlt_rates_and_inf_pt1 <- zarlt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(zarlt_rates_and_inf_pt1) + yscale
```

### Norway  {-}
```{r nor_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

nor_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$nor_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$nor_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("Norway: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

nor_lt_rates_and_inf_pt1 <- nor_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(nor_lt_rates_and_inf_pt1) + yscale
```

### New Zealand  {-}
```{r nzl_lt_rates_and_inf_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

nzl_lt_rates_and_inf_pt1  <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$nzl_by, color="Bond Yield",linetype="Bond Yield"))
g2 <- geom_line(aes(y=Data$nzl_inf, color="Inflation",linetype="Inflation"))
g4 <- geom_line(aes(y=Data$jpn_by, color="Japan",linetype="Japan"))
g5 <- geom_line(aes(y=Data$fra_by, color="France",linetype="France"))
g3 <- geom_line(aes(y=Data$gbr_by, color="GBR",linetype="GBR"))
g6 <- geom_line(aes(y=Data$zar_by, color="ZAF",linetype="ZAF"))
g7 <- geom_line(aes(y=Data$aus_by, color="AUS",linetype="AUS"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c( "Inflation"="blue", "Bond Yield"="red","France" = "purple","Japan" ="green","GBR"="red","ZAF" = "black","AUS" ="blue"))
linetype      <- scale_linetype_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=1,"Bond Yield"=1,"France"=1,"Japan"=1,"GBR"=2,"ZAF"=1,"AUS"=1))
size          <- scale_size_manual(" ", breaks=c("Bond Yield","Inflation","GBR","Japan","France","ZAF","AUS"), values=c("Inflation"=2,"Bond Yield"=2,"France"=2,"Japan"=3,"GBR"=2,"ZAF"=2,"AUS"=3))
title         <- ggtitle("NZ: Long-term Bond Yields and Inflation")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1900-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.025, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-10, 20, 2),0),limits = c(-10,20))

nzl_lt_rates_and_inf_pt1 <- nzl_lt_rates_and_inf_pt1 +g1+g2 + color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(nzl_lt_rates_and_inf_pt1) + yscale
# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

## European Capital Markets {-}

###  European Gross Debt Issuance-to-GDP {-}
```{r eur_gross_debt_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

eur_gross_debt_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ger_gross_debt_iss/EUR_Data$ger_gdp_mv, color="Germany",linetype="Germany"))
g2 <- geom_line(aes(y=EUR_Data$ita_gross_debt_iss/EUR_Data$ita_gdp_mv, color="Italy",linetype="Italy"))
g3 <- geom_line(aes(y=EUR_Data$fra_gross_debt_iss/EUR_Data$fra_gdp_mv, color="France",linetype="France"))
g4 <- geom_line(aes(y=EUR_Data$esp_gross_debt_iss/EUR_Data$esp_gdp_mv, color="Spain",linetype="Spain"))
g5 <- geom_line(aes(y=EUR_Data$eur_gross_debt_iss/EUR_Data$eur_gdp_mv, color="Europe",linetype="Europe"))

color         <- scale_color_manual(" ", breaks=c("Italy","Germany","Spain","France","Europe"), values=c( "Italy"="blue", "Germany"="red","Spain" = "black","France" ="purple","Europe" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Italy","Germany","Spain","France","Europe"), values=c("Italy"=1,"Germany"=1,"Spain"=1,"France"=2,"Europe"=1))
size          <- scale_size_manual(" ", breaks=c("Italy","Germany","Spain","France","Europe"), values=c("Italy"=2,"Germany"=2,"Spain"=2,"France"=3,"Europe"=3))
title         <- ggtitle("European Gross Debt Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,.1),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
eur_gross_debt_iss_plot <- eur_gross_debt_iss_plot +g1+g2+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(eur_gross_debt_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/eur_gross_debt_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eur_gross_debt_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("eur_gross_debt_iss_plot.jpg")
```

### German Capital Market Outstandings-to-GDP {-}
```{r ger_out_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ger_out_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ger_debt_out/EUR_Data$ger_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$ger_general_govt_debt_out/EUR_Data$ger_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$ger_muni_debt_out/EUR_Data$ger_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$ger_nfc_debt_out/EUR_Data$ger_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$ger_equity_out/EUR_Data$ger_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("German Capital Market Outstandings-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,1),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ger_out_plot <- ger_out_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(ger_out_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ger_out_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ger_out_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ger_out_plot.jpg")
```

### German Capital Market Issuance-to-GDP {-}
```{r ger_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ger_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ger_gross_debt_iss/EUR_Data$ger_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$ger_gross_general_govt_debt_iss/EUR_Data$ger_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$ger_gross_muni_debt_iss/EUR_Data$ger_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$ger_gross_nfc_debt_iss/EUR_Data$ger_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$ger_gross_equity_iss/EUR_Data$ger_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("German Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,.1),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ger_iss_plot <- ger_iss_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(ger_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ger_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ger_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ger_iss_plot.jpg")
```

### German Net Capital Market Issuance-to-GDP {-}
```{r ger_net_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ger_net_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=ger_govtdebttogdp_ma, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=ger_govtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=ger_munitogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=ger_corpdebttogdp_ma, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=ger_equitytogdp_ma, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("German Net Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ger_net_iss_plot <- ger_net_iss_plot+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ger_net_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ger_net_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ger_net_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ger_net_iss_plot.jpg")
```

### German Net Long-Term Capital Market Issuance-to-GDP {-}
```{r ger_net_lt_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ger_net_lt_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ger_net_debt_iss/EUR_Data$ger_gdp_mv, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=ger_ltgovtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=ger_ltmunidebttogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=ger_corpequitytogdp_ma, color="Non-Financial Corporate Equity",linetype="Non-Financial Corporate Equity"))
g5 <- geom_line(aes(y=EUR_Data$ger_net_nfc_equity_iss/EUR_Data$ger_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Equity" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Equity"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Equity"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("German Net Long-Term Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ger_net_lt_iss_plot <- ger_net_lt_iss_plot +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ger_net_lt_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ger_net_lt_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ger_net_lt_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ger_net_lt_iss_plot.jpg")
```

### France Capital Market Outstandings-to-GDP {-}
```{r fra_out_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fra_out_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$fra_debt_out/EUR_Data$fra_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$fra_general_govt_debt_out/EUR_Data$fra_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$fra_muni_debt_out/EUR_Data$fra_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$fra_nfc_debt_out/EUR_Data$fra_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$fra_equity_out/EUR_Data$fra_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("France Capital Market Outstandings-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,1),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
fra_out_plot <- fra_out_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(fra_out_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/fra_out_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/fra_out_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("fra_out_plot.jpg")
```

### France Capital Market Issuance-to-GDP {-}
```{r fra_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fra_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$fra_gross_debt_iss/EUR_Data$fra_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$fra_gross_general_govt_debt_iss/EUR_Data$fra_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$fra_gross_muni_debt_iss/EUR_Data$fra_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$fra_gross_nfc_debt_iss/EUR_Data$fra_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$fra_gross_equity_iss/EUR_Data$fra_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("France Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1990-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,.1),2))
vline <- geom_vline(xintercept = as.Date("2020-03-01"),show.legend = TRUE)
fra_iss_plot <- fra_iss_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs + vline

nberShade(fra_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/fra_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/fra_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("fra_iss_plot.jpg")
```

###  France Net Capital Market Issuance-to-GDP {-}
```{r fra_net_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fra_net_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=fra_govtdebttogdp_ma, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=fra_govtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=fra_munitogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=fra_corpdebttogdp_ma, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=fra_equitytogdp_ma, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("France Net Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
fra_net_iss_plot <- fra_net_iss_plot+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(fra_net_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/fra_net_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/fra_net_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("fra_net_iss_plot.jpg")
```

###  France Net Long-Term Capital Market Issuance-to-GDP {-}
```{r fra_net_lt_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fra_net_lt_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$fra_net_debt_iss/EUR_Data$fra_gdp_mv, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=fra_ltgovtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=fra_ltmunidebttogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=fra_corpequitytogdp_ma, color="Non-Financial Corporate Equity",linetype="Non-Financial Corporate Equity"))
g5 <- geom_line(aes(y=EUR_Data$fra_net_nfc_equity_iss/EUR_Data$fra_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Equity" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Equity"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Equity"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("France Net Long-Term Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1991-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
fra_net_lt_iss_plot <- fra_net_lt_iss_plot +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(fra_net_lt_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/fra_net_lt_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/fra_net_lt_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("fra_net_lt_iss_plot.jpg")
```

### Italy Capital Market Outstandings-to-GDP {-}
```{r ita_out_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ita_out_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ita_debt_out/EUR_Data$ita_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$ita_general_govt_debt_out/EUR_Data$ita_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$ita_muni_debt_out/EUR_Data$ita_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$ita_nfc_debt_out/EUR_Data$ita_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$ita_equity_out/EUR_Data$ita_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Italy Capital Market Outstandings-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,1),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ita_out_plot <- ita_out_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(ita_out_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ita_out_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ita_out_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ita_out_plot.jpg")
```

###  Italy Capital Market Issuance-to-GDP {-}
```{r ita_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ita_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ita_gross_debt_iss/EUR_Data$ita_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$ita_gross_general_govt_debt_iss/EUR_Data$ita_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$ita_gross_muni_debt_iss/EUR_Data$ita_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$ita_gross_nfc_debt_iss/EUR_Data$ita_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$ita_gross_equity_iss/EUR_Data$ita_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Italy Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,.1),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ita_iss_plot <- ita_iss_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(ita_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ita_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ita_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ita_iss_plot.jpg")
```

### Italy Net Capital Market Issuance-to-GDP {-}
```{r ita_net_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ita_net_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=ita_govtdebttogdp_ma, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=ita_govtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=ita_munitogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=ita_corpdebttogdp_ma, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=ita_equitytogdp_ma, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Italy Net Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ita_net_iss_plot <- ita_net_iss_plot+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ita_net_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ita_net_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ita_net_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ita_net_iss_plot.jpg")
```

### Italy Net Long-Term Capital Market Issuance-to-GDP {-}
```{r ita_net_lt_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

ita_net_lt_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$ita_net_debt_iss/EUR_Data$ita_gdp_mv, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=ita_ltgovtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=ita_ltmunidebttogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=ita_corpequitytogdp_ma, color="Non-Financial Corporate Equity",linetype="Non-Financial Corporate Equity"))
g5 <- geom_line(aes(y=EUR_Data$ita_net_nfc_equity_iss/EUR_Data$ita_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Equity" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Equity"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Equity"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Italy Net Long-Term Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
ita_net_lt_iss_plot <- ita_net_lt_iss_plot +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(ita_net_lt_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/ita_net_lt_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/ita_net_lt_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("ita_net_lt_iss_plot.jpg")
```

###  Spain Capital Market Outstandings-to-GDP {-}
```{r esp_out_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

esp_out_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$esp_debt_out/EUR_Data$esp_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$esp_general_govt_debt_out/EUR_Data$esp_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$esp_muni_debt_out/EUR_Data$esp_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$esp_nfc_debt_out/EUR_Data$esp_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$esp_equity_out/EUR_Data$esp_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Spain Capital Market Outstandings-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,1),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
esp_out_plot <- esp_out_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(esp_out_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/esp_out_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/esp_out_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("esp_out_plot.jpg")
```

### Spain Capital Market Issuance-to-GDP {-}
```{r esp_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

esp_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$esp_gross_debt_iss/EUR_Data$esp_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$esp_gross_general_govt_debt_iss/EUR_Data$esp_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$esp_gross_muni_debt_iss/EUR_Data$esp_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$esp_gross_nfc_debt_iss/EUR_Data$esp_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$esp_gross_equity_iss/EUR_Data$esp_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Spain Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,.1),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
esp_iss_plot <- esp_iss_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(esp_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/esp_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/esp_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("esp_iss_plot.jpg")
```

### Spain Net Capital Market Issuance-to-GDP {-}
```{r esp_net_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

esp_net_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=esp_govtdebttogdp_ma, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=esp_govtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=esp_munitogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=esp_corpdebttogdp_ma, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=esp_equitytogdp_ma, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Spain Net Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
esp_net_iss_plot <- esp_net_iss_plot+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(esp_net_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/esp_net_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/esp_net_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("esp_net_iss_plot.jpg")
```
###  {-}
```{r esp_net_lt_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

esp_net_lt_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$esp_net_debt_iss/EUR_Data$esp_gdp_mv, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=esp_ltgovtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=esp_ltmunidebttogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=esp_corpequitytogdp_ma, color="Non-Financial Corporate Equity",linetype="Non-Financial Corporate Equity"))
g5 <- geom_line(aes(y=EUR_Data$esp_net_nfc_equity_iss/EUR_Data$esp_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Equity" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Equity"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Equity"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Spain Net Long-Term Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.025),3))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
esp_net_lt_iss_plot <- esp_net_lt_iss_plot +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(esp_net_lt_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/esp_net_lt_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/esp_net_lt_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("esp_net_lt_iss_plot.jpg")
```

###  Europe Capital Market Outstandings-to-GDP {-}
```{r eur_out_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

eur_out_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$eur_debt_out/EUR_Data$eur_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$eur_general_govt_debt_out/EUR_Data$eur_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$eur_muni_debt_out/EUR_Data$eur_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$eur_nfc_debt_out/EUR_Data$eur_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$eur_equity_out/EUR_Data$eur_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Europe Capital Market Outstandings-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,1),1))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
eur_out_plot <- eur_out_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(eur_out_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/eur_out_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eur_out_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("eur_out_plot.jpg")
```

### Europe Capital Market Issuance-to-GDP {-}
```{r eur_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

eur_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$eur_gross_debt_iss/EUR_Data$eur_gdp_mv, color="Gross Debt",linetype="Gross Debt"))
g2 <- geom_line(aes(y=EUR_Data$eur_gross_general_govt_debt_iss/EUR_Data$eur_gdp_mv, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=EUR_Data$eur_gross_muni_debt_iss/EUR_Data$eur_gdp_mv, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=EUR_Data$eur_gross_nfc_debt_iss/EUR_Data$eur_gdp_mv, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=EUR_Data$eur_gross_equity_iss/EUR_Data$eur_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Gross Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Gross Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Gross Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Gross Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Europe Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(0,200,.1),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
eur_iss_plot <- eur_iss_plot +g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs 

nberShade(eur_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/eur_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eur_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("eur_iss_plot.jpg")
```

### Europe Net Capital Market Issuance-to-GDP {-}
```{r eur_net_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

eur_net_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=eur_govtdebttogdp_ma, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=eur_govtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=eur_munitogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=eur_corpdebttogdp_ma, color="Non-Financial Corporate Debt",linetype="Non-Financial Corporate Debt"))
g5 <- geom_line(aes(y=eur_equitytogdp_ma, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Debt" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Debt"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Debt","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Debt"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Europe Net Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.01),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
eur_net_iss_plot <- eur_net_iss_plot+g2+g3+g4+g5+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(eur_net_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/eur_net_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eur_net_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("eur_net_iss_plot.jpg")
```

### Europe Net Long-Term Capital Market Issuance-to-GDP {-}
```{r eur_net_lt_iss_plot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

eur_net_lt_iss_plot      <- ggplot(data=EUR_Data, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=EUR_Data$eur_net_debt_iss/EUR_Data$eur_gdp_mv, color="Net Debt",linetype="Net Debt"))
g2 <- geom_line(aes(y=eur_ltgovtdebttogdp_ma, color="General Govt Debt",linetype="General Govt Debt"))
g3 <- geom_line(aes(y=eur_ltmunidebttogdp_ma, color="Muni Debt",linetype="Muni Debt"))
g4 <- geom_line(aes(y=eur_corpequitytogdp_ma, color="Non-Financial Corporate Equity",linetype="Non-Financial Corporate Equity"))
g5 <- geom_line(aes(y=EUR_Data$eur_net_nfc_equity_iss/EUR_Data$eur_gdp_mv, color="Equity",linetype="Equity"))

color         <- scale_color_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c( "General Govt Debt"="blue", "Net Debt"="red","Non-Financial Corporate Equity" = "black","Muni Debt" ="purple","Equity" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=1,"Net Debt"=1,"Non-Financial Corporate Equity"=1,"Muni Debt"=2,"Equity"=1))
size          <- scale_size_manual(" ", breaks=c("General Govt Debt","Net Debt","Non-Financial Corporate Equity","Muni Debt","Equity"), values=c("General Govt Debt"=2,"Net Debt"=2,"Non-Financial Corporate Equity"=2,"Muni Debt"=3,"Equity"=3))
title         <- ggtitle("Europe Net Long-Term Capital Market Issuance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1995-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Sources: ECB SDW, Notes: Fraction of GDP at market prices; 9mma")
hline         <- geom_hline(yintercept = 0, linetype="dashed")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-200,200,.01),2))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
eur_net_lt_iss_plot <- eur_net_lt_iss_plot +g2+g3+g4+ color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(eur_net_lt_iss_plot) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/eur_net_lt_iss_plot.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#ecb","#debt","#macro","#issuance",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/eur_net_lt_iss_plot.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("eur_net_lt_iss_plot.jpg")
```

## Foreign Transactions {-}
```{r wld_ust, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5, out.width="95%",cache=FALSE}

 knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/wld_ustnet_frac_trans_plot.jpg")

```

```{r eur_ust, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, out.width="95%", fig.width=11.5,cache=FALSE}

 knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/eur_ustnet_frac_trans_plot.jpg")

```

```{r seasia_ust, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, out.width="95%", fig.width=11.5,cache=FALSE}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/asia_ustnet_frac_trans_plot.jpg")

```

```{r latam_ust, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, out.width="95%", fig.width=11.5,cache=FALSE}

 knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/latam_ustnet_frac_trans_plot.jpg")

```

```{r wld_us_secs, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, out.width="95%", fig.width=11.5,cache=FALSE}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/wld_totalnetus_frac_iss_plot.jpg")

```

```{r latam_us_secs, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE, out.width="95%", fig.align='center'}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/latam_totalnetus_frac_iss_plot.jpg")

```

```{r seasia_us_secs, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5, out.width="95%", cache=FALSE, fig.align='center'}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/asia_totalnetus_frac_iss_plot.jpg")

```

```{r eur_us_secs, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5, out.width="95%", cache=FALSE}

knitr::include_graphics("C:/Users/sabol/Google Drive/blogposts/eur_totalnetus_frac_iss_plot.jpg")

```

###  Total Net Foreign Purchases: 1935 - 1980 {-}
```{r netfrnpur_pt1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

netfrnpur_pt1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=total_net_frn_ma/totaliss_ma, color="Total Net Foreign Purchases",linetype="Total Net Foreign Purchases"))
g2 <- geom_line(aes(y=-Data$real_fx/10, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Total Net Foreign Purchases"), values=c( "Private"="blue", "Total Net Foreign Purchases"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Total Net Foreign Purchases"), values=c("Private"=1,"Total Net Foreign Purchases"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Total Net Foreign Purchases"), values=c("Private"=2,"Total Net Foreign Purchases"=2))
title         <- ggtitle("Total Net Foreign Purchases (Part 1)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1934-12-01"), as.Date("1979-12-01")), date_breaks = "3 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Domestic Bond Issuance plus NYSE Trading Vol/1000, 3MMA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(total_net_frn_ma/totaliss_ma,na.rm = TRUE), max(total_net_frn_ma/totaliss_ma,na.rm = TRUE), .01),2))
netfrnpur_pt1_fig <- netfrnpur_pt1_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(netfrnpur_pt1_fig) + yscale

```

### Total Net Foreign Purchases: 1980- {-}
```{r fortransAAplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

for_total_net_share <- total_net_frn_ma/totaliss_ma
corp_eq_gdp <- Data$corpstock_iss/Data$ngdpm

tail_dates <- index(tail(na.omit(xts(total_net_frn_ma/totaliss_ma,order.by = as.Date(Data$Date))),1))

Figure_fortransAA      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=total_net_frn_ma/totaliss_ma, color="Total Net Foreign Purchases",linetype="Total Net Foreign Purchases"))
g2 <- geom_line(aes(y=Data$corpstock_iss/Data$ngdpm, color="Equity Issuance",linetype="Equity Issuance"))

color         <- scale_color_manual(" ", breaks=c("Equity Issuance","Total Net Foreign Purchases"), values=c( "Equity Issuance"="blue", "Total Net Foreign Purchases"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Equity Issuance","Total Net Foreign Purchases"), values=c("Equity Issuance"=1,"Total Net Foreign Purchases"=1))
size          <- scale_size_manual(" ", breaks=c("Equity Issuance","Total Net Foreign Purchases"), values=c("Equity Issuance"=2,"Total Net Foreign Purchases"=2))
title         <- ggtitle("Total Net Foreign Purchases (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1980-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Domestic Bond Issuance plus NYSE Trading Vol/1000, 3MMA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(for_total_net_share,na.rm = TRUE), max(for_total_net_share,na.rm = TRUE), .01),3),limits = c(-0.05,0.07))

tail_1 <- for_total_net_share %>% na.omit() %>% tail(1)

gpoints_1 <- geom_point(data = D,aes(x=tail_dates,y= round(for_total_net_share %>% na.omit() %>% tail(1),3)) , size=2,color="red",shape=21,fill="red")

gtext_1 <- geom_text(y =for_total_net_share %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(for_total_net_share %>% na.omit() %>% tail(1),3)),color="red",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_2 <- geom_point(data = D,aes(x=tail_dates,y= round(corp_eq_gdp %>% na.omit() %>% tail(1),3)) , size=2,color="blue",shape=21,fill="blue")

gtext_2 <- geom_text(y =corp_eq_gdp %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(corp_eq_gdp %>% na.omit() %>% tail(1),3)),color="blue",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

hline         <- geom_hline(yintercept = 0, linetype="dashed")

Figure_fortransAA <- Figure_fortransAA + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +gpoints_1 + gtext_1 +hline

nberShade(Figure_fortransAA) +yscale
```

### Foreign Net Purchases of US Long-term Securities {-}
```{r fortrans1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}


fortrans1_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=dom_ltsecs_net_ma/totaliss_ma, color="Net purchases of US LT secs",linetype="Net purchases of US LT secs"))
g2 <- geom_line(aes(y=mortorigtogdp, color="Mortgage Originations-to-GDP",linetype="Mortgage Originations-to-GDP"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Mortgage Originations-to-GDP","Net purchases of US LT secs"), values=c( "Mortgage Originations-to-GDP"="blue", "Net purchases of US LT secs"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Mortgage Originations-to-GDP","Net purchases of US LT secs"), values=c("Mortgage Originations-to-GDP"=1,"Net purchases of US LT secs"=1))
size          <- scale_size_manual(" ", breaks=c("Mortgage Originations-to-GDP","Net purchases of US LT secs"), values=c("Mortgage Originations-to-GDP"=2,"Net purchases of US LT secs"=2))
title         <- ggtitle("Foreign Net Purchases of US Long-term Securities")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1934-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes:fraction of Corporate & Muni Issuance and NYSE trading volume/1000; 6MMA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(dom_ltsecs_net_ma/totaliss_ma,na.rm = TRUE), max(dom_ltsecs_net_ma/totaliss_ma,na.rm = TRUE), .01),2))
fortrans1_fig <- fortrans1_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans1_fig) + yscale

```

### Foreign Net Purchases of US Treasury Notes and Bonds {-}
```{r fortrans3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}
fortrans3_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=ust_net_ma/pdtrantotal_ma, color="UST Net",linetype="UST Net"))
g2 <- geom_line(aes(y=ust_net_ma/usbond_ma, color="Notes and Bonds",linetype="Notes and Bonds"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Notes and Bonds","UST Net"), values=c( "Notes and Bonds"="blue", "UST Net"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Notes and Bonds","UST Net"), values=c("Notes and Bonds"=1,"UST Net"=1))
size          <- scale_size_manual(" ", breaks=c("Notes and Bonds","UST Net"), values=c("Notes and Bonds"=2,"UST Net"=2))
title         <- ggtitle("Foreign Net Purchases of US Treasury Notes and Bonds")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1949-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasury Note and Bond Issuance, 4MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(ust_net_ma/usbond_ma,na.rm = TRUE), max(ust_net_ma/usbond_ma,na.rm = TRUE), .10),2))
fortrans3_fig <- fortrans3_fig +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans3_fig) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/for_trans_tsy1.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Foreign Net Purchases of US Treasury Notes and Bonds: 1963 - 1978 {-}
```{r fortrans2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fortrans2_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=ust_foi_net_ma/pdtrantotal_ma, color="Foreign Official Institutions",linetype="Foreign Official Institutions"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c( "Private"="blue", "Foreign Official Institutions"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c("Private"=1,"Foreign Official Institutions"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c("Private"=2,"Foreign Official Institutions"=2))
title         <- ggtitle("Foreign Net Purchases of US Treasury Notes and Bonds (Part 1) ")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1962-12-01"), as.Date("1978-12-01")), date_breaks = "1 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasury Transactions, 4MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(ust_foi_net_ma/pdtrantotal_ma,na.rm = TRUE), max(ust_foi_net_ma/pdtrantotal_ma,na.rm = TRUE), .02),2))
fortrans2_fig <- fortrans2_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans2_fig) + yscale


```

###  Foreign Net Purchases of US Treasury Notes and Bonds: 1979- {-}
```{r fortransAAustplot, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

for_total_net_share <- ust_foi_net_ma/pdtrantotal_ma
corp_eq_gdp <- ust_other_frners_net_ma/pdtrantotal_ma

tail_dates <- index(tail(na.omit(xts(ust_foi_net_ma/pdtrantotal_ma,order.by = as.Date(Data$Date))),1))

Figure_fortransAAust      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=ust_foi_net_ma/pdtrantotal_ma, color="Foreign Official Institutions",linetype="Foreign Official Institutions"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

color         <- scale_color_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c( "Private"="blue", "Foreign Official Institutions"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c("Private"=1,"Foreign Official Institutions"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c("Private"=2,"Foreign Official Institutions"=2))
title         <- ggtitle("Foreign Net Purchases of US Treasury Notes and Bonds (Part 2)")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1979-01-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasury Transactions, 4MMA",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(ust_other_frners_net_ma/pdtrantotal_ma,na.rm = TRUE), max(for_total_net_share,na.rm = TRUE), .02),2),limits = c(-0.12,0.14))

tail_1 <- for_total_net_share %>% na.omit() %>% tail(1)

gpoints_1 <- geom_point(data = D,aes(x=tail_dates,y= round(for_total_net_share %>% na.omit() %>% tail(1),3)) , size=2,color="red",shape=21,fill="red")

gtext_1 <- geom_text(y =for_total_net_share %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(for_total_net_share %>% na.omit() %>% tail(1),3)),color="red",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

gpoints_2 <- geom_point(data = D,aes(x=tail_dates,y= round(corp_eq_gdp %>% na.omit() %>% tail(1),3)) , size=2,color="blue",shape=21,fill="blue")

gtext_2 <- geom_text(y =corp_eq_gdp %>% na.omit() %>% tail(1),aes(x=tail_dates,label = round(corp_eq_gdp %>% na.omit() %>% tail(1),3)),color="blue",hjust=0,size=4,nudge_x = 75,nudge_y = -14)

hline         <- geom_hline(yintercept = 0, linetype="dashed")

Figure_fortransAAust <- Figure_fortransAAust + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +gpoints_1 + gtext_2 +gpoints_2 + gtext_1 +hline

nberShade(Figure_fortransAAust) +yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/fornetpt2.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### Foreign Net Purchases of Domestic Equities {-}

```{r fortrans4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}


fortrans4_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=dom_stocks_net_ma/nyse_vol_ma, color="Domestic Stocks",linetype="Domestic Stocks"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Domestic Stocks"), values=c( "Private"="blue", "Domestic Stocks"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Domestic Stocks"), values=c("Private"=1,"Domestic Stocks"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Domestic Stocks"), values=c("Private"=2,"Domestic Stocks"=2))
title         <- ggtitle("Foreign Net Purchases of Domestic Equities")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Notes: fraction of NYSE Trading Volume/1000")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(dom_stocks_net_ma/nyse_vol_ma,na.rm = TRUE), max(dom_stocks_net_ma/nyse_vol_ma,na.rm = TRUE), .01),2))
fortrans4_fig <- fortrans4_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans4_fig) + yscale

```

### Foreign Net Purchases of Corporate, Muni and Agency Bonds {-}

```{r fortrans5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fortrans5_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=corp_agency_bond_net_ma/corpmuniiss_ma, color="Corporate, Muni and Agency Bonds",linetype="Corporate, Muni and Agency Bonds"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Corporate, Muni and Agency Bonds"), values=c( "Private"="blue", "Corporate, Muni and Agency Bonds"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Corporate, Muni and Agency Bonds"), values=c("Private"=1,"Corporate, Muni and Agency Bonds"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Corporate, Muni and Agency Bonds"), values=c("Private"=2,"Corporate, Muni and Agency Bonds"=2))
title         <- ggtitle("Foreign Net Purchases of Corporate, Muni and Agency Bonds")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1960-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="fraction of Corporate and Muni Bond Issuance and Federal Agency Volume")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(corp_agency_bond_net_ma/corpmuniiss_ma,na.rm = TRUE), max(corp_agency_bond_net_ma/corpmuniiss_ma,na.rm = TRUE), .05),2))
fortrans5_fig <- fortrans5_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans5_fig) + yscale

```

###  Foreign Net Purchases of Domestic Bonds {-}
```{r fortrans6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fortrans6_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=dom_bonds_net_ma/corpmunitsyiss_ma, color="Domestic Bonds",linetype="Domestic Bonds"))
g2 <- geom_line(aes(y=ust_other_frners_net_ma/pdtrantotal_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Domestic Bonds"), values=c( "Private"="blue", "Domestic Bonds"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Domestic Bonds"), values=c("Private"=1,"Domestic Bonds"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Domestic Bonds"), values=c("Private"=2,"Domestic Bonds"=2))
title         <- ggtitle("Foreign Net Purchases of Domestic Bonds")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Corporate, Muni and Treasury Note and Bond Issuance")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(dom_bonds_net_ma/corpmunitsyiss_ma,na.rm = TRUE), max(dom_bonds_net_ma/corpmunitsyiss_ma,na.rm = TRUE), .05),2))
fortrans6_fig <- fortrans6_fig + g1 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans6_fig) + yscale

```

###  U.S. Net Sales of Foreign Securities to Foreigners {-}
```{r fortrans_forstocks, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fortrans_forstocks_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=(frn_stocks_net_ma)/Data$goods_exp*1000/12, color="Foreign Stocks",linetype="Foreign Stocks"))
g2 <- geom_line(aes(y=frn_bonds_net_ma/Data$goods_exp*1000/12, color="Foreign Bonds",linetype="Foreign Bonds"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Foreign Bonds","Foreign Stocks"), values=c( "Foreign Bonds"="blue", "Foreign Stocks"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Foreign Bonds","Foreign Stocks"), values=c("Foreign Bonds"=1,"Foreign Stocks"=1))
size          <- scale_size_manual(" ", breaks=c("Foreign Bonds","Foreign Stocks"), values=c("Foreign Bonds"=2,"Foreign Stocks"=2))
title         <- ggtitle("U.S. Net Sales of Foreign Securities to Foreigners")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1941-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of U.S. Goods Exports, 12MA x 1000",caption = "@capitalmarketz")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-100000,100000, 25),2))
fortrans_forstocks_fig <- fortrans_forstocks_fig + g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans_forstocks_fig) + yscale

```

### Foreign Net Purchases of Treasury Bills {-}
```{r fortrans8, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fortrans8_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=tbill_foi_net_ma, color="Foreign Official Institutions",linetype="Foreign Official Institutions"))
g2 <- geom_line(aes(y=tbill_priv_net_ma, color="Private",linetype="Private"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c( "Private"="blue", "Foreign Official Institutions"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c("Private"=1,"Foreign Official Institutions"=1))
size          <- scale_size_manual(" ", breaks=c("Private","Foreign Official Institutions"), values=c("Private"=2,"Foreign Official Institutions"=2))
title         <- ggtitle("Foreign Net Purchases of Treasury Bills")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1961-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.50, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of Treasury Bills Outstanding; 4MMA")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(tbill_foi_net_ma,na.rm = TRUE), max(tbill_foi_net_ma,na.rm = TRUE), .01),2))
fortrans8_fig <- fortrans8_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs  + hline +yscale

nberShade(fortrans8_fig) + yscale

```

### Short-term liabilities of U.S. residents held by foreigners {-}
```{r fortrans9, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

fortrans9_fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylab("")
g1 <- geom_line(aes(y=Data$st_liabs_to_for/Data$ngdpm, color="Short-term liabilities of U.S. residents held by foreigners",linetype="Short-term liabilities of U.S. residents held by foreigners"))
g2 <- geom_line(aes(y=Data$tbill_for_total/Data$ngdpm, color="TBills",linetype="TBills"))

hline         <- geom_hline(yintercept = 0, linetype="dashed")
color         <- scale_color_manual(" ", breaks=c("TBills","Short-term liabilities of U.S. residents held by foreigners"), values=c( "TBills"="blue", "Short-term liabilities of U.S. residents held by foreigners"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("TBills","Short-term liabilities of U.S. residents held by foreigners"), values=c("TBills"=1,"Short-term liabilities of U.S. residents held by foreigners"=1))
size          <- scale_size_manual(" ", breaks=c("TBills","Short-term liabilities of U.S. residents held by foreigners"), values=c("TBills"=2,"Short-term liabilities of U.S. residents held by foreigners"=2))
title         <- ggtitle("Short-term liabilities of U.S. residents held by foreigners")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1928-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: fraction of GDP")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$st_liabs_to_for/Data$ngdpm,na.rm = TRUE), max(Data$st_liabs_to_for/Data$ngdpm,na.rm = TRUE), .5),2))
fortrans9_fig <- fortrans9_fig + g1 +g2 + color +linetype +size + title +text_options + Date_opts +leg_pos + sub_labs 

nberShade(fortrans9_fig) + yscale

```

### Oil Exporters Holdings of Treasuries and The Real Price of Crude Oil {-}
```{r oilexp1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

oilexp1fig      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$tsy_oil_exp/Data$usttotala_out*1000, color="Oil Exporters",linetype="Oil Exporters"))
g2 <- geom_line(aes(y=Data$crude_price/Data$cpi/10, color="Real Oil Price /10",linetype="Real Oil Price /10"))
g3 <- geom_line(aes(y=Data$usbillsandcertif_out/Data$ngdpm, color="Bills and Certificates",linetype="Bills and Certificates"))
g4 <- geom_line(aes(y=Data$usttotala_to_gdp, color="Gross",linetype="Gross"))

color         <- scale_color_manual(" ", breaks=c("Real Oil Price /10","Oil Exporters","Gross","Bills and Certificates"), values=c( "Real Oil Price /10"="blue", "Oil Exporters"="red","Gross" = "black","Bills and Certificates" ="dark green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Oil Price /10","Oil Exporters","Gross","Bills and Certificates"), values=c("Real Oil Price /10"=1,"Oil Exporters"=1,"Gross"=1,"Bills and Certificates"=2))
size          <- scale_size_manual(" ", breaks=c("Real Oil Price /10","Oil Exporters","Gross","Bills and Certificates"), values=c("Real Oil Price /10"=2,"Oil Exporters"=2,"Gross"=2,"Bills and Certificates"=3))
title         <- ggtitle("Oil Exporters Holdings of Treasuries and The Real Price of Crude Oil")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1974-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="CMD-MD; Notes: Brent Crude deflated by CPI divided by 10, Oil Exporters holdings of Treasuries as a share of Treasuries Out; Sources: EIA, TIC")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(.005, .07, .005),3),limits = c(.005,.07))

oilexp1fig <- oilexp1fig +g1+g2+ color +linetype +size + title +text_options  +leg_pos +sub_labs + Date_opts + yscale


nberShade(oilexp1fig) + yscale

```

## Trade Data {-}

### U.S. Real Effective Exchange Rate {-}
```{r realfx1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_realfx1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$real_fx, color="Real Effective Exchange Rate",linetype="Real Effective Exchange Rate"))
g2 <- geom_line(aes(y=(Data$real_fx_narrow/25)-4.5, color="BIS - Real Effective Exchange Rate - Narrow",linetype="BIS - Real Effective Exchange Rate - Narrow"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("BIS - Real Effective Exchange Rate - Narrow","Real Effective Exchange Rate"), values=c( "BIS - Real Effective Exchange Rate - Narrow"="blue", "Real Effective Exchange Rate"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("BIS - Real Effective Exchange Rate - Narrow","Real Effective Exchange Rate"), values=c("BIS - Real Effective Exchange Rate - Narrow"=1,"Real Effective Exchange Rate"=1))
size          <- scale_size_manual(" ", breaks=c("BIS - Real Effective Exchange Rate - Narrow","Real Effective Exchange Rate"), values=c("BIS - Real Effective Exchange Rate - Narrow"=2,"Real Effective Exchange Rate"=2))
title         <- ggtitle("U.S. Real Effective Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1920-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Black lines demark the dates of the Bretton Woods system; Sources: FRB, BIS")

vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-3,3, .2),2),limits = c(-1,1.6))
figure_realfx1 <- figure_realfx1 +g1+g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline+vline1 +vline2

nberShade(figure_realfx1) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/realfx.jpg" ,height = 6.5,width = 11.5,units = "in")

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")


```

### U.S. Nominal Effective Exchange Rate {-}
```{r nomfx1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nomfx1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$nom_fx, color="Nominal Effective Exchange Rate",linetype="Nominal Effective Exchange Rate"))
g2 <- geom_line(aes(y=(Data$Nominal_fx_narrow/25)-4.5, color="BIS - Nominal Effective Exchange Rate - Narrow",linetype="BIS - Nominal Effective Exchange Rate - Narrow"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("BIS - Nominal Effective Exchange Rate - Narrow","Nominal Effective Exchange Rate"), values=c( "BIS - Nominal Effective Exchange Rate - Narrow"="blue", "Nominal Effective Exchange Rate"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("BIS - Nominal Effective Exchange Rate - Narrow","Nominal Effective Exchange Rate"), values=c("BIS - Nominal Effective Exchange Rate - Narrow"=1,"Nominal Effective Exchange Rate"=1))
size          <- scale_size_manual(" ", breaks=c("BIS - Nominal Effective Exchange Rate - Narrow","Nominal Effective Exchange Rate"), values=c("BIS - Nominal Effective Exchange Rate - Narrow"=2,"Nominal Effective Exchange Rate"=2))
title         <- ggtitle("U.S. Nominal Effective Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1920-01-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position = "none")
sub_labs <- labs(subtitle="Capital Markets Data; Notes: Black lines demark the dates of the Bretton Woods system; Sources: FRB, BIS")

vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-3,3, .2),2),limits = c(-1,1.5))
figure_nomfx1 <- figure_nomfx1 +g1+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline+vline1 +vline2

nberShade(figure_nomfx1) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/Nominalfx.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### Trade Balance-to-GDP  {-}
```{r nx3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nx3      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("percent")
g1 <- geom_line(aes(y=Data$nx_goods_gdp, color="Goods Balance-to-GDP",linetype="Goods Balance-to-GDP"))
g2 <- geom_line(aes(y=Data$nx_to_gdp, color="Goods and Services Balance-to-GDP",linetype="Goods and Services Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Goods and Services Balance-to-GDP","Goods Balance-to-GDP"), values=c( "Goods and Services Balance-to-GDP"="blue", "Goods Balance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Goods and Services Balance-to-GDP","Goods Balance-to-GDP"), values=c("Goods and Services Balance-to-GDP"=1,"Goods Balance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Goods and Services Balance-to-GDP","Goods Balance-to-GDP"), values=c("Goods and Services Balance-to-GDP"=2,"Goods Balance-to-GDP"=2))
title         <- ggtitle("Trade Balance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Source: BEA; NBER")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$nx_to_gdp,na.rm = TRUE), max(Data$nx_goods_gdp,na.rm = TRUE), 1),0))
figure_nx3 <- figure_nx3 +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_nx3) + yscale

```

###  Goods and Services Trade Balance-to-GDP {-}
```{r nx_sep, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nx_sep      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("percent")
g1 <- geom_line(aes(y=Data$nx_goods_gdp, color="Goods Balance-to-GDP",linetype="Goods Balance-to-GDP"))
g2 <- geom_line(aes(y=Data$nx_serv_gdp, color="Services Balance-to-GDP",linetype="Services Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Services Balance-to-GDP","Goods Balance-to-GDP"), values=c( "Services Balance-to-GDP"="blue", "Goods Balance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Services Balance-to-GDP","Goods Balance-to-GDP"), values=c("Services Balance-to-GDP"=1,"Goods Balance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Services Balance-to-GDP","Goods Balance-to-GDP"), values=c("Services Balance-to-GDP"=2,"Goods Balance-to-GDP"=2))
title         <- ggtitle("Trade Balance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Source: BEA; NBER")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$nx_goods_gdp,na.rm = TRUE), max(Data$nx_goods_gdp,na.rm = TRUE), 1),0))
figure_nx_sep <- figure_nx_sep +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_nx_sep) + yscale

```

### Crude Petroleum & Non-Petroleum Trade Balance-to-GDP {-}
```{r oil1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_oil1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$crude_nx_gdp, color="Crude Petroleum Trade Balance-to-GDP",linetype="Crude Petroleum Trade Balance-to-GDP"))
g2 <- geom_line(aes(y=Data$nx_x_crude_gdp, color="Non-Petroleum Trade Balance-to-GDP",linetype="Non-Petroleum Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Crude Petroleum Trade Balance-to-GDP"), values=c( "Non-Petroleum Trade Balance-to-GDP"="blue", "Crude Petroleum Trade Balance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Crude Petroleum Trade Balance-to-GDP"), values=c("Non-Petroleum Trade Balance-to-GDP"=1,"Crude Petroleum Trade Balance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Petroleum Trade Balance-to-GDP","Crude Petroleum Trade Balance-to-GDP"), values=c("Non-Petroleum Trade Balance-to-GDP"=2,"Crude Petroleum Trade Balance-to-GDP"=2))
title         <- ggtitle("Crude Petroleum & Non-Petroleum Trade Balance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, EIA, NBER")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$nx_x_crude_gdp,na.rm = TRUE), max(Data$nx_x_crude_gdp,na.rm = TRUE), .01),2))
figure_oil1 <- figure_oil1 +g1+ g2 + color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_oil1) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/crude_bal.jpg" ,height = 6.5,width = 11.5,units = "in")

```

### Commodity Trade Balance-to-GDP {-}
```{r nx1, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nx1      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("percent")
g1 <- geom_line(aes(y=Data$cmd_nx, color="Commodity Trade Balance-to-GDP",linetype="Commodity Trade Balance-to-GDP"))
g2 <- geom_line(aes(y=Data$noncmd_nx, color="Non-Commodity Trade Balance-to-GDP",linetype="Non-Commodity Trade Balance-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Non-Commodity Trade Balance-to-GDP","Commodity Trade Balance-to-GDP"), values=c( "Non-Commodity Trade Balance-to-GDP"="blue", "Commodity Trade Balance-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Non-Commodity Trade Balance-to-GDP","Commodity Trade Balance-to-GDP"), values=c("Non-Commodity Trade Balance-to-GDP"=1,"Commodity Trade Balance-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Non-Commodity Trade Balance-to-GDP","Commodity Trade Balance-to-GDP"), values=c("Non-Commodity Trade Balance-to-GDP"=2,"Commodity Trade Balance-to-GDP"=2))
title         <- ggtitle("Commodity Trade Balance-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1970-12-01"), as.Date("2021-12-01")), date_breaks = "2 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Commidities inc Agricultural & Energy goods + Aluminum, Iron and Steel & Copper")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$noncmd_nx,na.rm = TRUE), max(Data$noncmd_nx,na.rm = TRUE), 1),2))
figure_nx1 <- figure_nx1 +g1+g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_nx1) + yscale

#ggsave("C:/Users/sabol/Google Drive/blogposts/comtradebal.jpg" ,height = 6.5,width = 11.5,units = "in")


```

### Iron and Steel Trade {-}
```{r nx2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nx2      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$steel_exp_gdp, color="Iron and Steel Exports-to-GDP",linetype="Iron and Steel Exports-to-GDP"))
g2 <- geom_line(aes(y=Data$steel_imp_gdp, color="Iron and Steel Imports-to-GDP",linetype="Iron and Steel Imports-to-GDP"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Iron and Steel Imports-to-GDP","Iron and Steel Exports-to-GDP"), values=c( "Iron and Steel Imports-to-GDP"="blue", "Iron and Steel Exports-to-GDP"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Iron and Steel Imports-to-GDP","Iron and Steel Exports-to-GDP"), values=c("Iron and Steel Imports-to-GDP"=1,"Iron and Steel Exports-to-GDP"=1))
size          <- scale_size_manual(" ", breaks=c("Iron and Steel Imports-to-GDP","Iron and Steel Exports-to-GDP"), values=c("Iron and Steel Imports-to-GDP"=2,"Iron and Steel Exports-to-GDP"=2))
title         <- ggtitle("Iron and Steel Trade")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1921-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$steel_exp_gdp,na.rm = TRUE), max(Data$steel_exp_gdp,na.rm = TRUE), .001),4))
figure_nx2 <- figure_nx2 +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_nx2) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")
```

###  Aluminum Imports and Exports {-}
```{r nx7, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nx7      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$alum_exp/Data$ngdpm, color="Exports",linetype="Exports"))
g2 <- geom_line(aes(y=Data$alum_imp/Data$ngdpm, color="Imports",linetype="Imports"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Imports","Exports"), values=c( "Imports"="blue", "Exports"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=2,"Exports"=2))
title         <- ggtitle("Aluminum Imports and Exports")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1953-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$steel_exp_gdp,na.rm = TRUE), max(Data$steel_exp_gdp,na.rm = TRUE), .00025),5))
figure_nx7 <- figure_nx7 +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_nx7) + yscale


```

###  Copper Trade {-}
```{r nx5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_nx5      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$copper_exp/Data$ngdpm, color="Exports",linetype="Exports"))
g2 <- geom_line(aes(y=Data$copper_imp/Data$ngdpm, color="Imports",linetype="Imports"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Imports","Exports"), values=c( "Imports"="blue", "Exports"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=2,"Exports"=2))
title         <- ggtitle("The Copper Trade")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1921-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.65, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")

figure_nx5 <- figure_nx5 +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs 

nberShade(figure_nx5)

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")

```

###  Agricultural Commodities Trade {-}

```{r aggtrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_aggtrade      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$agg_exp_gdp, color="Exports",linetype="Exports"))
g2 <- geom_line(aes(y=Data$agg_imp_gdp, color="Imports",linetype="Imports"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Imports","Exports"), values=c( "Imports"="blue", "Exports"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=2,"Exports"=2))
title         <- ggtitle("Agricultural Commodities Trade")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1913-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$agg_exp_gdp,na.rm = TRUE), max(Data$agg_exp_gdp,na.rm = TRUE), .0025),5))
figure_aggtrade <- figure_aggtrade +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs +hline

nberShade(figure_aggtrade) + ylim(range(.0024,.024))


```

### U.S. Energy Imports and Exports {-}
```{r fueltrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

figure_fueltrade      <- ggplot(data=D, aes(x=Date)) + xlab("") + ylim(range(-10,15)) + ylab("")
g1 <- geom_line(aes(y=Data$energy_exp/Data$ngdpm, color="Exports",linetype="Exports"))
g2 <- geom_line(aes(y=Data$energy_imp/Data$ngdpm, color="Imports",linetype="Imports"))
hline         <- geom_hline(yintercept = 0, linetype="dashed")

color         <- scale_color_manual(" ", breaks=c("Imports","Exports"), values=c( "Imports"="blue", "Exports"="red"))
linetype      <- scale_linetype_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=1,"Exports"=1))
size          <- scale_size_manual(" ", breaks=c("Imports","Exports"), values=c("Imports"=2,"Exports"=2))
title         <- ggtitle("U.S. Energy Imports and Exports")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1950-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, fraction of GDP")

yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$energy_exp/Data$ngdpm,na.rm = TRUE), max(Data$energy_imp/Data$ngdpm,na.rm = TRUE), .0025),4))
figure_fueltrade <- figure_fueltrade +g1 +g2+ color +linetype +size + title +text_options + Date_opts +leg_pos +sub_labs

nberShade(figure_fueltrade) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/energynx.jpg" ,height = 6.5,width = 11.5,units = "in")

```


## Bilateral Trade {-}

### U.S. Regional Trade Balances-to-GDP {-}

```{r tradepartners2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tradepartners2      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$africa_exp/Data$ngdpm - Data$africa_imp/Data$ngdpm, color="Africa",linetype="Africa"))
g2 <- geom_line(aes(y=Data$europe_exp/Data$ngdpm - Data$europe_imp/Data$ngdpm, color="Europe",linetype="Europe"))
g3 <- geom_line(aes(y=Data$asia_and_oceania_exp/Data$ngdpm - Data$asia_and_oceania_imp/Data$ngdpm, color="Asia and Oceania",linetype="Asia and Oceania"))
g4 <- geom_line(aes(y=Data$south_america_exp/Data$ngdpm - Data$south_america_imp/Data$ngdpm, color="South America",linetype="South America"))
g5 <- geom_line(aes(y=Data$north_america_exp/Data$ngdpm - Data$north_america_imp/Data$ngdpm, color="North America",linetype="North America"))

color         <- scale_color_manual(" ", breaks=c("Europe","Africa","South America","Asia and Oceania","North America"), values=c( "Europe"="blue", "Africa"="red","South America" = "black","Asia and Oceania" ="purple","North America" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Europe","Africa","South America","Asia and Oceania","North America"), values=c("Europe"=1,"Africa"=1,"South America"=1,"Asia and Oceania"=2,"North America"=1))
size          <- scale_size_manual(" ", breaks=c("Europe","Africa","South America","Asia and Oceania","North America"), values=c("Europe"=2,"Africa"=2,"South America"=2,"Asia and Oceania"=3,"North America"=3))
title         <- ggtitle("U.S. Regional Trade Balances-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1918-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis())

tradepartners2 <- tradepartners2 +g4+g1+g2+g3+g5 +color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(tradepartners2) + yscale
```

###  U.S. - Asia Trade Balances-to-GDP {-}

```{r tradepartners3, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tradepartners3      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$chn_exp/Data$ngdpm - Data$chn_imp/Data$ngdpm, color="China",linetype="China"))
g2 <- geom_line(aes(y=Data$jpn_exp/Data$ngdpm - Data$jpn_imp/Data$ngdpm, color="Japan",linetype="Japan"))
g3 <- geom_line(aes(y=Data$sgp_exp/Data$ngdpm - Data$sgp_imp/Data$ngdpm, color="Singapore",linetype="Singapore"))
g4 <- geom_line(aes(y=Data$idn_exp/Data$ngdpm - Data$idn_imp/Data$ngdpm, color="Indonesia",linetype="Indonesia"))
g5 <- geom_line(aes(y=Data$ind_exp/Data$ngdpm - Data$ind_imp/Data$ngdpm, color="India",linetype="India"))

color         <- scale_color_manual(" ", breaks=c("Japan","China","Indonesia","Singapore","India"), values=c( "Japan"="blue", "China"="red","Indonesia" = "black","Singapore" ="purple","India" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Japan","China","Indonesia","Singapore","India"), values=c("Japan"=1,"China"=1,"Indonesia"=1,"Singapore"=2,"India"=1))
size          <- scale_size_manual(" ", breaks=c("Japan","China","Indonesia","Singapore","India"), values=c("Japan"=2,"China"=2,"Indonesia"=2,"Singapore"=3,"India"=3))
title         <- ggtitle("U.S. - Asia Trade Balances-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.45), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$chn_exp/Data$ngdpm - Data$chn_imp/Data$ngdpm,na.rm = TRUE), max(Data$chn_exp/Data$ngdpm - Data$chn_imp/Data$ngdpm,na.rm = TRUE), .005),3))

tradepartners3 <- tradepartners3 +g4+g3+g1+g2+g5+color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(tradepartners3) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/asiantradebal.jpg" ,height = 6.5,width = 11.5,units = "in")

```

###  U.S.- European Trade Balances-to-GDP {-}


```{r tradepartners4, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tradepartners4      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$fra_exp/Data$ngdpm - Data$fra_imp/Data$ngdpm, color="France",linetype="France"))
g2 <- geom_line(aes(y=Data$ger_exp/Data$ngdpm - Data$ger_imp/Data$ngdpm, color="Germany",linetype="Germany"))
g3 <- geom_line(aes(y=Data$gbr_exp/Data$ngdpm - Data$gbr_imp/Data$ngdpm, color="UK",linetype="UK"))
g4 <- geom_line(aes(y=Data$ita_exp/Data$ngdpm - Data$ita_imp/Data$ngdpm, color="Italy",linetype="Italy"))
g5 <- geom_line(aes(y=Data$rus_exp/Data$ngdpm - Data$rus_imp/Data$ngdpm, color="Russia",linetype="Russia"))

color         <- scale_color_manual(" ", breaks=c("Germany","France","Italy","UK","Russia"), values=c( "Germany"="blue", "France"="red","Italy" = "black","UK" ="purple","Russia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Germany","France","Italy","UK","Russia"), values=c("Germany"=1,"France"=1,"Italy"=1,"UK"=2,"Russia"=1))
size          <- scale_size_manual(" ", breaks=c("Germany","France","Italy","UK","Russia"), values=c("Germany"=2,"France"=2,"Italy"=2,"UK"=3,"Russia"=3))
title         <- ggtitle("U.S.- European Trade Balances-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1945-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.85), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$chn_exp/Data$ngdpm - Data$chn_imp/Data$ngdpm,na.rm = TRUE), max(Data$chn_exp/Data$ngdpm - Data$chn_imp/Data$ngdpm,na.rm = TRUE), .005),3))

tradepartners4 <- tradepartners4 +g4+g1+g2+g3+g5+color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs 

nberShade(tradepartners4) + ylim(range(-.005,0.008))
```

### U.S. - South America Trade Balances-to-GDP {-}

```{r tradepartners5, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tradepartners5      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$bra_exp/Data$ngdpm - Data$bra_imp/Data$ngdpm, color="Brazil",linetype="Brazil"))
g2 <- geom_line(aes(y=Data$ven_exp/Data$ngdpm - Data$ven_imp/Data$ngdpm, color="Venezuela",linetype="Venezuela"))
g3 <- geom_line(aes(y=Data$chl_exp/Data$ngdpm - Data$chl_imp/Data$ngdpm, color="Chile",linetype="Chile"))
g4 <- geom_line(aes(y=Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm, color="Argentina",linetype="Argentina"))
g5 <- geom_line(aes(y=Data$col_exp/Data$ngdpm - Data$col_imp/Data$ngdpm, color="Colombia",linetype="Colombia"))

color         <- scale_color_manual(" ", breaks=c("Venezuela","Brazil","Argentina","Chile","Colombia"), values=c( "Venezuela"="blue", "Brazil"="red","Argentina" = "black","Chile" ="purple","Colombia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Venezuela","Brazil","Argentina","Chile","Colombia"), values=c("Venezuela"=1,"Brazil"=1,"Argentina"=1,"Chile"=2,"Colombia"=1))
size          <- scale_size_manual(" ", breaks=c("Venezuela","Brazil","Argentina","Chile","Colombia"), values=c("Venezuela"=2,"Brazil"=2,"Argentina"=2,"Chile"=3,"Colombia"=3))
title         <- ggtitle("U.S. - South America Trade Balances-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.15, 0.35), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$ven_exp/Data$ngdpm - Data$ven_imp/Data$ngdpm,na.rm = TRUE), max(Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm,na.rm = TRUE), .0005),4))

tradepartners5 <- tradepartners5 +g4+g3+g1+g2+g5+color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(tradepartners5) + yscale
```

###  U.S. Mexio and Canada Trade Balances-to-GDP {-}

```{r tradepartners6, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

tradepartners6      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$mex_exp/Data$ngdpm - Data$mex_imp/Data$ngdpm, color="Mexico",linetype="Mexico"))
g2 <- geom_line(aes(y=Data$can_exp/Data$ngdpm - Data$can_imp/Data$ngdpm, color="Canada",linetype="Canada"))
g3 <- geom_line(aes(y=Data$sgp_exp/Data$ngdpm - Data$sgp_imp/Data$ngdpm, color="Singapore",linetype="Singapore"))
g4 <- geom_line(aes(y=Data$idn_exp/Data$ngdpm - Data$idn_imp/Data$ngdpm, color="Indonesia",linetype="Indonesia"))
g5 <- geom_line(aes(y=Data$php_exp/Data$ngdpm - Data$php_imp/Data$ngdpm, color="Philippines",linetype="Philippines"))

color         <- scale_color_manual(" ", breaks=c("Canada","Mexico","Indonesia","Singapore","Philippines"), values=c( "Canada"="blue", "Mexico"="red","Indonesia" = "black","Singapore" ="purple","Philippines" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Canada","Mexico","Indonesia","Singapore","Philippines"), values=c("Canada"=1,"Mexico"=1,"Indonesia"=1,"Singapore"=2,"Philippines"=1))
size          <- scale_size_manual(" ", breaks=c("Canada","Mexico","Indonesia","Singapore","Philippines"), values=c("Canada"=2,"Mexico"=2,"Indonesia"=2,"Singapore"=3,"Philippines"=3))
title         <- ggtitle("U.S. Mexio and Canada Trade Balances-to-GDP")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Vertical line is when NAFTA was enacted")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$can_exp/Data$ngdpm - Data$can_imp/Data$ngdpm,na.rm = TRUE), max(Data$can_exp/Data$ngdpm - Data$can_imp/Data$ngdpm,na.rm = TRUE), .0025),4))
vline <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE)
tradepartners6 <- tradepartners6 +g1+g2+color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs + vline

nberShade(tradepartners6) + yscale

# #ggsave("C:/Users/sabol/Google Drive/blogposts/temp2.jpg" ,height = 6.5,width = 11.5,units = "in")
# Status <- paste(title$title,"#data","#economics","#macro","#R",sep = " ")
# media_path <- "C:/Users/sabol/Google Drive/blogposts/temp2.jpg"
# tw <- updateStatus(Status, mediaPath = media_path )
# unlink("temp2.jpg")
```

### U.S. - Brazil Trade Balance-to-GDP and Real Exchange Rate {-}

```{r bratrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

bratrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$bra_exp/Data$ngdpm - Data$bra_imp/Data$ngdpm)*100, color="Trade Balance",linetype="Trade Balance"))
g2 <- geom_line(aes(y=Data$bra_real/20, color="Real BRL/USD",linetype="Real BRL/USD"))
g3 <- geom_line(aes(y=Data$chl_exp/Data$ngdpm - Data$chl_imp/Data$ngdpm, color="Chile",linetype="Chile"))
g4 <- geom_line(aes(y=Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm, color="Argentina",linetype="Argentina"))
g5 <- geom_line(aes(y=Data$col_exp/Data$ngdpm - Data$col_imp/Data$ngdpm, color="Colombia",linetype="Colombia"))

color         <- scale_color_manual(" ", breaks=c("Real BRL/USD","Trade Balance","Argentina","Chile","Colombia"), values=c( "Real BRL/USD"="blue", "Trade Balance"="red","Argentina" = "black","Chile" ="purple","Colombia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real BRL/USD","Trade Balance","Argentina","Chile","Colombia"), values=c("Real BRL/USD"=1,"Trade Balance"=1,"Argentina"=1,"Chile"=2,"Colombia"=1))
size          <- scale_size_manual(" ", breaks=c("Real BRL/USD","Trade Balance","Argentina","Chile","Colombia"), values=c("Real BRL/USD"=2,"Trade Balance"=2,"Argentina"=2,"Chile"=3,"Colombia"=3))
title         <- ggtitle("U.S. - Brazil Trade Balance-to-GDP and Real Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-.4,1, .05),4))

bratrade <- bratrade + g1+g2+ color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs

nberShade(bratrade) + yscale

```

### U.S. - Canada Trade Balance-to-GDP and Real Exchange Rate {-}


```{r cantrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

cantrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$can_exp/Data$ngdpm - Data$can_imp/Data$ngdpm)*100, color="Trade Balance",linetype="Trade Balance"))
g2 <- geom_line(aes(y=Data$can_real/2-1.125, color="Real Exchange Rate",linetype="Real Exchange Rate"))
g3 <- geom_line(aes(y=Data$chl_exp/Data$ngdpm - Data$chl_imp/Data$ngdpm, color="Chile",linetype="Chile"))
g4 <- geom_line(aes(y=Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm, color="Argentina",linetype="Argentina"))
g5 <- geom_line(aes(y=Data$col_exp/Data$ngdpm - Data$col_imp/Data$ngdpm, color="Colombia",linetype="Colombia"))

color         <- scale_color_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c( "Real Exchange Rate"="blue", "Trade Balance"="red","Argentina" = "black","Chile" ="purple","Colombia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=1,"Trade Balance"=1,"Argentina"=1,"Chile"=2,"Colombia"=1))
size          <- scale_size_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=2,"Trade Balance"=2,"Argentina"=2,"Chile"=3,"Colombia"=3))
title         <- ggtitle("U.S. - Canada Trade Balance-to-GDP and Real Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Dashed vertical line is NAFTA, solid vertical lines are Bretton Woods")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1,1, .10),4))
nafta <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE,linetype = "dashed", size = 2)
vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)

cantrade <- cantrade + g1+g2+ color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs + vline1 + vline2 + nafta

nberShade(cantrade) + yscale
```

### U.S. - Mexico Trade Balance-to-GDP and Real Exchange Rate {-}

```{r mextrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

mextrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$mex_exp/Data$ngdpm - Data$mex_imp/Data$ngdpm)*100, color="Trade Balance",linetype="Trade Balance"))
g2 <- geom_line(aes(y=Data$mex_real/50 -0.4, color="Real Exchange Rate",linetype="Real Exchange Rate"))
g3 <- geom_line(aes(y=Data$chl_exp/Data$ngdpm - Data$chl_imp/Data$ngdpm, color="Chile",linetype="Chile"))
g4 <- geom_line(aes(y=Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm, color="Argentina",linetype="Argentina"))
g5 <- geom_line(aes(y=Data$col_exp/Data$ngdpm - Data$col_imp/Data$ngdpm, color="Colombia",linetype="Colombia"))

color         <- scale_color_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c( "Real Exchange Rate"="blue", "Trade Balance"="red","Argentina" = "black","Chile" ="purple","Colombia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=1,"Trade Balance"=1,"Argentina"=1,"Chile"=2,"Colombia"=1))
size          <- scale_size_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=2,"Trade Balance"=2,"Argentina"=2,"Chile"=3,"Colombia"=3))
title         <- ggtitle("U.S. - Mexico Trade Balance-to-GDP and Real Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Dashed vertical line is NAFTA, solid vertical lines are Bretton Woods")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-1,1, .10),4))
nafta <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE,linetype = "dashed", size = 2)
vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)

mextrade <- mextrade + g1+g2+ color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs + vline1 + vline2 + nafta

nberShade(mextrade) + yscale
```

### U.S. - Europe Trade Balance-to-GDP and Real Exchange Rate {-}

```{r gertrade, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

gertrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$europe_exp/Data$ngdpm - Data$europe_imp/Data$ngdpm)*100, color="Trade Balance",linetype="Trade Balance"))
g2 <- geom_line(aes(y=Data$eurusd_real, color="Real Exchange Rate",linetype="Real Exchange Rate"))
g3 <- geom_line(aes(y=Data$chl_exp/Data$ngdpm - Data$chl_imp/Data$ngdpm, color="Chile",linetype="Chile"))
g4 <- geom_line(aes(y=Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm, color="Argentina",linetype="Argentina"))
g5 <- geom_line(aes(y=Data$col_exp/Data$ngdpm - Data$col_imp/Data$ngdpm, color="Colombia",linetype="Colombia"))

color         <- scale_color_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c( "Real Exchange Rate"="blue", "Trade Balance"="red","Argentina" = "black","Chile" ="purple","Colombia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=1,"Trade Balance"=1,"Argentina"=1,"Chile"=2,"Colombia"=1))
size          <- scale_size_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=2,"Trade Balance"=2,"Argentina"=2,"Chile"=3,"Colombia"=3))
title         <- ggtitle("U.S. - Europe Trade Balance-to-GDP and Real Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Solid vertical lines are Bretton Woods")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,6, .30),4))
nafta <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE,linetype = "dashed", size = 2)
vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)

gertrade <- gertrade + g1+g2+ color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs + vline1 + vline2 

nberShade(gertrade) + yscale
```

###  U.S. - U.K. Trade Balance-to-GDP and Real Exchange Rate {-}

```{r gbrtrade2, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

gbrtrade      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=(Data$gbr_exp/Data$ngdpm - Data$gbr_imp/Data$ngdpm)*100, color="Trade Balance",linetype="Trade Balance"))
g2 <- geom_line(aes(y=Data$gbr_real*2 -1, color="Real Exchange Rate",linetype="Real Exchange Rate"))
g3 <- geom_line(aes(y=Data$chl_exp/Data$ngdpm - Data$chl_imp/Data$ngdpm, color="Chile",linetype="Chile"))
g4 <- geom_line(aes(y=Data$arg_exp/Data$ngdpm - Data$arg_imp/Data$ngdpm, color="Argentina",linetype="Argentina"))
g5 <- geom_line(aes(y=Data$col_exp/Data$ngdpm - Data$col_imp/Data$ngdpm, color="Colombia",linetype="Colombia"))

color         <- scale_color_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c( "Real Exchange Rate"="blue", "Trade Balance"="red","Argentina" = "black","Chile" ="purple","Colombia" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=1,"Trade Balance"=1,"Argentina"=1,"Chile"=2,"Colombia"=1))
size          <- scale_size_manual(" ", breaks=c("Real Exchange Rate","Trade Balance","Argentina","Chile","Colombia"), values=c("Real Exchange Rate"=2,"Trade Balance"=2,"Argentina"=2,"Chile"=3,"Colombia"=3))
title         <- ggtitle("U.S. - U.K. Trade Balance-to-GDP and Real Exchange Rate")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1919-12-01"), as.Date("2021-12-01")), date_breaks = "4 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.05, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data, Solid vertical lines are Bretton Woods")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-4,6, .30),4))
nafta <- geom_vline(xintercept = as.Date("1994-01-01"),show.legend = TRUE,linetype = "dashed", size = 2)
vline1 <- geom_vline(xintercept = as.Date("1944-07-01"),show.legend = TRUE)
vline2 <- geom_vline(xintercept = as.Date("1971-08-01"),show.legend = TRUE)

gbrtrade <- gbrtrade + g1+g2+ color +linetype +size + title + text_options +hline+ Date_opts +leg_pos +sub_labs + vline1 + vline2 

nberShade(gbrtrade) + yscale
```

## New-Based Indexes {-}

###  Geopolitical Risk {-}
```{r gpraas, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

gpraas      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$gpr_a, color="Geopolitical Acts",linetype="Geopolitical Acts"))
g2 <- geom_line(aes(y=Data$gpr_t, color="Geopolitical Threats",linetype="Geopolitical Threats"))
g3 <- geom_line(aes(y=Data$asia_and_oceania_exp/Data$ngdpm - Data$asia_and_oceania_imp/Data$ngdpm, color="Asia and Oceania",linetype="Asia and Oceania"))
g4 <- geom_line(aes(y=Data$south_america_exp/Data$ngdpm - Data$south_america_imp/Data$ngdpm, color="South America",linetype="South America"))
g5 <- geom_line(aes(y=Data$north_america_exp/Data$ngdpm - Data$north_america_imp/Data$ngdpm, color="North America",linetype="North America"))

color         <- scale_color_manual(" ", breaks=c("Geopolitical Threats","Geopolitical Acts","South America","Asia and Oceania","North America"), values=c( "Geopolitical Threats"="blue", "Geopolitical Acts"="red","South America" = "black","Asia and Oceania" ="purple","North America" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Geopolitical Threats","Geopolitical Acts","South America","Asia and Oceania","North America"), values=c("Geopolitical Threats"=1,"Geopolitical Acts"=1,"South America"=1,"Asia and Oceania"=2,"North America"=1))
size          <- scale_size_manual(" ", breaks=c("Geopolitical Threats","Geopolitical Acts","South America","Asia and Oceania","North America"), values=c("Geopolitical Threats"=2,"Geopolitical Acts"=2,"South America"=2,"Asia and Oceania"=3,"North America"=3))
title         <- ggtitle("Geopolitical Risk")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position=c(0.75, 0.95), legend.justification = c(0,1),legend.title = element_blank()) 
sub_labs <- labs(subtitle="Capital Markets Data; Source: Measuring Geopolitical Risk by Dario Caldara and Matteo Iacoviello",caption = "@capitalmarketz")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(min(Data$gpr_a,na.rm = TRUE), max(Data$gpr_a,na.rm = TRUE), 200),0))

gpraas <- gpraas +g1+g2 +color +linetype +size + title + text_options+ Date_opts +leg_pos +sub_labs

nberShade(gpraas) +yscale


```

###  U.S. Economic Policy Uncertainty {-}

```{r epuss, message=FALSE, warning=FALSE, echo=FALSE, fig.height=6.5, fig.width=11.5,cache=FALSE}

epuss      <- ggplot(data=D, aes(x=Date)) + xlab("")  + ylab("")
g1 <- geom_line(aes(y=Data$epu, color="Economic Policy Uncertainty",linetype="Economic Policy Uncertainty"))
g2 <- geom_line(aes(y=Data$epu, color="Europe",linetype="Europe"))
g3 <- geom_line(aes(y=Data$asia_and_oceania_exp/Data$ngdpm - Data$asia_and_oceania_imp/Data$ngdpm, color="Asia and Oceania",linetype="Asia and Oceania"))
g4 <- geom_line(aes(y=Data$south_america_exp/Data$ngdpm - Data$south_america_imp/Data$ngdpm, color="South America",linetype="South America"))
g5 <- geom_line(aes(y=Data$north_america_exp/Data$ngdpm - Data$north_america_imp/Data$ngdpm, color="North America",linetype="North America"))

color         <- scale_color_manual(" ", breaks=c("Europe","Economic Policy Uncertainty","South America","Asia and Oceania","North America"), values=c( "Europe"="blue", "Economic Policy Uncertainty"="red","South America" = "black","Asia and Oceania" ="purple","North America" = "green"))
linetype      <- scale_linetype_manual(" ", breaks=c("Europe","Economic Policy Uncertainty","South America","Asia and Oceania","North America"), values=c("Europe"=1,"Economic Policy Uncertainty"=1,"South America"=1,"Asia and Oceania"=2,"North America"=1))
size          <- scale_size_manual(" ", breaks=c("Europe","Economic Policy Uncertainty","South America","Asia and Oceania","North America"), values=c("Europe"=2,"Economic Policy Uncertainty"=2,"South America"=2,"Asia and Oceania"=3,"North America"=3))
title         <- ggtitle("U.S. Economic Policy Uncertainty")
text_options  <- theme(title = element_text(size = rel(1.1))) + theme(legend.text = element_text(size = rel(1.1)))  + theme(legend.title = element_text(size = rel(1.1)))
Date_opts     <- scale_x_date(limits = c(as.Date("1899-12-01"), as.Date("2021-12-01")), date_breaks = "5 year",date_labels = "%Y")
leg_pos       <-  theme(legend.position="none")
sub_labs <- labs(subtitle="Capital Markets Data; Source:https://www.policyuncertainty.com")
yscale <- scale_y_continuous(sec.axis = dup_axis(),breaks=round(seq(-5,9, .5),1))

epuss <- epuss +g1 +color +linetype +size + title + text_options + Date_opts +leg_pos +sub_labs

nberShade(epuss) + yscale
#ggsave("C:/Users/sabol/Google Drive/blogposts/epu.jpg" ,height = 6.5,width = 11.5,units = "in")


```
